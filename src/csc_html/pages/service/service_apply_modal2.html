<style>
  .ztree.release li a.curSelectedNode{background:none;color: #82939E;}
  .ztree.release li a:hover{border-color:#fff;background-color:#fff;}
</style>
<div class="simple_form form-horizontal">
  <div class='modal-dialog modal-lg' style="width:800px;">
    <div class='modal-content'>
      <div class='modal-header'>
        <h3 class='modal-title'>申请云主机服务</h3>
      </div>
      <div class='modal-body'>
        <ul class="nav nav-tabs service-step-select">
          <li class="active">
            <a >1基本信息</a>
          </li>
          <li class="">
            <a >2规格配置</a>
          </li>
          <li class="">
            <a >3网络配置</a>
          </li>
          <li class="">
            <a >4系统盘分区</a>
          </li>
          <li class="">
            <a >5挂载云硬盘</a>
          </li>
          <li class="">
            <a >6软件安装</a>
          </li>
          <li class="">
            <a >7信息确认</a>
          </li>
        </ul>
<script>
  function applyChangeVMnum(val){
    var value = parseInt(val.replace(/[^\d]/g,''));
    if(value){
      if(value>20) value=20;
      $('#applyServiceVmsBox').html('');
      $('#applyServiceSpeceBox').html('');
      $('#applyServiceNetBox').html('');
      var Vms = '', Spaces = '', Nets = '';

      for(var i=0;i<value;i++){
        var Vm = '<tr>'+
                    '<td>'+(i+1)+'</td>'+
                    '<td><input type="text" class="form-control"></td>'+
                    '<td><input type="text" class="form-control"></td>'+
                    '<td><select class="form-control"><option value="">1</option></select></td>'+
                    '<td><select class="form-control"><option value="">1</option></select></td>'+
                    '<td><input type="text" class="form-control"></td>'+
                    '<td>'+
                      '<div class="radio">'+
                        '<label class="form-inline">'+
                          '<input type="radio" name="optionsRadios'+i+'" id="optionsRadios'+i+'1" value="option1" checked=""> 永久'+
                        '</label>'+
                      '</div>'+
                      '<div class="radio">'+
                        '<label class="form-inline">'+
                          '<input type="radio" class="form-control" style="top:2px;" name="optionsRadios'+i+'" id="optionsRadios'+i+'2" value="option2"> '+
                          '<select class="form-control"><option value="1">1</option><option value="1">2</option></select> 个月'+
                        '</label>'+
                      '</div>'+
                      '<div class="radio disabled">'+
                        '<label class="form-inline">'+
                          '<input type="radio" class="form-control" style="top:2px;" name="optionsRadios'+i+'" id="optionsRadios'+i+'3" value="option3">'+
                          '<input type="text" class="form-control" value="2016-4-15至2016-6-15">'+
                        '</label>'+
                      '</div>'+
                    '</td>'+
                  '</tr>';
        var Space = '<tr>'+
                        '<td>'+(i+1)+'</td>'+
                        '<td>云主机'+(i+1)+'</td>'+
                        '<td><select class="form-control"><option value="">1</option></select></td>'+
                        '<td><select class="form-control"><option value="">1</option></select></td>'+
                        '<td><select class="form-control"><option value="">1</option></select></td>'+
                        '<td><select class="form-control"><option value="">1</option></select></td>'+
                        '<td><input type="text" class="form-control"></td>'+
                      '</tr>';
        var Net = '<tr>'+
                      '<td>'+(i+1)+'</td>'+
                      '<td>云主机'+(i+1)+'</td>'+
                      '<td><select class="form-control"><option value="">内部网络</option><option value="">外部网络</option></select></td>'+
                      '<td><select class="form-control"><option value="">1</option></select></td>'+
                      '<td><input type="text" class="form-control" value="192.168.1.1"></td>'+
                    '</tr>';
        Vms = Vms + Vm;
        Spaces = Spaces + Space;
        Nets = Nets + Net;
      }
      $('#applyServiceVmsBox').html(Vms);
      $('#applyServiceSpeceBox').html(Spaces);
      $('#applyServiceNetBox').html(Nets);
      return value
    }
    return '';
  }
</script>
        <div class="tab-content service-step-box" style="margin-top:20px;">
          <div class="tab-pane active">
            <div class="form-inline">
              <div class="input-group">
                 <span class="input-group-addon">申请数量</span>
                 <input type="text" class="form-control" onpropertychange="value=applyChangeVMnum(value)" oninput="value=applyChangeVMnum(value)">
              </div>
            </div>
            <div class="panel panel-default table-responsive" style="margin:0;margin-top:10px">
              <table class="table table-striped table-condensed">
                <thead>
                  <th>序号</th>
                  <th>云主机名称<i style="color:red">*</i></th>
                  <th>计算机名称</th>
                  <th>业务系统</th>
                  <th>所属VDC<i style="color:red">*</i></th>
                  <th>备注</th>
                  <th>申请时长<i style="color:red">*</i></th>
                </thead>
                <tbody id="applyServiceVmsBox">
                  
                </tbody>
              </table>
            </div>
          </div>

          <div class="tab-pane">
            <div class="panel panel-default table-responsive" style="margin:0;margin-top:10px">
              <table class="table table-striped table-condensed">
                <thead>
                  <th>序号</th>
                  <th>云主机名称</th>
                  <th>操作系统类型<i style="color:red">*</i></th>
                  <th>操作系统版本<i style="color:red">*</i></th>
                  <th>CPU(核)<i style="color:red">*</i></th>
                  <th>内存(G))<i style="color:red">*</i></th>
                  <th>存储(G</th>
                </thead>
                <tbody id="applyServiceSpeceBox">
                  
                </tbody>
              </table>
            </div>
          </div>

          <div class="tab-pane">
            <div class="panel panel-default table-responsive" style="margin:0;margin-top:10px">
              <table class="table table-striped table-condensed">
                <thead>
                  <th>序号</th>
                  <th>云主机名称</th>
                  <th>网络类型<i style="color:red">*</i></th>
                  <th>VPC/IP池<i style="color:red">*</i></th>
                  <th>指定IP</th>
                </thead>
                <tbody id="applyServiceNetBox">
                  
                </tbody>
              </table>
            </div>
          </div>

          <div class="tab-pane">
            <div class='form-horizontal row'>
              <div class="form-group">
                <label class="col-sm-2 control-label">发布范围：</label>
                <div class="col-sm-9">
                  <div class="panel panel-default" style="margin:0;padding-bottom:10px">
                    <div id="serviceModalTree" class="ztree release"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info service-step-btn-pre" style="display:none;">上一步</a>
        <a class="btn btn-default btn-info service-step-btn-next">下一步</a>
        <a class="btn btn-default btn-info service-step-btn-save" style="display:none;">保存</a>
        <a class="btn btn-default btn-success service-step-btn-saveAndRelease" style="display:none;">保存并发布</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
  var scripts = [null, 'assets/bower_components/zTree/js/jquery.ztree.core.js', 'assets/bower_components/zTree/js/jquery.ztree.excheck.js', null];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function() {

    var step = 0;
    var activeSteps = [true,false,false,false,false,false,false]
    $('.service-step-select li').click(function(){
      if($(this).hasClass('active')) return;
      if(!activeSteps[$(this).index()]) return;
      step = $(this).index();
      $(this).addClass('active').siblings().removeClass('active');
      $('.service-step-box>div').eq(step).addClass('active').siblings().removeClass('active');
      buildBtns(step);
    })

    function buildBtns(step){
      $('.service-step-btn-pre,.service-step-btn-next').show();
      $('.service-step-btn-save,.service-step-btn-saveAndRelease').hide();
      if(step==0){
        $('.service-step-btn-pre').hide();
      }
      if(step==$('.service-step-select li').length-1){
        $('.service-step-btn-next').hide();
        $('.service-step-btn-save,.service-step-btn-saveAndRelease').show();
      }
    }
    $('.service-step-btn-pre').click(function(){
      step = step - 1;
      $('.service-step-select li').eq(step).trigger('click');
      buildBtns(step);
    })
    $('.service-step-btn-next').click(function(){
      step = step + 1;
      activeSteps[step] = true;
      $('.service-step-select li').eq(step).trigger('click');
      buildBtns(step);
    })

    
  });
</script>