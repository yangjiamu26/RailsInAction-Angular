<div class="bg-light lter b-b wrapper-sm">
	<ol class="breadcrumb">
		<li>当前位置：</li>
		<li><a href="#pages/vdcs/vpcs/index">VPC管理</a></li>
		<li class="active">VPC详情</li>
	</ol>
</div>

<div class='wrapper-md'>
	<div class="nav-tabs-alt bg-white-only">
		<ul class="nav nav-tabs" role="tablist">
			<li class="active" role="presentation">
				<a aria-controls="VPC" data-toggle="tab" href="#baseInfo" role="tab">基本信息</a>
			</li>
			<li role="presentation">
				<a aria-controls="router" data-toggle="tab" href="#topo" role="tab">网络拓扑图</a>
			</li>
		</ul>
		<div class="tab-content">
			<div class="tab-pane active" id="baseInfo" role="tabpanel">
				<div class="wrapper-md">
					<p><strong>VPC名称：</strong><span data-bind="text:vpcVO().name"></span></p>
					<p><strong>所属VDC：</strong><span data-bind="text:vpcVO().vdcName"></span></p>
					<p><strong>可用分区：</strong><span data-bind="text:vpcVO().azName"></span></p>
					<p><strong>子网名称：</strong>
						<button class="btn btn-default btn-sm" onclick="showModal('pages/vdcs/subnets/newforvpc.html')">添加子网</button>
						<button class="btn btn-default btn-sm" onclick="showModal('pages/vdcs/subnets/newforvpc.html')">创建子网</button>
					</p>
				</div>
				<div class="row wrapper">
					<div class="col-xs-8">
						
					</div>
					<div class="col-xs-3">          
                        <div class="input-group">
                          <span class="input-group-addon">名称</span>
                          <input type="text" class="input-sm form-control" placeholder="请输入名称">
                        </div>
                    </div>
                    <div class="col-xs-1">
                        <button class="btn btn-sm btn-default" type="button">搜索</button>
                    </div>
				</div>		
				<table class="table table-striped">
					<thead>
						<tr>
							<th>子网名称</th>
							<th>网络类型</th>
							<th>网段</th>
							<th>IP总数</th>
							<th>创建时间</th>
							<th>操作</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>VPC01</td>
							<td>数据中心网络</td>
							<td>192.168.1.1/25</td>
							<td>200</td>
							<td>2016-04-24 19:38</td>
							<td>
								<a>删除</a>
							</td>
						</tr>
						<tr>
							<td>VPC01</td>
							<td>数据中心网络</td>
							<td>192.168.1.1/25</td>
							<td>200</td>
							<td>2016-04-24 19:38</td>
							<td>
								<a>查看</a>
							</td>
						</tr>
					</tbody>
				</table>
				<footer class="panel-footer">
					<ul class="pagination">
						<li class="page active">
							<a href="#pages/javascript:void(0)">1</a>
						</li>
						<li class="page">
							<a>2</a>
						</li>
						<li class="page">
							<a>3</a>
						</li>
						<li class="page">
							<a>4</a>
						</li>
						<li class="page">
							<a >5</a>
						</li>
						<li class="page gap disabled">
							<a href="#pages/javascript:void(0)">…</a>
						</li>
						<li class="next">
							<a>下页 ›</a>
						</li>
						<li class="last">
							<a>末页 »</a>
						</li>
					</ul>
				</footer>
			</div>
			<div class="tab-pane" id="topo" role="tabpanel">
				<div class="row">
					<div class="col-xs-8">
						<canvas id="canvas1" width=850 height=550></canvas>
					</div>
					<div class="col-xs-4 form-horizontal" style="padding-right:30px;padding-top:15px;">
						<div class="panel panel-default">
							<div class="panel-heading">子网配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">网络类型：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>公有网络</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">网络名称：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>网络名称1</option>
											<option>网络名称2</option>
										</select>
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">子网名称：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>子网名称1</option>
											<option>子网名称2</option>
										</select>
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">子网配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">网络类型：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>私有网络</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">子网名称：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">路由器配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">路由器名称：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">路由器地址：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">路由器配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">路由器名称：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">网络名称：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>网络1</option>
											<option>网络2</option>
										</select>
									</div>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">防火墙配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">配置方式：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>网络1</option>
											<option>网络2</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">防火墙名称：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">路由器：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>路由器1</option>
											<option>路由器2</option>
										</select>
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">规则：</label>
									<div class="col-xs-7">
										<a class="btn btn-link" onclick="showModal('pages/vpcs/topo_firewall.html')">查看</a>
									</div>
								</div>
							</div>
						</div>

						<div class="panel panel-default">
							<div class="panel-heading">防火墙配置</div>
							<div class="panel-body">
								<div class="form-group">
									<label  class="col-xs-4 control-label">配置方式：</label>
									<div class="col-xs-7">
										<select class="form-control">
											<option>网络1</option>
											<option>网络2</option>
										</select>
									</div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">防火墙名称：</label>
									<div class="col-xs-7">
										<input type="text" class="form-control">
									</div>
									<div class="col-xs-1">
							            <span class="text-danger inline m-l-n m-t-sm">*</span>
							        </div>
								</div>
								<div class="form-group">
									<label  class="col-xs-4 control-label">规则：</label>
									<div class="col-xs-7">
										<a class="btn btn-link" onclick="showModal('pages/vpcs/topo_firewall.html')">查看</a>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- page specific plugin scripts -->
<script type="text/javascript">
	var scripts = [null,'assets/js/jtopo.js', "api/vpc/vpc.js"]
	$('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
		var vpcUuid = args.vpcUuid;
		$.VPC.getVpcs({uuid:vpcUuid},function(data){
			  if(data.results && data.results.length > 0){
				    var vpcObj = data.results[0];
					function vpcInfoViewModel(){
			    		var self = this;
			    		self.vdcList = ko.observableArray();
			    		self.azList = ko.observableArray();
			    		self.vpcVO = ko.validatedObservable(vpcObj);
					}
					
				    ko.applyBindings(new vpcInfoViewModel(), $("#page-content")[0]);
			  }
	    });
		
		
       $(document).ready(function(){                 
			var canvas = document.getElementById('canvas1');
			var stage = new JTopo.Stage(canvas);
        //显示工具栏
        //showJTopoToobar(stage);
        var scene = new JTopo.Scene();    
        scene.background = 'assets/img/topo/bg.jpg';
        
        function node(x, y, img){
        	var node = new JTopo.Node();
        	node.setImage('assets/img/topo/' + img, true);                
        	node.setLocation(x, y);
        	scene.add(node);
        	return node;
        }                
        
        function linkNode(nodeA, nodeZ, f){
        	var link;
        	if(f){
        		link = new JTopo.FoldLink(nodeA, nodeZ);
        	}else{
        		link = new JTopo.Link(nodeA, nodeZ);
        	}
        	link.direction = 'vertical';
        	scene.add(link);
        	return link;
        }
        
        var s1 = node(305, 43, 'server.png');
        s1.alarm = '2 W';
        var s2 = node(365, 43, 'server.png');
        var s3 = node(425, 43, 'server.png');
        
        var g1 = node(366, 125, 'gather.png');
        linkNode(s1, g1, true);
        linkNode(s2, g1, true);
        linkNode(s3, g1, true);
        
        var w1 = node(324, 167, 'wanjet.png');
        linkNode(g1, w1);
        
        var c1 = node(364, 214, 'center.png');
        linkNode(w1, c1);
        
        var cloud = node(344, 259, 'cloud.png');
        linkNode(c1, cloud);
        
        var c2 = node(364, 328, 'center.png');
        linkNode(cloud, c2);
        
        var w2 = node(324, 377, 'wanjet.png');
        linkNode(c2, w2);
        
        var g2 = node(366, 411, 'gather.png');
        linkNode(w2, g2);
        
        function hostLink(nodeA, nodeZ){                
        	var link = new JTopo.FlexionalLink(nodeA, nodeZ);                
        	link.shadow = false;
        	link.offsetGap = 44;
        	scene.add(link);
        	return link;
        }
        
        var h1 = node(218, 520, 'host.png');
        h1.alarm = '';
        hostLink(g2, h1);
        var h2 = node(292, 520, 'host.png');
        hostLink(g2, h2);
        var h3 = node(366, 520, 'host.png');
        h3.alarm = '二级告警';
        hostLink(g2, h3);
        var h4 = node(447, 520, 'host.png');
        hostLink(g2, h4);
        var h5 = node(515, 520, 'host.png');
        h5.alarm = '1M';
        hostLink(g2, h5);
        
        setInterval(function(){
        	if(h3.alarm == '二级告警'){
        		h3.alarm = null;
        	}else{
        		h3.alarm = '二级告警'
        	}
        }, 600);
        
        stage.add(scene);
    });
});
</script>