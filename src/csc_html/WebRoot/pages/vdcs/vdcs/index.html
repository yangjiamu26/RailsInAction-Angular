<link href="assets/lib/zTree/css/ibos/ibos.css" rel="stylesheet" type="text/css"/>

<div class="app-content-full">
  <div class="bg-light lter b-b wrapper-sm">
    <ol class="breadcrumb">
      <li>当前位置：</li>
      <li class="active">VDC管理</li>
    </ol>
  </div>
  <!-- hbox layout -->
  <div class="hbox hbox-auto-xs bg-light " id="vdc_list_id" style="height:94%">
    <!-- column -->
    <div class="col w lter b-r">
      <div class="vbox">
        <div class="wrapper b-b" style="padding:10px 15px;">
          <div class="left-title text-md">VDC列表</div>
          <p></p>
          <div class="left-title text-md">
            <button class="btn btn-info btn-sm" data-bind="click:createVdc,check_action:'vdcCreate'">创建</button>
            <button class="btn btn-info btn-sm" data-bind="click:deleteVdc,enable:selectVdcVO().type != 'DEFAULT',check_action:'vdcCreate'" >删除</button>
            <button class="btn btn-info btn-sm" data-bind="click:editVdcGlobalQuota,check_action:'vdcCreate'">总配额</button>
          </div>
        </div>
        <div class="row-row">
          <div class="cell scrollable hover">
            <div class="cell-inner">
              <div class='table-responsive'>
                <table class='table table-striped table-hover left-list'>
                  <tbody   id="VDCLeftMenu"   data-bind="html: vdcListTable">
                 
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
      
	      <div role="dialog" aria-hidden="true"   class="modal fade" data-bind="modal: { show: createVdcMode}">
	      	<div class='modal-dialog' role='document'>
			<div class='modal-content'>
				<div class='modal-header'>
					<button type="button" class="close" data-dismiss="modal">
						<span aria-hidden="true">&times;</span>
					</button>
					<h3 class='modal-title' data-bind="ifnot: vdcVO().uuid">创建VDC</h3>
					<h3 class='modal-title' data-bind="if: vdcVO().uuid">修改VDC</h3>
				</div>
				<div class='modal-body'>
					<div class="form-horizontal">
						<div class="form-group">
							<label class="col-xs-2 control-label">VDC名称：</label>
							<div class="col-xs-9">
								<input type="text" class="form-control" placeholder="VDC名称"  data-bind="value:vdcVO().name" >
							</div>
							<div class="col-xs-1">
								<span class="text-danger inline m-l-n m-t-sm">*</span>
							</div>
						</div>
						<div class="form-group">
							<label for="inputEmail3" class="col-xs-2 control-label">描述：</label>
							<div class="col-xs-9">
								<textarea class="form-control" width="100%" rows='5'  data-bind="value:vdcVO().desc"></textarea>
							</div>
						</div>
					</div>
				</div>
				<div class='modal-footer'>
					<button class="btn btn-default btn-info"  data-bind="click: confirmCreateVdc">确定</button>
					<button class="btn btn-default btn btn-default " data-dismiss="modal">取消</button>
				</div>
			  </div>
	         </div>
	      </div>
	      
	      <!-- 总配额 -->
	      <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: vdcGlobalQuotaShow}" > 
			  <div class='modal-dialog' role='document'>
			    <div class='modal-content'>
			      <div class='modal-header'>
			        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
			        <h3 class='modal-title'>修改VDC总配额</h3>
			      </div>
			      <div class='modal-body form-horizontal'>
			      <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">CPU(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus" data-bind="value:vdcGlobalQuotaModel().CPU"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">云硬盘(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().DISK"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">防火墙(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().FIREWALL"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			      	<div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">负载均衡器(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().LOAD_BALANCING"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">内存(GB)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().MEMORY"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">对象存储(GB)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().OBJECT_STORAGE"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">公网IP(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().PUBLICIP"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">路由器(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().ROUTER"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">SSH密钥(对)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().SECRET_KEY"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">安全组(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().SECURITY_GROUP"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">存储(GB)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().STORAGE"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">云主机(台)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().VM"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">VPC(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().VPC"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			        <div class="form-group">
			          <label for="inputEmail3" class="col-xs-3 control-label">VPN(个)：</label>
			          <div class="col-xs-7">
			            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcGlobalQuotaModel().VPN"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
			          </div>
			          <div class="col-xs-1">
			            <span class="text-danger inline m-l-n m-t-sm">*</span>
			          </div>
			        </div>
			      </div>
			      <div class='modal-footer'>
			        <button class="btn btn-default btn-info" data-bind="click: saveVdcGlobalQuota">确定</button>
			        <button class="btn btn-default btn btn-default" data-dismiss="modal">取消</button> 
			      </div>
			    </div>
			  </div>
			</div>
	     <!-- 总配额 -->
	     
    </div>
    <!-- /column -->

    <!-- column -->
    <div class="col">
      <div class="vbox">
        <div class="row-row">
          <div class="cell">
            <div class="cell-inner">
              <div class='wrapper-md' id="vdc_summary_id">
                <div class="row">
                  <div class="col-xs-12 m-b-xs"> <button class="btn btn-sm btn-info" type="button" data-bind="click: applyChange,check_action:'vdcModiAppl'">申请变更</button>
                    <button class="btn btn-sm btn-default" type="button" id="expandAll">展开/收起全部</button>
                  </div>
                </div>  
                
                <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isApplyChange }">
                   	<form class="simple_form form-horizontal" novalidate="novalidate">
					  <div class='modal-dialog modal-lg' role='document'>
					    <div class='modal-content'>
					      <div class='modal-header'>
					        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>VDC变更申请</h3>
					      </div>
					      <div class='modal-body no-padder'>
					        <div class="panel panel-default">
					          <div class="panel-heading"><strong>VDC名称：</strong><span data-bind="text:selectVdcVO().name"></span></div>
					          <div class="panel-body no-padder form-inline">
					            <div class="form-group" style="padding:15px;">
					              <label for="exampleInputName2">支持的操作系统：</label>
					              <div class="checkbox"><label><input class="form-group" type="checkbox" data-bind="checked: applyChangeVdc().windows"/> Windows</label></div>&nbsp;&nbsp;
					              <div class="checkbox"><label><input class="form-group" type="checkbox" data-bind="checked: applyChangeVdc().linux"/> Linux</label></div>&nbsp;&nbsp;
					              <div class="checkbox"><label><input class="form-group" type="checkbox" data-bind="checked: applyChangeVdc().aix"/> Aix</label></div>
					            </div>
					            <div class="table-responsive no-height">
					              <table class="table table-striped">
					                <thead>
					                  <tr>
					                    <th></th>
					                    <th>申请前</th>
					                    <th>申请后</th>
					                    <th></th>
					                    <th>申请前</th>
					                    <th>申请后</th>
					                  </tr>
					                </thead>
					                <tbody>
					                  <tr>
					                    <td>CPU(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().cpu()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().cpu" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>内存(GB)</td>
					                    <td data-bind="text: applyChangeVdcBefore().memory()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().memory" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                  <tr>
					                    <td>存储(GB)</td>
					                    <td data-bind="text: applyChangeVdcBefore().storage()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().storage" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>VPC(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().vpc()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().vpc" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                  <tr>
					                    <td>云主机(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().vm()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().vm" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>云硬盘(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().disk()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().disk" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                  <tr>
					                    <td>公网IP(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().publicIp()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().publicIp" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>路由器(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().router()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().router" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                  <tr>
					                    <td>防火墙(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().firewall()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().firewall" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>负载均衡器(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().loadBalance()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().loadBalance" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                  <tr>
					                    <td>SSH密钥(对)</td>
					                    <td data-bind="text: applyChangeVdcBefore().secretKey()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().secretKey" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>对象存储(GB)</td>
					                    <td data-bind="text: applyChangeVdcBefore().objectStorage()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().objectStorage" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
									  <tr>
					                    <td>安全组(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().securityGroup()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().securityGroup" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                    <td>VPN(个)</td>
					                    <td data-bind="text: applyChangeVdcBefore().vpn()"></td>
					                    <td><input type="text" class="form-control input-sm" placeholder="不限配额" data-bind="value: applyChangeVdc().vpn" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"></td>
					                  </tr>
					                </tbody>
					              </table>
					            </div>
					          </div>
					        </div>
					      </div>
					      <div class='modal-footer'>
					        <input type="button" name="commit" value="确定" class="btn btn-default btn-info" data-bind="click: applyChangeSubmit"/>
					        <button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
					      </div>
					      <input type="hidden" data-bind="value: selectVdcVO().uuid">
					    </div>
					  </div>
					</form>
                   </div>

                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingOne">
                      <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
                          <i class="fa  fa-caret-down" style="width: 10px;"></i> 基本信息
                        </a>
                      </h4>
                    </div>
                    <div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne">
                      <div class="panel-body">
                        <p><strong>名称：</strong><span data-bind="text:selectVdcVO().name"></span></p>
                        <!-- <p><strong>有效期：</strong><span data-bind="text:selectVdcVO().expiryDate"></span></p> -->
                        <p><strong>描述：</strong><span data-bind="text:selectVdcVO().desc" style="word-break: break-all; white-space:pre-wrap;word-wrap : break-word;overflow: hidden;"></span></p>
                        <button class="btn btn-info btn-sm"  data-bind="click:modfiyVdc,visible:selectVdcVO().type != 'DEFAULT'">修改</button>
                      </div>
                    </div>
                  </div>
                  
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingTwo">
                      <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                          <i class="fa fa-caret-down fa-caret-right" style="width: 10px;"></i> 配额信息
                        </a>
                      </h4>
                    </div>
                    <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
                      <div class="panel-body">
                        <div class="form-inline">
                          <button class="btn btn-default btn-sm" data-bind="click:modifyVdcQuota,check_action:'vdcCreate'">分配配额</button>
                        </div>
                        <div class="">
                          <table class="table table-striped">
                            <thead>
                              <tr data-bind="visible:limitHeadFlag"><td>限制配额</td><td></td><td></td><td></td></tr>
                              <tr>
                                <th>配额</th>
                                <th>已使用</th>
                                <th>已申请</th>
                                <th>使用率（已用/已申请）</th>
                              </tr>
                            </thead>
                            <tbody data-bind="html: vdcQuotaListTable"></tbody>
                          </table>
                        </div>
                      </div>
                      
  	                <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: modifyVdcQuotaModel,backdrop: 'static' }" >  
                       <div class='modal-dialog' role='document'>
					    <div class='modal-content'>
					      <div class='modal-header'>
					        <button type="button" class="close" data-bind="click: closeEdit_quota" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>分配配额</h3>
					      </div>
					      <div class='modal-body form-horizontal'>
					      <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">CPU(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().CPU" id="quota_cpu"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">云硬盘(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().DISK" id="quota_disk"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">防火墙(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().FIREWALL" id="quota_firewall"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					      	<div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">负载均衡器(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().LOAD_BALANCING" id="quota_load_balancing"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">内存(GB)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().MEMORY" id="quota_cpu" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">对象存储(GB)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().OBJECT_STORAGE" id="quota_object_storage"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">公网IP(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().PUBLICIP" id="quota_publicip"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">路由器(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().ROUTER" id="quota_router"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">SSH密钥(对)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().SECRET_KEY" id="quota_secret_key"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">安全组(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().SECURITY_GROUP" id="quota_security_group" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">存储(GB)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().STORAGE" id="quota_cpu"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">云主机(台)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().VM" id="quota_vm"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">VPC(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().VPC" id="quota_vpc"  data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					        <div class="form-group">
					          <label for="inputEmail3" class="col-xs-3 control-label">VPN(个)：</label>
					          <div class="col-xs-7">
					            <input type="text" class="form-control"  placeholder="不限配额" data-bind="value:vdcQuotaVO().VPN" id="quota_vpn" data-toggle="tooltip" data-placement="right" title="-1为该项不限制" data-trigger="focus"  />
					          </div>
					          <div class="col-xs-1">
					            <span class="text-danger inline m-l-n m-t-sm">*</span>
					          </div>
					        </div>
					      </div>
					      <div class='modal-footer'>
					        <input type="button" name="commit" value="确定" data-bind="click:confirmModifyVdcQuota" class="btn btn-default btn-info" />
					        <button name="button" type="submit" class="btn btn-default btn btn-default" data-bind="click: closeEdit_quota" data-dismiss="modal">取消</button>
					      </div>
					    </div>
					  </div>
                     </div>

                    </div>
                  </div>
                  
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                      <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                          <i class="fa fa-caret-down fa-caret-right" style="width: 10px;"></i> 可用分区
                        </a>
                      </h4>
                    </div>
                    <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
                      <div class="panel-body">
                        <div class="row m-b-sm">
                          <div class="col-xs-2">
                            <a class="btn btn-sm btn-info" data-bind="click:addVdcAZ,check_action:'vdcCreate'">添加可用分区</a>
                          </div>
                        </div>        
                        <div class="table-responsive no-height">
                          <table class="table table-striped" data-bind="with:vdcRelAzListTable">
                            <thead>
                              <tr>
                                <th>云管理平台</th>
                                <th>虚拟化类型</th>
                                <th>可用分区</th>
                                <th data-bind="check_action:'vdcCreate'">操作</th>
                              </tr>
                            </thead>
                            <tbody>
                                <tr data-bind="visible: showNoData">
						            <td colspan=11 class="aligncenter">
						             	 暂无数据.
						            </td>
						        </tr>
						        <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
								<tr>
									<td data-bind="text: $row.cloudPlatform">平台名称</td>
	                                <td data-bind="text: $row.virtualHypervisor">类型名称</td>
	                                <td data-bind="text: $row.name"></td>
	                                <td  data-bind="check_action:'vdcCreate'"><a data-bind="click:$root.removeAzRul,check_action:'vdcCreate'">移除</a></td>
								</tr>	
							    <!-- /ko -->	
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                    
                    <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: addVdcAZModel }" >  
                     <div class='modal-dialog modal-lg' role='document'>
					    <div class='modal-content'>
					      <div class='modal-header'>
					        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加分区</h3>
					      </div>
					      <div class='modal-body'>
					        <div>
					          <div class="row" id="net_0">
					            <div class="col-xs-5">
					              <p>待选择：</p>
					              <div class="table-responsive">
					              <div style="height:400px; overflow:scroll;">
						              <table class="table table-striped">
						                <thead>
						                  <th>
						                    <div class="checkbox">
						                      <label class="i-checks">
						                        <input type="checkbox" value="">
						                        <i></i>
						                      </label>
						                    </div> 
						                  </th>
						                  <th>云管理平台</th>
						                  <th>虚拟化类型</th>
						                  <th>可用分区</th>
						                </thead>
						                <tbody  id="availableAzListTableId">
						                </tbody>
						              </table>
						             </div>
					              </div>
					            </div>
					            <div class="col-xs-2">
					              <button class="btn btn-block btn-default" id="addAz2PreAddList" style="margin-top:150px">&gt;&gt;</button>
					              <button class="btn btn-block btn-default" id="removeAz2PreAddList" >&lt;&lt;</button>
					            </div>
					            <div class="col-xs-5">
					              <p>已选择：</p>
					              <div class="table-responsive">               
					              <table class="table table-striped">
					                <thead>
					                  <th>
					                    <div class="checkbox">
					                      <label class="i-checks">
					                        <input type="checkbox" value="">
					                        <i></i>
					                      </label>
					                    </div> 
					                  </th>
					                  <th>云管理平台</th>
					                  <th>虚拟化类型</th>
					                  <th>可用分区</th>
					                </thead>
					                <tbody id="preAddAzListTableId">
					                </tbody>
					              </table>
					              </div>
					            </div>
					          </div>
					          <div id="net_1" style="display:none">
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>子网名称
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>生成IP方式
					              </label>
					              <div class="col-xs-3">
					                <select class="form-control" >
					                  <option>网段</option>
					                </select>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>开始地址
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>结束地址
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>掩码
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>网关
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>主DNS
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					            <div class="form-group string required">
					              <label class="string required col-xs-2 control-label">
					                <abbr title="必填项">*</abbr>备DNS
					              </label>
					              <div class="col-xs-3">
					                <input class="string required form-control" type="text"/>
					              </div>
					            </div>
					          </div>
					        </div>
					      </div>
					      <div class='modal-footer'>
					        <input type="button" name="commit" value="确定" data-bind="click:confirmAddAz" class="btn btn-default btn-info" />
					        <button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
					      </div>
					    </div>
					  </div>
                    </div>
                    
                    
                    
                  </div>
                  
                  
                  
                  
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                      <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseFore" aria-expanded="false" aria-controls="collapseThree">
                          <i class="fa fa-caret-down fa-caret-right" style="width: 10px;"></i> 网络
                        </a>
                      </h4>
                    </div>
                    <div id="collapseFore" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">

                      <div class="panel-body">
                        <div class="row m-b-sm">
                          <div class="col-xs-3">
                            <a class="btn btn-sm btn-info" data-bind="click:addVdcNetwork,check_action:'vdcCreate'">添加网络</a>
                          </div>
                        </div>        
                        <div class="table-responsive no-height">
                          <table class="table table-striped" data-bind="with:networkRelAzListTable">
                            <thead>
                              <tr>
                                <th>网络名称/IP池</th>
                                <th>云管理平台</th>
                                <th>可用分区</th>
                                <th  data-bind="check_action:'vdcCreate'">操作</th>
                              </tr>
                            </thead>
                            <tbody>
                               <tr data-bind="visible: showNoData">
						            <td colspan=11 class="aligncenter">
						              	暂无数据.
						            </td>
						        </tr>
						        <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
								<tr>
	                                <td data-bind="text: $row.netWorkName"></td>
	                                <td data-bind="text: $row.cloudPlatform"></td>
	                                <td data-bind="text: $row.azName"></td>
	                                <td  data-bind="check_action:'vdcCreate'" ><a data-bind="click:$root.removeAzNetworkRul,check_action:'vdcCreate'">移除</a></td>
								</tr>	
							    <!-- /ko -->
                            </tbody>
                          </table>
                        </div>
                       	<footer class="panel-footer" data-bind="with: networkRelAzListTable, visible: networkRelAzListTable.pages() > 1">
					      <ul class="pagination">
					        <li data-bind="css: leftPagerClass, click: prevPage">
					          <a href="#">&laquo;</a>
					        </li>
					        <!-- ko foreach: {data: (new Array(pages()))} -->
					        <li data-bind="css: $parent.pageClass($index() + 1)">
					          <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
					        </li>
					        <!-- /ko -->
					        <li data-bind="css: rightPagerClass, click: nextPage">
					          <a href="#">&raquo;</a>
					        </li>
					      </ul>
					    </footer>
					    
					   <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: addVdcNetworkModel }" >   
					    <div class='modal-dialog modal-lg' role='document'>
							<div class='modal-content'>
								<div class='modal-header'>
								<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加网络</h3>
								</div>
								<div class='modal-body form-horizontal'>
									<div class="row">
										<div class="col-xs-5" style="width:380px">
											<p>待选择：</p>
											<div class="form-inline text-right" style="margin-bottom:10px;">
												<select class="form-control input-sm"  data-bind="options:addVdcNetworkAzList,optionsText:'name',optionsValue:'uuid',value: addVdcNetworkAzVO().uuid">
												</select>
												<div class="form-group input-group">
					                            	<input type="text" class="input-sm form-control" style="width:100px;" placeholder="请输入名称" data-bind="value:addVdcNetworkSearchParam().name">
					                            	<button class="btn btn-sm btn-default" type="button" data-bind="click:addVdcNetworkSearch"  >搜索</button>
					                            </div>
											</div>
											<div style="height:400px; overflow:auto;">
												<table class="table table-striped" data-bind="with: networkTable">
													<thead>
														<th>
										                  <div class="checkbox">
										                    <label class="i-checks">
										                      <input type="checkbox" data-bind="checked: isSelectedAll">
										                      <i></i>
										                    </label>
										                  </div>
										                </th>
														<th>可用分区</th>
														<th>外部网络/IP池</th>
													</thead>
													
													<tbody>
													<!-- ko foreach: {data: pagedRows, as: '$row'}  -->
														<tr>
															<td>
																<div class="checkbox">
																	<label class="i-checks">
																		<input type="checkbox" data-bind="attr: {az: $row.azUuid, networkName: $row.name, networkUuid: $row.uuid}, checkedValue: $data, checked: $parent.chosenItems" ><i></i>
																	</label>
																</div>
															</td>
															<td style="white-space: nowrap;" data-bind="text: $row.azName"></td>
															<td style="white-space: nowrap;" data-bind="text: $row.name"></td>
														</tr>
													<!-- /ko -->
													</tbody>
												</table>
											</div>
										</div>
										<div class="col-xs-1">
											<button class="btn btn-block btn-default" data-bind="click: addNetworkAzRel" style="margin-top:150px">&gt;&gt;</button>
											<button class="btn btn-block btn-default" data-bind="click: removeNetworkAzRel" >&lt;&lt;</button>
										</div>
										<div class="col-xs-5" style="width:380px" >
										    <div class="form-inline text-right" style="margin-bottom:10px;height:30px">
											</div>
											<p>已选择：</p>
										   <div style="height:400px; overflow:auto;">
												<table class="table table-striped" data-bind="with: selectedNetworkTable">
													<thead>
														<th>
										                  <div class="checkbox">
										                    <label class="i-checks">
										                      <input type="checkbox" data-bind="checked: isSelectedAll">
										                      <i></i>
										                    </label>
										                  </div> 
										                </th>
														<th>可用分区</th>
														<th>外部网络/IP池</th>
													</thead>
													<tbody id="preAddAzNetworkListTableId">
													<!-- ko foreach: {data: pagedRows, as: '$row'}  -->
														<tr>
															<td>
																<div class="checkbox">
																	<label class="i-checks">
																		<input type="checkbox" data-bind="attr: {az: $row.azUuid, networkName: $row.name, networkUuid: $row.uuid}, checkedValue: $data, checked: $parent.chosenItems" ><i></i>
																	</label>
																</div>
															</td>
															<td style="white-space: nowrap;" data-bind="text: $row.azName"></td>
															<td style="white-space: nowrap;" data-bind="text: $row.name"></td>
														</tr>
													<!-- /ko -->
													</tbody>
												</table>
											</div>
										</div>
									</div>
								</div>
								<div class='modal-footer'>
									<input type="button" name="commit" value="确定"  data-bind="click:confirmVdcAddNetwork" class="btn btn-default btn-info" />
									<button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
								</div>
							</div>
						</div>
					    
					    
					        
                      </div>
                    </div>
                  </div>
                 </div>
                 
                  <div class="panel panel-default">
                    <div class="panel-heading" role="tab" id="headingThree">
                      <h4 class="panel-title">
                        <a class="collapsed" role="button" data-toggle="collapse"  href="#collapseFive" aria-expanded="false" aria-controls="collapseThree">
                          <i class="fa fa-caret-down fa-caret-right" style="width: 10px;"></i> 用户
                        </a>
                      </h4>
                    </div>
                    <div id="collapseFive" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">

                      <div class="panel-body">
                        <div class="row m-b-sm">
                          <div class="col-xs-5">
                            <a class="btn btn-sm btn-info" data-bind="click: addUser">添加用户</a>
                          </div>
                          <div class="col-xs-3 text-right">
                            <div class="input-group">
                              <span class="input-group-addon">VDC管理员</span>
                              <select class="input-sm form-control w-sm inline v-middle"  data-bind="value: $root.searchVdcUserParam().roles">
                                <option value="">请选择</option>
                                <option value="VDC_MANAGER">是</option>
                                <option value="VDC_USER">否</option>
                              </select>
                            </div>
                          </div>            
                          <div class="col-xs-3">          
                            <div class="input-group">
                              <span class="input-group-addon">账号</span>
                              <input type="text" class="input-sm form-control" placeholder="请输入账号" data-bind="value: $root.searchVdcUserParam().account">
                            </div>
                          </div>
                          <div class="col-xs-1">
                            <button class="btn btn-sm btn-default" type="button"  data-bind="click:$root.searchVdcUser">搜索</button>
                          </div>
                        </div>        
                        <div class="table-responsive no-height">
                          <table class="table table-striped" data-bind="with: vdcRelUsersListTable">
                            <thead>
                              <tr>
                                <th>账号</th>
                                <th>角色</th>
                                <th>VDC管理员</th>
                                <th>操作</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr data-bind="visible: showNoData">
						          <td colspan=11 class="aligncenter">
						              	暂无数据.
						          </td>
						      </tr>
						      <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
                              <tr>
                                <td data-bind="text: account"></td>
                                <td data-bind="text: sysRoles && (sysRoles.length > 19 ? sysRoles.substring(0,19)+'......' : sysRoles),attr:{title: sysRoles}"></td>
                                <td data-bind="text: roles == 'VDC_MANAGER' ? '是' : '否'"></td>
                                <td>
                                  <a data-bind="click: $root.editUser">修改</a> | 
                                  <a data-bind="click: $root.deletUser">移除</a>
                                </td>
                              </tr>
                              <!-- /ko -->
                            </tbody>
                          </table>
                        </div>
                        <footer class="panel-footer" data-bind="with: vdcRelUsersListTable, visible: vdcRelUsersListTable.pages() > 0">
	                       <ul class="pagination">
					       <li data-bind="css: leftPagerClass, click: gotoPage(1)">
					         <a href="#">首页</a>
					       </li>
					       <li data-bind="css: leftPagerClass, click: prevPage">
					         <a href="#">&laquo;</a>
					       </li>
					       <li >
					         <a href="#"  data-bind="text: currentPage"></a>
					       </li>
					       <li data-bind="css: rightPagerClass, click: nextPage">
					         <a href="#">&raquo;</a>
					       </li>
					       <li data-bind="css: rightPagerClass, click: gotoPage(pages())">
					         <a href="#">末页</a>
					       </li>
					       <li class="page-control-li">
					         <div class="input-group form-group-sm">
					           <input type="text" class="form-control" data-bind="value: targetPage"  />
					           <div class="input-group-btn">
					             <a href="#" class="btn btn-sm btn-default" data-bind="click: gotoTargetPage()">跳转</a>
					           </div>
					         </div>
					         <div class="page-info-div" data-bind="text: recordsText"></div>
					       </li>
					     </ul>
					   </footer>
                        
                        
                        <!-- 修改用户窗口 -->
                        <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: editUserModel }" >   
						   <div class='modal-dialog' role='document'>
						    <div class='modal-content'>
						      <div class='modal-header'>
						        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>修改用户</h3>
						      </div>
						      
						      <div class='modal-body'>
						      	<div class='form-horizontal'>
							        <div class="form-group">
							          <label for="inputEmail3" class="col-xs-3 control-label">账号：</label>
							          <div class="col-xs-9">
							            <label class="control-label" data-bind="text: userRolesVO().account"></label>
							          </div>
							        </div>
							        <div class="form-group">
							          <label for="inputEmail3" class="col-xs-3 control-label">VDC管理员：</label>
							          <div class="col-xs-9">
							            <select class="form-control" data-bind="value: userRolesVO().roles">
							              <option value="VDC_MANAGER">是</option>
							              <option value="VDC_USER">否</option>
							            </select>
							          </div>
							        </div>
						        </div>
						      </div>
						      <div class='modal-footer'>
						        <input type="button" name="commit" value="确定" class="btn btn-default btn-info" data-bind="click: saveEditRoles"/>
						        <button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
						      </div>
						    </div>
						  </div>
						</div>
						          
                      </div>
                    </div>
                  </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: addUserModel }" >   
   <div class='modal-dialog modal-lg' role='document'>
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加用户</h3>
      </div>
      <div class='modal-body'>
        <div class="row">
              <div class="col-xs-2">
                <div id="createVDCTree" class="ztree cell scrollable hover" style="overflow-x:auto;width: 140px;height: 355px">
                </div>
              </div>
              <div class="col-xs-4 cell scrollable hover" style="height: 355px">
                <p>待选择：</p>
                <table class="table table-striped" data-bind="with: orgUsersTable">
                  <thead>
                    <th>
                      <div class="checkbox">
				        <label class="i-checks">
				          <input type="checkbox" data-bind="checked: isSelectedAll">
				          <i></i>
				        </label>
				      </div>
                    </th>
                    <th>账号</th>
                  </thead>
                  <tbody>
                  <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
                    <tr>
                      <td>
                        <div class="checkbox">
					        <label class="i-checks">
					          <input type="checkbox" data-bind="checkedValue: $data, checked: $parent.chosenItems">
					          <i></i>
					        </label>
					    </div> 
                      </td>
                      <td data-bind="text: id"></td>
                    </tr>
                    <!-- /ko -->
                  </tbody>
                </table>
              </div>
              <div class="col-xs-1">
                <button class="btn btn-block btn-default" style="margin-top:150px" data-bind="click: addOrgUsers">&gt;&gt;</button>
                <button class="btn btn-block btn-default" data-bind="click: removeOrgUsers">&lt;&lt;</button>
              </div>
              <div class="col-xs-4 cell scrollable hover" style="height: 355px">
                <p>已选择：</p>
                <table class="table table-striped" data-bind="with: seletedOrgUserList">
                  <thead>
                    <th>
                      <div class="checkbox">
				        <label class="i-checks">
				          <input type="checkbox" data-bind="checked: isSelectedAll">
				          <i></i>
				        </label>
				      </div>
                    </th>
                    <th>账号</th>
                    <th>VDC管理员</th>
                  </thead>
                  <tbody>
                  <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
                    <tr>
                      <td>
                        <div class="checkbox">
					        <label class="i-checks">
					          <input type="checkbox" data-bind="checkedValue: $data, checked: $parent.chosenItems,value: $index">
					          <i></i>
					        </label>
					    </div> 
                      </td>
                      <td data-bind="text: id"></td>
                      <td data-bind="text: userType" name="selectUserType" style="display: none"></td>
                      <td>
                        <select name='role'>
                          <option value="VDC_USER">否</option>
                          <option value="VDC_MANAGER">是</option>
                        </select>
                      </td>
                    </tr>
                  <!-- /ko -->
                  </tbody>
                </table>
              </div>
            </div>
      </div>
      <div class='modal-footer'>
        <input type="button" name="commit" value="确定" class="btn btn-default btn-info" data-bind="click: saveUsers"/>
        <button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
      </div>
    </div>
  </div>
</div>
  <!-- page specific plugin scripts -->
  <script type="text/javascript">
    var scripts = ["api/vdc/vdc.js", "api/resource/network/network.js",'assets/lib/zTree/js/jquery.ztree.core.js', 
                   'assets/lib/zTree/js/jquery.ztree.excheck.js']
    $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
 

     var accordionBox = $("#accordion");
     $("#expandAll").on("click",function(){
       if($(".collapse.in",accordionBox).length > 0)
         $('.collapse',accordionBox).collapse('hide');
       else
         $('.collapse',accordionBox).collapse('show');
     });
     $("#accordion .collapse").on('show.bs.collapse', function () {
       $(this).prev().find(".fa-caret-down").toggleClass('fa-caret-right');
     });
     $("#accordion .collapse").on('hide.bs.collapse', function () {
       $(this).prev().find(".fa-caret-down").toggleClass('fa-caret-right');
     });

     var setting = {
   	      view:{
   	        showIcon:false,
   	        showLine:false
   	      },
   	      callback : {
   	          onClick : function(srcEvent, treeId, node, clickFlag) {
   	              srcEvent.preventDefault();
   				  vdcListViewModal.orgUsersTable.params({
   					  orgId: node.code,
   					  userType: node.userType,
   					  size : "0",
   					  vdcUuid:vdcListViewModal.selectVdcVO().uuid
   				  })
   	          }
   	      }
   	  };
      //获取用户组织树
	  function loadOrgTree(){
		  csc.rest.get('api/v5.0.0/uap/organizations',function(data){
	          $.fn.zTree.init($("#createVDCTree"), setting, data);
	      });
	  }
	      
     function VdcListViewModal(){
	    	    var self = this;
	    		self.vdcListTable =  ko.observable();// new DataTable([], {path: 'api/v5.0.0/vdcs', perPage: 10000});
	    		self.vdcQuotaListTable = ko.observable();//VDC配额项列表
	    		self.limitHeadFlag = ko.observable(true);
	    		self.selectVdcVO = ko.observable({});//选中的vdc
	    		self.isLimit = ko.observable("0");//是否限制配额
	    		self.vdcRelAzListTable = new DataTable([]);//可用分区列表
	    		self.networkRelAzListTable = new DataTable([]);//网络列表
	    		
	    		self.searchVdcUserParam = ko.observable({
        	        account: "",
        	        roles:""
        	    })
        	    
	       	    self.searchVdcUser = function(){
	       	       self.vdcRelUsersListTable.params(this.searchVdcUserParam());
	       	    }
			
	    		
	    		var intForVdcQuota = {
           			maxLength: 10,
           			number: {
                           params: true,  
                           message: "必须是数字",
                       },
                       min: {
                       	params: -1,
                       	message: "请输入大于等于-1的数字" 
                       },
                       max: {
                       	params: 2147483647,
                       	message: "输入有误，最大值为：2147483647" 
                       },
                       pattern: {
                        params: /^-?\d+$/g,
                        message: "必须是整数"
                    }
           		};
	    		self.vdcQuotaVO = ko.validatedObservable({
 		             "VM":ko.observable().extend(intForVdcQuota),
			         "DISK" :ko.observable().extend(intForVdcQuota),
			         "ROUTER":ko.observable().extend(intForVdcQuota),
			         "PUBLICIP":ko.observable().extend(intForVdcQuota),
			         "LOAD_BALANCING":ko.observable().extend(intForVdcQuota),
			         "SECRET_KEY":ko.observable().extend(intForVdcQuota),
			         "OBJECT_STORAGE":ko.observable().extend(intForVdcQuota),
			         "CPU": ko.observable().extend(intForVdcQuota),
			         "MEMORY":ko.observable().extend(intForVdcQuota),
			         "STORAGE":ko.observable().extend(intForVdcQuota),
			         "FIREWALL":ko.observable().extend(intForVdcQuota),
				     "VPC":ko.observable().extend(intForVdcQuota),
				     "SOFTWARE":ko.observable().extend(intForVdcQuota),
				     "VPN":ko.observable().extend(intForVdcQuota),
				     "SECURITY_GROUP":ko.observable().extend(intForVdcQuota)
	    		})
	    		
	    	    /****配额***/
	    		self.modifyVdcQuotaModel = ko.observable(false);
				self.modifyVdcQuota = function(){
					self.modifyVdcQuotaModel(true)	
			    }
				self.confirmModifyVdcQuota = function(){
					ko.validation.group(self.vdcQuotaVO).showAllMessages();
	    	        if(self.vdcQuotaVO.isValid()){
	    	        	self.isPreConfigQuota = false;
	    	        	var vdcQuota = self.vdcQuotaVO.toJSON();
	    	        	var quotaOptList = [];
	    	        	for(var key in vdcQuota){
	    	        		quotaOptList.push({"type":key,"value":vdcQuota[key]});
	    	        	}
	    	        	
	    	        	var quotaParam = {
	    	        			"limitQuota":true,//修改配额时肯定是限制资源大小
	    	        			"quotaOpt":quotaOptList
	    	        	 }   
	    	        	$.VDC.updateQuota(self.selectVdcVO().uuid,quotaParam,function(data){
	    	        		self.selectVdcVO(data)
	    	        		loadVdcList();
	    	        		self.modifyVdcQuotaModel(false);
	    	        	});
	    	        }
				}
			
				self.isPreConfigQuota = ko.observable(false);
				
				self.closeEdit_quota = function(){
					  self.isPreConfigQuota = false;
					  self.modifyVdcQuotaModel(false)
				}
				/****配额***/
				
				/****总配额***/
				self.vdcGlobalQuotaShow = ko.observable(false);
				
				var vdcGlobalQuotaJSON = {
					 "VM":"",
			         "DISK" :"",
			         "ROUTER":"",
			         "PUBLICIP":"",
			         "LOAD_BALANCING":"",
			         "SECRET_KEY":"",
			         "OBJECT_STORAGE":"",
			         "CPU": "",
			         "MEMORY":"",
			         "STORAGE":"",
			         "FIREWALL":"",
				     "VPC":"",
				     "SOFTWARE":"",
				     "VPN":"",
				     "SECURITY_GROUP":""
			    };
				
				
				self.vdcGlobalQuotaModel = ko.validatedObservable({
                    "VM":ko.observable().extend(intForVdcQuota),
			         "DISK" :ko.observable().extend(intForVdcQuota),
			         "ROUTER":ko.observable().extend(intForVdcQuota),
			         "PUBLICIP":ko.observable().extend(intForVdcQuota),
			         "LOAD_BALANCING":ko.observable().extend(intForVdcQuota),
			         "SECRET_KEY":ko.observable().extend(intForVdcQuota),
			         "OBJECT_STORAGE":ko.observable().extend(intForVdcQuota),
			         "CPU": ko.observable().extend(intForVdcQuota),
			         "MEMORY":ko.observable().extend(intForVdcQuota),
			         "STORAGE":ko.observable().extend(intForVdcQuota),
			         "FIREWALL":ko.observable().extend(intForVdcQuota),
				     "VPC":ko.observable().extend(intForVdcQuota),
				     "SOFTWARE":ko.observable().extend(intForVdcQuota),
				     "VPN":ko.observable().extend(intForVdcQuota),
				     "SECURITY_GROUP":ko.observable().extend(intForVdcQuota)
				});
				
				self.editVdcGlobalQuota = function() {
					$.VDC.getVdcGlobalQuota(function(data){
						 if(data && data.results){
							  var vdcGlobalQuotaList = data.results;
							  for(var i = 0; i < vdcGlobalQuotaList.length; i++){
								   var globalQuota = vdcGlobalQuotaList[i];
								   for(var item in vdcGlobalQuotaJSON) {
									   if(item === globalQuota.type){
										   vdcGlobalQuotaJSON[item] = globalQuota.value != '-1' ? globalQuota.value : "";
										   break;
									   }
								   }
							  }
						 }
						 self.vdcGlobalQuotaModel.fromJSON(vdcGlobalQuotaJSON);
					 });
					self.vdcGlobalQuotaShow(true);
				}
				
				self.saveVdcGlobalQuota = function() {
					ko.validation.group(this.vdcGlobalQuotaModel).showAllMessages();   
			        if(this.vdcGlobalQuotaModel.isValid()){
						var paramItemArray = new Array();
						var vdcGlobalQuotaJson = self.vdcGlobalQuotaModel.toJSON();
						
						for (var item in vdcGlobalQuotaJson) {
							paramItemArray.push({"type" : item, "value" : vdcGlobalQuotaJson[item]});
						}
						
						var param = {"quotaOpt": paramItemArray};
						$.VDC.modifyVdcGlobalQuota(param, function(data){
							 if (data) {
							  alert("总配额修改成功！");
							 }
						 });
						self.vdcGlobalQuotaShow(false);
			        }
				}
				/****总配额***/
				
				/*****添加AZ下的网络*****/
				self.addVdcNetworkModel = ko.observable(false);
				
				self.addVdcNetworkAzList = ko.observableArray();
				self.addVdcNetworkAzVO = ko.observable({"uuid":""});
				self.addVdcNetworkSearchParam = ko.observable({ name: "" });
	        	self.addVdcNetworkAzList([]);
				
				self.removeAzNetworkRul = function(rowObj){
					var name = rowObj.netWorkName;
	    			confirm("确定移除网络["+name+"]？",function(arg){
	    				$.VDC.removeVdcNetwork(self.selectVdcVO().uuid,rowObj.netWorkUuid,function(data){
	    					self.networkRelAzListTable.refreshData()
							alert("移除网络["+name+"]成功！")
						});
	    			 });
				

				}
				
				
	    		self.networkTable = new DataTable([]);
	    		self.selectedNetworkTable = new DataTable([]);
	    		
			    self.addVdcNetworkSearch = function(){
					var azUuid = self.addVdcNetworkAzVO().uuid ;
					if(!azUuid){
						return;
					}
					var name = self.addVdcNetworkSearchParam().name;
					
					self.networkTable.path("api/v5.0.0/networks/" + self.selectVdcVO().uuid + "?azUuid=" + azUuid + "&name=" + name);
	       	    }
			    
				self.addVdcNetwork = function(){
					self.selectedNetworkTable.pagedRows([]);
					self.networkTable.pagedRows([]);
					
					$.VDC.getVdcAzs(self.selectVdcVO().uuid,{},function(data){
					   if(data && data.results){
						   self.addVdcNetworkAzList(data.results);
					   }
					   self.addVdcNetworkSearch();
					});
					
					self.addVdcNetworkModel(true);
				}
				
				//添加network(>>)
				self.addNetworkAzRel = function() {
					//左侧待添加
					var chosenItemList = self.networkTable.chosenItems();
					var networkList = self.networkTable.pagedRows();
					
					//左侧剩余
					var filterNetworkList = new DataTable([]).pagedRows();
					//右侧已添加					
					var selectedNetworkList = self.selectedNetworkTable.pagedRows();
					
					if (chosenItemList != null && chosenItemList.length > 0) {
						for (var j = 0; j < networkList.length; j++) {
							var exists = true;
							for (var i = 0; i < chosenItemList.length; i++) {
								if (networkList[j].azUuid === chosenItemList[i].azUuid && chosenItemList[i].uuid === networkList[j].uuid) {
									selectedNetworkList.push(chosenItemList[i]);
									exists = false;
									break;
								}
							}
							
							if (exists) {
								filterNetworkList.push(networkList[j]);
							}
						}
						self.selectedNetworkTable.pagedRows(selectedNetworkList);
						self.networkTable.pagedRows(filterNetworkList);
					}
				}
				
				//移除network(<<)
				self.removeNetworkAzRel = function(){
					var chosenItemList = self.selectedNetworkTable.chosenItems();
					var networkList = self.selectedNetworkTable.pagedRows();
					
					var filterNetworkList = new DataTable([]).pagedRows();
					var selectedNetworkList = self.networkTable.pagedRows();
					
					if (chosenItemList != null && chosenItemList.length > 0) {
						for (var j = 0; j < networkList.length; j++) {
							var exists = true;
							for (var i = 0; i < chosenItemList.length; i++) {
								if (networkList[j].azUuid === chosenItemList[i].azUuid && chosenItemList[i].uuid === networkList[j].uuid) {
									selectedNetworkList.push(chosenItemList[i]);
									exists = false;
									break;
								}
							}
							
							if (exists) {
								filterNetworkList.push(networkList[j]);
							}
						}
						self.selectedNetworkTable.pagedRows(filterNetworkList);
						self.networkTable.pagedRows(selectedNetworkList);
					}
	    	    }
				
				self.confirmVdcAddNetwork = function(){
					var azs = [];
					$("#preAddAzNetworkListTableId input[type='checkbox']").each(function(){
						var azUuid = $(this).attr("az");
						var networkName = $(this).attr("networkName");
						var networkUuid = $(this).attr("networkUuid");;
					    var notFound = true;
						for(var az in azs){
							var azVo = azs[az];
							if(azVo.uuid == azUuid){
								if(!azVo.networks){
									azVo.networks = [];
								}
								azVo.networks.push({"uuid":networkUuid,"name":networkName});
								notFound = false;
								break;
							}
						}
						if(notFound){
							azs.push({"uuid":azUuid,networks:[{"uuid":networkUuid,"name":networkName}]});
						}
				    })
				    
					 $.VDC.addNetworks(self.selectVdcVO().uuid,{"azs":azs},function(data){
						self.addVdcNetworkModel(false)
						self.networkRelAzListTable.refreshData();
					}); 
				}
				
				/*****添加AZ下的网络*****/
				
				
				/****添加AZ*****/
				self.addVdcAZModel = ko.observable(false);
				
				self.addVdcAZ = function(){
					$("#availableAzListTableId").html("");
					$("#preAddAzListTableId").html("");
					$.VDC.getAvailableToVdc({},function(data){
						  var tableBody = "";
						  if(data && data.results){
							  var azList = data.results;
							  for(var i=0;i<azList.length;i++){
								  var az = azList[i];
								  tableBody += "<tr><td><div class=\"checkbox\"><label class=\"i-checks\"><input type=\"checkbox\" value=\""+ az.uuid +"\" /><i></i></label></div></td>";
								  tableBody +="<td>"+az.cloudPlatform+"</td><td>"+az.virtualHypervisor+"</td><td>"+az.name+"</td></tr>";
							  } 
						  }
						  $("#availableAzListTableId").html(tableBody);
					});
					self.addVdcAZModel(true);
					
					$("#addAz2PreAddList").bind("click",function(data){
					    $("#availableAzListTableId input[type='checkbox']").each(function(){
					    	   if($(this).prop("checked")){
					    		   $("#preAddAzListTableId").append($(this).parents("tr").prop("outerHTML")) 
							    	$(this).parents("tr").remove()
					    	  }
					    })
					})
					
					$("#removeAz2PreAddList").bind("click",function(data){
						$("#preAddAzListTableId input[type='checkbox']").each(function(){
							  if($(this).prop("checked")){
								  $("#availableAzListTableId").append($(this).parents("tr").prop("outerHTML")) 
								  $(this).parents("tr").remove()
							  }
					    })
					})
				}
				
				self.confirmAddAz = function(){
					var azs = [];
					$("#preAddAzListTableId input[type='checkbox']").each(function(){
						azs.push({uuid:$(this).val()});
				    })
				    
					$.VDC.addVzsToVdc(self.selectVdcVO().uuid,{"azs":azs},function(data){
						   self.addVdcAZModel(false);
						   self.vdcRelAzListTable.refreshData();
					});
				}
				/****添加AZ******/
		          
				/*******vdc加载数据****/
				loadVdcList();
	    		function loadVdcList(){
	    			$.VDC.getVDCs({},function(data){
		    			  var tableBody = "";
		    			  var firestVdc = {};
		    			  var vdcList = [];
		    			  
		    			  if(data && data.results){
		    				  vdcList = data.results;
		    				  for(var i=0;i<vdcList.length;i++){
		    					  var vdc = vdcList[i];
		    					  
		    					  //vdc名称过长处理
		    					  var tempVdcName = subTextByDefualt(vdc.name);
		    					  if(i == 0){
		    						  firestVdc = vdc;
		    						  tableBody = "<tr class='active' vdcUuid='"+vdc.uuid+"' title='" + vdc.name + "'><td><a>"+tempVdcName+"</a</td></tr>";
		    					  }else{
		    						  tableBody += "<tr vdcUuid='"+vdc.uuid+"' title='" + vdc.name + "'><td><a>"+tempVdcName+"</a</td></tr>";
		    					  }
		    				  }
		    			  }
		    			  self.vdcListTable(tableBody);
		    			  if(self.selectVdcVO() && self.selectVdcVO().name){
		    				  firestVdc = self.selectVdcVO();
		    			  } 
		    			  setVDCSummaryInfo(firestVdc);
		    			  
		    			  $("#VDCLeftMenu").on("click","tr",function(){
		    		    	  $(this).addClass('active').siblings().removeClass('active');
		    		    	  var vdcUuid = $(this).attr("vdcUuid")
		    		    	  $.VDC.getVDCs({uuid:vdcUuid},function(data){
		    		    		  if(data && data.results && data.results.length >0){
		    		    			  setVDCSummaryInfo(data.results[0])
		    		    		  }
		    		    	  })
		    		      }) 
		    		      
		    		      
		    		      function setVDCSummaryInfo(vdc){
		    				  self.selectVdcVO(vdc);
		    				  self.vdcQuotaListTable("");
		    				  var vdcQuotaJSON = {
							     "VM":"",
						         "DISK" :"",
						         "ROUTER":"",
						         "PUBLICIP":"",
						         "LOAD_BALANCING":"",
						         "SECRET_KEY":"",
						         "OBJECT_STORAGE":"",
						         "CPU":"",
						         "MEMORY":"",
						         "STORAGE":"",
						         "FIREWALL":"",
							     "VPC":"",
							     "VPN":"",
							     "SECURITY_GROUP":""
							  };
		    				  
	    					  $.VDC.getVdcQuota(vdc.uuid,{},function(data){
	    						  var tableBody = "";
	    						  var tableBodyForUnlimited = "";
		    					  if(data && data.results){
		    						  var vdcQuotaList  = data.results;
		    						  for(var i=0;i<vdcQuotaList.length;i++){
		    	    					   var quota = vdcQuotaList[i];
		    	    					   vdcQuotaJSON[quota.type] = quota.value;
		    	    					   var type = quota.type?quota.type:"";
		    	    					   var use = quota.use?quota.use:0;
		    	    					   var value = quota.value?quota.value:0;
		    	    					   var use = quota.use?quota.use:0;
		    	    					   var percent = 0
		    	    					   if(value != 0){
		    	    						   var percent =  parseFloat(csc.util.accMul(csc.util.accDiv(use,value),100)).toFixed(0);
		    	    					   }
		    	    					   if (value != '-1') {
		    	    						   tableBody += "<tr><td>"+csc.util.getResourceText(type)+"("+csc.util.getResourceUnit(type)+")</td><td>"+use+"</td><td>"+value+"</td><td>";
			    	    					   tableBody += "<div class=\"progress progress-sm\"><div class=\"progress-bar progress-bar-warning\" role=\"progressbar\" aria-valuenow=\""+use+"\" aria-valuemin=\"0\" aria-valuemax=\""+ value +"\" style=\"width: "+percent+"%;\">";
			    	    					   tableBody += percent+"%";
			    	    					   tableBody += "</div></div></td></tr>";
		    	    					   } else {
		    	    						   tableBodyForUnlimited += "<tr><td>"+csc.util.getResourceText(type)+"("+csc.util.getResourceUnit(type)+")</td><td>"
		    	    						   		+use+"</td><td></td><td></td></tr>";
		    	    					   }
		    	    					   
		    	    				  }
		    					  }
		    					  
		    					  if (tableBody === "") {
		    						  self.limitHeadFlag(false);
		    					  } else {
		    						  self.limitHeadFlag(true);
		    					  }
		    					  
		    					  if (tableBodyForUnlimited != "") {
		    						  tableBody += "<tr><td>不限配额</td><td></td><td></td><td></td></tr>" + tableBodyForUnlimited;
		    					  }
		    					  self.vdcQuotaListTable(tableBody);
		    					  
		    					  for(var key in vdcQuotaJSON){
									  if(self.vdcQuotaVO()[key] && ko.isObservable(self.vdcQuotaVO()[key]) && vdcQuotaJSON[key] != '-1'){
									    self.vdcQuotaVO()[key](vdcQuotaJSON[key]);
									  } else if (vdcQuotaJSON[key] != '-1'){
										  self.vdcQuotaVO()[key] = vdcQuotaJSON[key];
									  } else {
										  self.vdcQuotaVO()[key] = "";//不限制时(-1)默认不显示
									  }
									}
		    				   });
		    				 
		    				  
		    				self.vdcRelAzListTable.perPage(100000);//重新加载数据 
		    				self.vdcRelAzListTable.path('api/v5.0.0/vdcs/'+vdc.uuid+'/azs');
		    				
		    				self.networkRelAzListTable.perPage(100000);//重新加载数据 
		    				self.networkRelAzListTable.path('api/v5.0.0/vdcs/'+vdc.uuid+'/networks');
		    				
		    				self.networkRelAzListTable.perPage(100000);//重新加载数据 
		    			    self.vdcRelUsersListTable.path("api/v5.0.0/vdcs/"+vdc.uuid+"/users");//vdc下用户
		    			    
		    			    
		    				self.removeAzRul = function(rowObj){
		    					var name = rowObj.name;
		    	    			confirm("确定移除可用分区["+name+"]？",function(arg){
		    	    				$.VDC.removeVdcAz(vdc.uuid,rowObj.uuid,function(data){
		    	    					  self.vdcRelAzListTable.refreshData();
		    	    					  alert("移除可用分区["+name+"]成功！")
		    	           			});
		    	    			 });
		    				}
		    				  
		    			}
		    		});
				}
	    		/*******vdc加载数据****/
	    		
	    		
	    		//字符串过长处理，汉字、大写字母特殊处理
	    		function subTextByDefualt(text) {
	    			var strlen = 11;//全汉字长度
	    			var sinogramLength = 15;//包含汉字最大长度
	    			var uppercaseLength = 19;//大写字母最大长度
	    			var lowercaseLength = 22;//全小写字母最大长度
	    			var testFlag = false, uppercaseFlag = false;
					if (text != null && text != undefined) {
						for(var i = 0; i < text.length; i++) {
							var charCode = text.charCodeAt(i);
							if(charCode < 65 || charCode > 90 && charCode < 256){//如果不是汉字、大写字母，则字符串长度加2
								strlen += 2;
							} else if (charCode > 64 && charCode < 91) {
								uppercaseFlag = true;
							} else {
								testFlag = true;
							}
						}
						
						if (strlen > sinogramLength) {
							if (testFlag) {
								strlen = sinogramLength;
							} else if (uppercaseFlag) {
								strlen = uppercaseLength;
							} else {
								strlen = lowercaseLength;
							}
						}
						
						return text.length <= strlen ? text : text.substring(0, strlen) + "...";
					}
					return text;
	    		}

	    		
	    		/*******vdc管理****/
	    		self.createVdcMode = ko.observable(false);
	    		self.vdcVO = ko.validatedObservable({
    			     "name":ko.observable("").extend({required: true,maxLength:32,cscNameRule:true}),
					 "desc":ko.observable().extend({maxLength:255}),
					 "uuid":null
				});
	    		
	    		
	    		self.createVdc = function(){
    			   self.vdcVO.fromJSON({"name":"",
						 "desc":"",
						 "uuid":null
						});
    			   self.createVdcMode(true)	
	    		}
	    		
	    		self.modfiyVdc = function(){
   				   var name = self.selectVdcVO().name;
   				   var desc = self.selectVdcVO().desc;
   				   var uuid = self.selectVdcVO().uuid;
    			   self.vdcVO.fromJSON({"name":name,
						 "desc":desc,
						 "uuid":uuid
					});
    			   self.createVdcMode(true);
	    		}
	    		
	    		
	    		self.confirmCreateVdc = function(){
	    			var vdcUuid = self.vdcVO.toJSON().uuid;
	      			if (!vdcUuid) {
	      				ko.validation.group(self.vdcVO).showAllMessages();
	 	    	        if(self.vdcVO.isValid()){
 	    	        		var param = self.vdcVO.toJSON();
 		    				$.VDC.createVDC(param, function(data) {
 		    					var tempName = subTextByDefualt(data.name);
	 		    				var tableBody = "<tr vdcUuid='" + data.uuid + "' title='" + data.name + "'><td><a>" + tempName + "</a</td></tr>";
	 		    				self.vdcListTable(self.vdcListTable() + tableBody)
	 		    				self.createVdcMode(false)
 		    				});
	 	    	        }
	      			} else {
	      				ko.validation.group(self.vdcVO).showAllMessages();
	 	    	        if (self.vdcVO.isValid()) {
 	    	        	   var param = self.vdcVO.toJSON();
 	    	        	   var uuid = param.uuid;
 	    	        	   param.uuid = null;
 		    			   $.VDC.modifyVDC(uuid, param, function(data) {
 		    				   var selectVdc = self.selectVdcVO();
 		    				   selectVdc.name = data.name;
 		    				   selectVdc.desc = data.desc;
 		    				   self.selectVdcVO(selectVdc);
 		    				   var tempName = subTextByDefualt(data.name);
 		    				   $("#VDCLeftMenu tr").each(function() {
 		    					   if(uuid == $(this).attr("vdcUuid")) {
 		    						   $(this).find("td a").html(tempName);
 		    						   $(this).attr("title", data.name);
 		    					   }
 		    				   });
 		    				   self.createVdcMode(false);
 		    				   if (data) {
 		    					  alert("修改VDC成功！");
 		    				   }
 		    			   });
	 	    	        }
	      			}
	    		}
	    		
	    	    self.deleteVdc = function(){
			    	if(self.selectVdcVO() && self.selectVdcVO().name){
			    		var name = self.selectVdcVO().name;
			    		confirm("确定删除VDC["+name+"]？",function(){
				    		$.VDC.delVdc(self.selectVdcVO().uuid,function(data){
				    			self.selectVdcVO({});
				    			loadVdcList();
				    			alert("移除删除VDC["+name+"]成功！")
				    		})
				    	});
			    	}
			    }	
	    	    /*******vdc管理****/
	    	    
	    	    /*******vdc申请变更****/
	    	    this.isApplyChange = ko.observable(false);
	    	    this.applyChangeVdcBefore = ko.validatedObservable({
	    	        cpu: ko.observable(""),
	    	        memory: ko.observable(""),
	    	        storage: ko.observable(""),
	    	        vpc: ko.observable(""),
	    	        vm: ko.observable(""),
	    	        disk: ko.observable(""),
	    	        publicIp: ko.observable(""),
	    	        router: ko.observable(""),
	    	        firewall: ko.observable(""),
	    	        loadBalance: ko.observable(""),
	    	        secretKey: ko.observable(""),
	    	        objectStorage: ko.observable(""),
					software: ko.observable(""),
	    	        securityGroup: ko.observable(""),
	    	  	    vpn: ko.observable("")
	    	    });
	    	    this.quotas = ko.observable("");
	    	    
	    	    var intForVdcQuotaEx = {
            			maxLength: 10,
            			number: {  
                            params: true,  
                            message: "必须是数字",
                        },
                        min: { 
                        	params: -1,
                        	message: "请输入大于等于-1的数字" 
                        },
                        max: { 
                        	params: 2147483647,
                        	message: "输入有误，最大值为：2147483647" 
                        },
                        pattern: {  
	                        params: /^-?\d+$/g,
	                        message: "必须是整数"
	                    }
            		};
	    	    
	    	    this.applyChangeVdc = ko.validatedObservable({
	    	        cpu: ko.observable("").extend(intForVdcQuotaEx),
	    	        memory: ko.observable("").extend(intForVdcQuotaEx),
	    	        storage: ko.observable("").extend(intForVdcQuotaEx),
	    	        vpc: ko.observable("").extend(intForVdcQuotaEx),
	    	        vm: ko.observable("").extend(intForVdcQuotaEx),
	    	        disk: ko.observable("").extend(intForVdcQuotaEx),
	    	        publicIp: ko.observable("").extend(intForVdcQuotaEx),
	    	        router: ko.observable("").extend(intForVdcQuotaEx),
	    	        firewall: ko.observable("").extend(intForVdcQuotaEx),
	    	        loadBalance: ko.observable("").extend(intForVdcQuotaEx),
	    	        secretKey: ko.observable("").extend(intForVdcQuotaEx),
	    	        objectStorage: ko.observable("").extend(intForVdcQuotaEx),
	    	        software: ko.observable("").extend(intForVdcQuotaEx),
	    	        securityGroup: ko.observable("").extend(intForVdcQuotaEx),
	    	  	    vpn: ko.observable("").extend(intForVdcQuotaEx),
	    	        
	    	        windows:ko.observable(""),
	    	        linux:ko.observable(""),
	    	        aix:ko.observable(""),
	    	        
	    	        serviceInstanceUuid:ko.observable("")
	    	      });
	    	    self.applyChange = function(object, event){
	    	    	var uuid = self.selectVdcVO().uuid;
	    	    	$.VDC.getVdcQuota(uuid,"",function(data){
	    	    		var vdcQuotaList = data.results;
	    	    		for(var i = 0;i<vdcQuotaList.length;i++){
	    	    			var quotaValue = (vdcQuotaList[i].value != '-1' ? vdcQuotaList[i].value : '不限制');
	    	    			if(vdcQuotaList[i].type=='CPU'){
	    	      				self.applyChangeVdcBefore().cpu(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='MEMORY'){
	    	      				self.applyChangeVdcBefore().memory(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='STORAGE'){
	    	      				self.applyChangeVdcBefore().storage(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='VPC'){
	    	      				self.applyChangeVdcBefore().vpc(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='VM'){
	    	      				self.applyChangeVdcBefore().vm(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='DISK'){
	    	      				self.applyChangeVdcBefore().disk(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='PUBLICIP'){
	    	      				self.applyChangeVdcBefore().publicIp(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='ROUTER'){
	    	      				self.applyChangeVdcBefore().router(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='FIREWALL'){
	    	      				self.applyChangeVdcBefore().firewall(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='SECRET_KEY'){
	    	      				self.applyChangeVdcBefore().secretKey(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='OBJECT_STORAGE'){
	    	      				self.applyChangeVdcBefore().objectStorage(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='LOAD_BALANCING'){
	    	      				self.applyChangeVdcBefore().loadBalance(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='SOFTWARE'){
	    	      				self.applyChangeVdcBefore().software(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='SECURITY_GROUP'){
	    	      				self.applyChangeVdcBefore().securityGroup(quotaValue);
	    	      			}else if(vdcQuotaList[i].type=='VPN'){
	    	      				self.applyChangeVdcBefore().vpn(quotaValue);
	    	      			}
	    	    		}
	    	    	});
	    	    	csc.rest.get('api/v5.0.0/serviceInstances?realResId='+uuid,function(data){
	    	    		var serviceInstance = data.results[0];
	    	    		if(typeof(serviceInstance) == 'undefined'){
	    	    			return;
	    	    		}
	    	    		self.applyChangeVdc().serviceInstanceUuid(serviceInstance.uuid);
	    	    	});
	    	    	self.isApplyChange(true);
	    	    }
	    	    self.applyChangeSubmit = function(){
	    	    	ko.validation.group(self.applyChangeVdc).showAllMessages();
 	    	        if(self.applyChangeVdc.isValid()){
					 var orderJson={};
					 var orderItems = [];
					 var metaData={};
					 var resBaseInfo = {};
					 var vdcQuotaList = [];
					 
					 if(self.applyChangeVdc().cpu() != ''){						 
						 vdcQuotaList.push({type:"CPU",value:self.applyChangeVdc().cpu()});
					 }
					 if(self.applyChangeVdc().memory() != ''){						 
						 vdcQuotaList.push({type:"MEMORY",value:self.applyChangeVdc().memory()});
					 }
					 if(self.applyChangeVdc().storage() != ''){						 
						 vdcQuotaList.push({type:"STORAGE",value:self.applyChangeVdc().storage()});
					 }
					 if(self.applyChangeVdc().vpc() !=''){						 
						 vdcQuotaList.push({type:"VPC",value:self.applyChangeVdc().vpc()});
					 }
					 if(self.applyChangeVdc().vm() !=''){						 
						 vdcQuotaList.push({type:"VM",value:self.applyChangeVdc().vm()});
					 }
					 if(self.applyChangeVdc().disk() != ''){
						 vdcQuotaList.push({type:"DISK",value:self.applyChangeVdc().disk()});
					 }
					 if(self.applyChangeVdc().publicIp() != ''){						 
						 vdcQuotaList.push({type:"PUBLICIP",value:self.applyChangeVdc().publicIp()});
					 }
					 if(self.applyChangeVdc().router() != ''){						 
						 vdcQuotaList.push({type:"ROUTER",value:self.applyChangeVdc().router()});
					 }
					 if(self.applyChangeVdc().firewall() != ''){						 
						 vdcQuotaList.push({type:"FIREWALL",value:self.applyChangeVdc().firewall()});
					 }
					 if(self.applyChangeVdc().secretKey() !=''){						 
						 vdcQuotaList.push({type:"SECRET_KEY",value:self.applyChangeVdc().secretKey()});
					 }
					 if(self.applyChangeVdc().objectStorage() != ''){						 
						 vdcQuotaList.push({type:"OBJECT_STORAGE",value:self.applyChangeVdc().objectStorage()});
					 }
					 if(self.applyChangeVdc().loadBalance() != ''){						 
						 vdcQuotaList.push({type:"LOAD_BALANCING",value:self.applyChangeVdc().loadBalance()});
					 }
					 if(self.applyChangeVdc().software() != ''){						 
						 vdcQuotaList.push({type:"SOFTWARE",value:self.applyChangeVdc().software()});
					 }
					 if(self.applyChangeVdc().securityGroup() != ''){						 
						 vdcQuotaList.push({type:"SECURITY_GROUP",value:self.applyChangeVdc().securityGroup()});
					 }
					 if(self.applyChangeVdc().vpn() != ''){						 
						 vdcQuotaList.push({type:"VPN",value:self.applyChangeVdc().vpn()});
					 }
					 resBaseInfo.vdcQuotaList=vdcQuotaList;
					 
					 var osType = [];
					 if(self.applyChangeVdc().windows()){
						 osType.push('windows');
					 }
					 if(self.applyChangeVdc().linux()){
						 osType.push('linux');
					 }
					 if(self.applyChangeVdc().aix()){
						 osType.push('aix');
					 }
					 metaData.osType=osType;
					 
					
					//获取VDC下网络
					var networkAry = [];
					csc.rest.get('api/v5.0.0/vdcs/'+self.selectVdcVO().uuid+'/networks', function(data){
						if (data && data.results) {
							var tempNetworkAry = data.results;
							for (var i = 0; i < tempNetworkAry.length; i++) {
								var networkItem = tempNetworkAry[i];
								networkAry.push({
									azUuid:networkItem.azUuid,
									netWorkUuid:networkItem.netWorkUuid,
									uuid:networkItem.uuid,
									vdcUuid:networkItem.vdcUuid,
								});
							}
							//获取vdc下az
							var azs = [];
							csc.rest.get('api/v5.0.0/vdcs/'+self.selectVdcVO().uuid+'/azs', function(data2){
								if (data2 && data2.results) {
									var tempAzAry = data2.results;
									for (var i = 0; i < tempAzAry.length; i++) {
										var azItem = tempAzAry[i];
										var tempNetworkAry = new Array();
										for (var j = 0; j < networkAry.length; j++) {
											var networkItem = networkAry[j];
											if (azItem.uuid === networkItem.azUuid) {
												tempNetworkAry.push({"uuid" : networkItem.netWorkUuid});
											}
										}
										
										azs.push({uuid:azItem.uuid, networks:tempNetworkAry});
									}
									
									resBaseInfo.azs=azs;
									metaData.resBaseInfo=resBaseInfo;
				    				
									 orderItems.push({
										 resourceType: "VDC",
										 instanceName: self.selectVdcVO().name,
										 metaData: JSON.stringify(metaData),
										 resourceUuid: self.selectVdcVO().uuid,
										 serviceInstanceUuid: self.applyChangeVdc().serviceInstanceUuid()
									 })
									 orderJson.resourceType = "VDC";
									 orderJson.type = "VDC_CHANGE";
									 orderJson.orderItems = orderItems;
									 
								 	 csc.rest.post('api/v5.0.0/orders/changeResource',orderJson,function(data){
									 	alert('成功提交订单！');
									 	self.isApplyChange(false);
									 });
								}
							});
						}
					});
					
					
 	    	        }
	    	    }
	    	    
	    	    function changeVdcQuotaValue(value){
	    	    	if(value == "-1"){
	    	    		return null;
	    	    	}
	    	    	return value;
	    	    }
	    	    
	    	    self.vdcRelUsersListTable = new DataTable([],{notShowLoading:true});//用户列表
	    	    /****添加用户*****/
	    	    
	    	    //左边的待选择用户
	    	    this.orgUsersTable = new DataTable([], {path: "api/v5.0.0/uap/vdcAvailableUsers",perPage:0});
	    	    
	    	    this.addUserModel = ko.observable(false);
	    	    this.addUser = function(){
	    	    	self.seletedOrgUserList.pagedRows([]);
	    	    	self.addUserModel(true);
	    	    	loadOrgTree();
	    	    	self.orgUsersTable.params({
	    	    		vdcUuid : self.selectVdcVO().uuid,
	    	    		userType : "0",
	    	    		size : "0"
	    	    	});
	    	    }	    	    
	    	    
	    	    //右边的已选择用户
	    	    this.seletedOrgUserList = new DataTable([]);
	    	    //添加到已选用户
	    	    this.addOrgUsers = function(){
	    	    	self.seletedOrgUserList.pagedRows(self.orgUsersTable.chosenItems())
	    	    }
	    	    //删除已选用户
	    	    this.selectedList = ko.observableArray();
	    	    this.removeOrgUsers = function(){
	    	    	self.selectedList(self.seletedOrgUserList.pagedRows());
	    	    	var chosenItemList = self.seletedOrgUserList.chosenItems();
	    	    	var newList = new Array();
	    	    	if(self.selectedList().length > 0 && chosenItemList.length > 0){
    	    			for(var j = 0; j < chosenItemList.length; j++){

    	    				self.selectedList.remove(chosenItemList[j]);
    	    			}
	    	    	}
	    	    	self.seletedOrgUserList.pagedRows(self.selectedList());
	    	    }
	    	    
	    	    this.userList = ko.observableArray();
	    	    //保存方法
	    	    this.saveUsers = function(){
	    	    	var roleList = $("[name='role']");
	    	    	var userTypeList = $("[name='selectUserType']");
	    	    	var orgUserList = self.seletedOrgUserList.pagedRows();
	    	    	var addUserLit = [];
	    	    	if(orgUserList.length > 0){
	    	    		for(var i = 0; i < orgUserList.length; i++){
	    	    			var userType = userTypeList[i].innerHTML;
	    	    			/* if(userType == 0){
	    	    				userType = "LOCAL";
	    	    			}else{
	    	    				userType = "AD";
	    	    			} */
	    	    			var user = {
	    	    				"account": orgUserList[i].id,
	    	    				"roles": roleList[i].value,
	    	    				"authType": userType
	    	    			}
	    	    			addUserLit.push(user);
	    	    		}
	    	    	}
	    	    	var dataBody = {
	    	    		"accounts" : addUserLit
	    	    	}
	    	    	var uuid = self.selectVdcVO().uuid;
	    	    	$.VDC.addUsers(uuid,dataBody,function(data){
	    	    		self.addUserModel(false);
	    	    		self.vdcRelUsersListTable.refreshData();
	    	    		alert("添加成功！");
	    	    	});
	    	    }
	    	    
	    	    //修改角色
	    	    this.editUserModel = ko.observable(false);
	    	    this.editUser = function(object, event){
	    	    	self.userRolesVO.fromJSON({
	    	    		uuid : object.uuid,
	    	    		account : object.account,
	    	    		roles : object.roles,
	    	    		vdcUuid : object.vdcUuid,
	    	    		authType : object.authType,
	    	    		createTime : object.createTime,
	    	    		id : object.id
	    	    	})
	    	    	
	    	    	self.editUserModel(true);
	    	    }
	    	    
	    	    this.userRolesVO = ko.validatedObservable({
	    	    	uuid : ko.observable(),
	    	    	account : ko.observable(),
	    	    	roles : ko.observable(),
	    	    	vdcUuid : ko.observable(),
	    	    	authType : ko.observable(),
	    	    	createTime : ko.observable(),
	    	    	id : ko.observable()
	    	    })
	    	    //修改角色保存
	    	    this.saveEditRoles = function(){
	    	    	var uuid = self.selectVdcVO().uuid;
	    	    	$.VDC.modifyVdcUserByOne(uuid,this.userRolesVO().uuid(),this.userRolesVO.toJSON(),function(data){
	    	    		self.editUserModel(false);
	    	    		self.vdcRelUsersListTable.refreshData();
	    	    		if (data) {
	    	    			alert("修改成功！");
	    	    		}
	    	    	})
	    	    }
	    	    
	    	    //删除用户
	    	    this.deletUser = function(obj, event){
	    	    	var uuid = self.selectVdcVO().uuid;
	    	    	$.VDC.deleteVdcUsers(uuid,obj.uuid,function(data){
	    	    		self.vdcRelUsersListTable.refreshData();
	    	    		if (data) {
	    	    			alert("删除成功！");
	    	    		}
	    	    	})
	    	    }
	      }
     	  var vdcListViewModal = new VdcListViewModal();
	      ko.applyBindings(vdcListViewModal, $('#page-content')[0]); 

    });

  </script>