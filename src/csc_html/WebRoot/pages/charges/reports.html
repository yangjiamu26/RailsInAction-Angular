<div class="bg-light lter b-b wrapper-sm">
  <ol class="breadcrumb">
    <li>当前位置：</li>
    <li>计费</li>
    <li class="active">计费清单统计</li>
  </ol>
</div>
<div class='wrapper-md'>

  <div class="panel panel-default b-blue">
    <div class="row wrapper">
      <div class="col-xs-3">
          <div class="input-group">
            <span class="input-group-addon">服务名称</span>
            <input class="input-sm form-control" placeholder="请输入服务名称" data-bind="value: searchParam().serviceName">
          </div>       
      </div>
      <div class="col-xs-3">
          <div class="input-group">
            <span class="input-group-addon">所属VDC</span>
            <input class="input-sm form-control" placeholder="请输入所属VDC" data-bind="value: searchParam().vdcName">
          </div>       
      </div>
      <div class="col-xs-3">
          <div class="input-group">
            <span class="input-group-addon">申请人</span>
            <input class="input-sm form-control" placeholder="请输入申请人" data-bind="value: searchParam().userName">
          </div>       
      </div>
      <div class="col-xs-2">
          <button class="btn btn-sm" type="button" data-bind="click: reset">重置</button>
          <button class="btn btn-default btn-sm" data-bind="click: search">搜索</button>     
      </div>
      <div class="col-xs-1">
        <!-- 
          <button class="btn btn-info btn-sm" data-bind="click: exporting">导出</button>    
        
          <a href="api/v5.0.0/billing/list/export" class="btn btn-sm btn-info">导出a</a>
           --> 
          <a class="btn btn-sm btn-info" data-bind="attr: {href: exportURL}">导出</a>
      </div>
    </div>    
    <div class="table-responsive" data-bind="with: table">
      <table class="table table-striped">
        <thead>
          <tr>              
            <th>ID</th>
            <th>服务名称</th>
            <th>所属VDC</th>
            <th>资源类型</th>
            <th>服务申请人</th>
            <th>服务开通时间</th>
            <th>服务统计时长</th>
            <th>计费结算日期</th>
            <th>计费周期</th>
            <th>本期计费金额(元)</th>
             <!--
            <th>计费单位</th>
            -->
            <th>计费总金额(元)</th>
          </tr>
        </thead>
        <tbody>
          <tr data-bind="visible: showNoData">
            <td colspan=11 class="aligncenter">
                                   暂无数据.
            </td>
          </tr>
          <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
          <tr>
            <td data-bind="text: $row.uuid"><a href="#"></a></td>
            <td><a data-bind="text: $row.serviceName"></a></td>
            <td><a data-bind="text: $row.vdcName,attr:{href:'#pages/vdcs/vdcs/index?id=' + $row.vdcUuid}"></a></td>
            <td>
            <span data-bind="visible: resourceType=='VM'">云主机</span>
			<span data-bind="visible: resourceType=='DISK'">云硬盘</span>
			<span data-bind="visible: resourceType=='ROUTER'">路由器</span>
			<span data-bind="visible: resourceType=='PUBLICIP'">公网IP</span>
			<span data-bind="visible: resourceType=='LOAD_BALANCING'">负载均衡</span>
			<span data-bind="visible: resourceType=='SECRET_KEY'">SSH密钥对</span>
			<span data-bind="visible: resourceType=='OBJECT_STORAGE'">对象存储</span>
			<span data-bind="visible: resourceType=='VDC'">VDC</span>
          
            </td>
            <td data-bind="text: $row.userName"></td>
            <td data-bind="text: $row.finishedTime"></td>
            <td data-bind="text: $row.remainTime"></td>
            <td data-bind="text: $row.timestamp"></td>
            <td>
             <span data-bind="visible:$row.cycle=='DAY'">天</span>
              <span data-bind="visible:$row.cycle=='MONTH'">月</span>
              <span data-bind="visible:$row.cycle=='QUARTER'">季</span>
              <span data-bind="visible:$row.cycle=='YEAR'">年</span>
            </td>
            
            <td data-bind="text: $row.fee"></td>
             <!--
             <td>
              <span data-bind="visible:$row.priceUnit=='RMB'">元</span>
              <span data-bind="visible:$row.priceUnit=='USD'">美元</span>
            </td>
            -->
            <td data-bind="text: $row.totalFee"></td>
          </tr>
          <!-- /ko -->
        </tbody>
      </table>
    </div>
    <footer class="panel-footer" data-bind="with: table, visible: table.pages() > 1">
      <ul class="pagination">
        <li data-bind="css: leftPagerClass, click: prevPage">
          <a href="#">&laquo;</a>
        </li>
        <!-- ko foreach: {data: (new Array(pages()))} -->
        <li data-bind="css: $parent.pageClass($index() + 1)">
          <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
        </li>
        <!-- /ko -->
        <li data-bind="css: rightPagerClass, click: nextPage">
          <a href="#">&raquo;</a>
        </li>
      </ul>
    </footer>    
  </div>
</div>

<!-- page specific plugin scripts -->
<script type="text/javascript">
  var scripts = [null, null]
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    function ViewModel(){
      this.searchParam = ko.observable({
        serviceName: "",
        vdcName: "",
        userName: ""
      })
      this.reset = function(){
        this.searchParam({
          serviceName: "",
          vdcName: "",
          userName: ""
        })
        this.table.params({});
      };
      this.search = function(){
         console.log(this.searchParam())
        this.table.params(this.searchParam());
      };
    /*   this.exporting = function(){
       
         csc.rest.get('api/v5.0.0/billing/list/export', {}, function(data){
            console.log("exportxxx")
          //  self.isAdd(false);
           // self.table.refreshData();
          })
      } */
      this.table = new DataTable([], {path: 'api/v5.0.0/billing/list'});
      this.exportURL = ko.observable("api/v5.0.0/billing/list/export");
    }

    ko.applyBindings(new ViewModel(), $('#page-content')[0]);  
  });
</script>