 <div class="panel panel-info">
    <div class="panel-heading">申请信息</div>
    <div id="orderDetailedList" class="wrapper" style="display:none">
      <h5 class="text-info">云主机数：<span data-bind="text:currentVO().vmApplyList().length"></span></h5>
      <div class="table-responsive no-height">
          <table class="table" id="vmApplyUnSubmitVmTable">
              <thead>
                  <tr>
                      <th>云主机名称</th>
                      <th>操作系统版本</th>
                      <th>CPU(个)</th>
                      <th>内存(GB)</th>
                      <th>存储(GB)</th>
                      <th>所属VDC</th>
                      <th>VPC/IP池</th>
                      <th>挂载云硬盘个数</th>
                      <!-- <th>云软件数</th> -->
                      <th>网络名称</th>
                      <th>可用分区</th>
                      <th>申请时长</th>
                      <th>操作</th>
                  </tr>
              </thead>
              <tbody   data-bind="foreach:currentVO().vmApplyList">
                  <tr>
                        <td><span data-bind="text: instanceName"></span></td>
                        <td><span data-bind="text: osVersionName"></span></td>
                        <td><span data-bind="text: vcpu"></span></td>
                        <td><span data-bind="text: memory"></span></td>
                        <td><span data-bind="text: storage"></span></td>
                        <td><span data-bind="text: vdcName"></span></td>
                        <td><span data-bind="text: vpcName"></span></td>
                        <td><span data-bind="text:mountDiskList().length"></span></td>
                        <!--  <td><span data-bind="text:softNum"></span></td> -->
                        <td><span data-bind="text: networkName"></span></td>
                        <td><span data-bind="text: azName"></span></td>
                        <td><span data-bind="text:expireText"></span></td>
                        <td>
                            <a class="expand-btn-detail">查看 <i class="fa fa-angle-double-right"></i></a> | <a class="expand-btn-edit">修改 <i class="fa fa-angle-double-right"></i></a> | <a  data-bind="click:$root.removeVm">删除</a>
                       </td>
                   </tr>
                  <tr style="display: none">
                    <td colspan="13" class="no-padder">
                      <div class="b wrapper-sm sub-detail" style="display: none">
                                    <h5>
										<i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息
									</h5>
									<div class="bg-light b-t b-b wrapper-sm">
										<div class="row m-b">
											<div class="col-xs-1 font-bold">云主机名称：</div>
											<div class="col-xs-3">
												<span data-bind="text:instanceName"></span>
											</div>
											<div class="col-xs-1 font-bold">所属VDC：</div>
											<div class="col-xs-3">
												<span data-bind="text:vdcName"></span>
											</div>
											<div class="col-xs-1 font-bold">可用分区：</div>
											<div class="col-xs-3">
												<span data-bind="text:azName"></span>
											</div>
										</div>
										<div class="row m-b">
											<div class="col-xs-1 font-bold">操作系统类型：</div>
											<div class="col-xs-3">
												<span data-bind="text:osType"></span>
											</div>
											<div class="col-xs-1 font-bold">操作系统版本：</div>
											<div class="col-xs-3">
												<span data-bind="text:osVersionName"></span>
											</div>
											<div class="col-xs-1 font-bold">CPU(个)：</div>
											<div class="col-xs-3">
												<span data-bind="text:vcpu"></span>
											</div>
										</div>
										<div class="row m-b">
											<div class="col-xs-1 font-bold">内存(GB)：</div>
											<div class="col-xs-3">
												 <span data-bind="text:memory"></span>
											</div>
											<div class="col-xs-1 font-bold">存储(GB)：</div>
											<div class="col-xs-3">
												<span data-bind="text:storage"></span>
											</div>
											<div class="col-xs-1 font-bold">VPC/IP池：</div>
											<div class="col-xs-3">
												<span data-bind="text:vpcName"></span>
											</div>
										</div>
										<div class="row m-b">
											<div class="col-xs-1 font-bold">网络名称：</div>
											<div class="col-xs-3">
												<span data-bind="text:networkName"></span>
											</div>
											<div class="col-xs-1 font-bold">指定IP：</div>
											<div class="col-xs-3">
												<span  data-bind="text:ip"></span>
											</div>
											<div class="col-xs-1 font-bold">主机账号：</div>
											<div class="col-xs-3">
												<span data-bind="text:account"></span>
											</div>
										</div>
										<div class="row m-b">
											<div class="col-xs-1 font-bold">选择密钥：</div>
											<div class="col-xs-3">
												<span data-bind="text:sshKeyName"></span>
											</div>
											<div class="col-xs-1 font-bold">申请时长：</div>
											<div class="col-xs-3">
												<span data-bind="text:expireText"></span>
											</div>
										</div>
										<div class="row m-b">
											<div class="col-xs-1 font-bold">套餐：</div>
											<div class="col-xs-3">
												<span data-bind="text:billCycleText"></span>
											</div>
											<div class="col-xs-1 font-bold">费用：</div>
											<div class="col-xs-3">
												<span  data-bind="text:fee"></span>
											</div>
										</div>
									</div>
								     
								    <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>挂载云硬盘</h5>
				                        <div class="table-responsive no-height">
				                            <table class="table table-striped table-hover">
				                              <thead>
				                                <tr>
				                                  <th>序号</th>
				                                  <th>云硬盘名称</th>
				                                  <th>存储大小(GB)</th>
				                                  <th>所属服务</th>
				                                  <th>申请时长</th>
				                                  <th>套餐</th>
				                                  <th>收费标准</th>
				                                </tr>
				                              </thead>
				                              <tbody data-bind="foreach:mountDiskList">
				                                <tr>
				                                  <td><span data-bind="text: ($index()+1)"></span></td>
				                                  <td><span data-bind="text:instanceName"></span></td>
				                                  <td><span data-bind="text:volumeSize"></span></td>
				                                  <td><span data-bind="text:serviceName"></span></td>
				                                  <td><span data-bind="text:expireText"></span></td>
				                                  <td><span data-bind="text:billCycleText"></span></td>
				                                  <td><span data-bind="text:fee"></span></td>
				                                </tr>
				                              </tbody>
				                            </table>
				                        </div>    
								
									<h5><i class="fa fa-minus fa-rotate-90 text-info"></i>安装软件</h5>
				                        <div class="table-responsive no-height">
				                          <table class="table table-striped table-hover">
				                            <thead>
				                              <tr>
				                                <th>软件名称</th>
				                                <th>软件分类</th>
				                                <th>软件类型</th>
				                                <th>软件版本</th>
				                                <th>静默安装属性</th>
				                              </tr>
				                            </thead>
				                            <tbody>
				                              <tr>
				                                <td>oracle</td>
				                                <td>数据库</td>
				                                <td>oracle</td>
				                                <td>10g企业版</td>
				                                <td>
				                                  <a class="expand-btn-detail">查看 <i class="fa fa-angle-double-right"></i></a>
				                                </td>
				                              </tr>
				                              <tr style="display: none">
				                                  <td colspan="7" class="no-padder">
				                                    <div class="wrapper-sm sub-detail" style="display: none">
				                                      <h5 class="text-info">静默安装属性</h5>
				                                      <div class="bg-light b-t b-b wrapper-sm">
				                                        <div class="row m-b">
				                                          <div class="col-xs-1">参数名称：</div>
				                                          <div class="col-xs-3">15137</div>
				                                          <div class="col-xs-1">参数代码：</div>
				                                          <div class="col-xs-3">abc</div>
				                                          <div class="col-xs-1">默认值：</div>
				                                          <div class="col-xs-3">000</div>
				                                        </div>
				                                      </div>                                      
				                                    </div>                    
				                                  </td>
				                              </tr>                
				                            </tbody>
				                          </table>            
				                        </div>          
				
				                     <!--    <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>系统盘分区</h5>
				                        <table class="table table-striped table-hover">
				                          <thead>
				                            <tr>
				                              <th>分区名称</th>
				                              <th>分区大小</th>
				                            </tr>
				                          </thead>
				                          <tbody>
				                            <tr>
				                              <td>NFS</td>
				                              <td>100G</td>
				                            </tr>
				                          </tbody>
				                        </table>  -->
				
				                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>高级选项</h5>
				                        <div class="bg-light b-t b-b wrapper-sm">
				                          <div class="row m-b">
				                            <div class="col-xs-1">所属业务系统：</div>
				                            <div class="col-xs-3"><span data-bind="text:busSysName"></span></div>
				                            <div class="col-xs-1">备注：</div>
				                            <div class="col-xs-7"></div>
				                          </div>
				                        </div> 
                      </div>
                      <div class="b wrapper-sm sub-edit host-edit-flag" style="display: none">
                              <h5 class="text-info">基本信息</h5>
					          <div class='form-horizontal'>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">云主机名称</label>
					              <div class="col-xs-2">
					                <input type="text" class="form-control" data-bind="value: instanceName"/>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">所属VDC</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options:vdcList,optionsText:'name',optionsValue:'uuid',value: vdcUuid,event:{change:$root.vdcChange},valueAllowUnset:true,optionsCaption:'请选择'"></select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">可用分区</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options: azList, optionsText: 'name', optionsValue: 'uuid',value: azUuid,event:{change:$root.azChangeGetVpc},valueAllowUnset:true,optionsCaption:'请选择'"></select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">操作系统类型</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm"   data-bind="options: osTypeList, optionsText: $data, optionsValue: $data,value: osType,event:{change:$root.osTypeChangeGetOsVersion},valueAllowUnset:true,optionsCaption:'请选择'">
					                </select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">操作系统版本</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options: osVersionList, optionsText: 'imageName', optionsValue: 'uuid',value: osVersion,valueAllowUnset:true,optionsCaption:'请选择'">
					                </select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">CPU(个)</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options: cpuList, optionsText: $data, optionsValue: $data,value: vcpu,valueAllowUnset:true,optionsCaption:'请选择'">
					                </select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">内存(GB)</label>
					              <div class="col-xs-2">
					                 <select class="form-control input-sm" data-bind="options: memoryList, optionsText: $data, optionsValue: $data,value: memory,valueAllowUnset:true,optionsCaption:'请选择'">
					                </select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">存储(GB)</label>
					              <div class="col-xs-2">
					                <input type="text" class="form-control" data-bind="value: storage"/>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">VPC/IP池</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options: vpcList, optionsText: 'name', optionsValue: 'uuid',value: vpcUuid,event:{change:$root.vpcChange},valueAllowUnset:true,optionsCaption:'请选择'"></select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">网络名称</label>
					              <div class="col-xs-2">
					                <select class="form-control input-sm" data-bind="options: privateNetworkList, optionsText: 'name', optionsValue: 'uuid',value: networkUuid,event:{change:$root.networkChangeGetIpList},valueAllowUnset:true,optionsCaption:'请选择'"></select>
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">指定IP</label>
					              <div class="col-xs-2">
					                  <select class="form-control input-sm" data-bind="options: availableIpList, optionsText: $data, optionsValue: $data,value: ip,valueAllowUnset:true,optionsCaption:'请选择'"></select>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">主机账号</label>
					              <div class="col-xs-2">
					                <input type="text" class="form-control" data-bind="value: account">
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">密码</label>
					              <div class="col-xs-2">
					                <input type="password" class="form-control" data-bind="value: password">
					              </div>
					              <label class="col-xs-1 control-label no-padder-h">重复密码</label>
					              <div class="col-xs-2">
					                <input type="password" class="form-control" data-bind="value: repeatPassword">
					              </div>
					            </div>
					            <div class="form-group">
					              <div id="resource_instance_vm_add_ssh">
					                <label class="col-xs-1 control-label no-padder-h">选择密钥</label>
					                <div class="col-xs-2">
					                  <select class="form-control input-sm" data-bind="options: sshList, optionsText: 'name', optionsValue: 'uuid',value: sshKeyUuid,valueAllowUnset:true,optionsCaption:'请选择'"></select>
					                </div>
					                <div class="col-xs-1">
					                  <span class="text-danger inline m-l-n m-t-sm"></span>
					                </div>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">申请时长</label>
					              <div class="col-xs-10">
					                <label class="radio-inline" style="padding-top: 2px">
					                  <input type="radio"  value="1"  data-bind="checked:expireType,attr:{'name':uuid}" > 永久
					                </label>
					                <label class="radio-inline">
					                  <input type="radio"   value="2"  data-bind="checked:expireType,attr:{'name':uuid}"   style="margin-top:10px"> 
					                  <input type="text" class="form-control inline w-xxs" data-bind="value:expireType()==2?expireValue:''" >
					                  <select class="form-control inline w-xs">
					                    <option value="">月</option>
					                  </select>  
					                </label>
					                <label class="radio-inline">
					                  <input type="radio" value="3"  data-bind="checked:expireType,attr:{'name':uuid}"  style="margin-top:10px"> 有效期至<input type="text" value="" class="form-control inline applyDateFormat"  data-bind="value:expireType()==3?expireValue:''">
					                </label>                                    
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					            </div>
					            <div class="form-group">
					              <label class="col-xs-1 control-label no-padder-h">套餐</label>
					              <div class="col-xs-10">
					                <select class="form-control inline w-xs" data-bind="options:billRuleList,optionsText:'name',optionsValue:'value',event:{change:$root.chargeChangeCart},value:billCycle,valueAllowUnset:true,optionsCaption:'请选择'" >
					                </select>    
					               <span class="control-label col-sm-5 text-left" style="height:34px;" data-bind="text:fee"></span>                      
					              </div>
					              <div class="col-xs-1">
					                <span class="text-danger inline m-l-n m-t-sm">*</span>
					              </div>
					            </div>
					          </div>
					
					          <div class="clear">
					            <h5 class="text-info pull-left">挂载云硬盘</h5>
					            <a href="#" class="pull-right text-info m-t-sm" data-bind="click: $root.addMountDisks">添加硬盘</a>
					          </div>
					          <div class="table-responsive no-height">
					              <table class="table table-striped table-hover">
					                <thead>
					                  <tr>
					                    <th>序号</th>
					                    <th>云硬盘名称<span class="text-danger">*</span></th>
					                    <th>存储大小(GB)<span class="text-danger">*</span></th>
					                    <th>所属服务<span class="text-danger">*</span></th>
					                    <th>申请时长</th>
					                    <th>套餐</th>
					                    <th>收费标准</th>
					                    <th>操作</th>
					                  </tr>
					                </thead>
					                   <tbody data-bind="foreach:mountDiskList">
				                                <tr>
				                                  <td><span data-bind="text: ($index()+1)"></span></td>
				                                  <td><input type="text" class="form-control" data-bind="value:instanceName"/></td>
				                                  <td><input type="text" class="form-control" data-bind="value:volumeSize"/></td>
				                                  <td><span data-bind="text:serviceName"></span><a class="btn btn-xs btn-default" data-bind="click:$root.selectVdiskService_VM">选择</a></td>
				                                  <td><span data-bind="text:expireText"></span></td>
				                                  <td><select class="form-control w-xs" data-bind="options: billRuleList,optionsText:'name',optionsValue:'value',value:billCycle,event:{change:$root.chargeChangeCart},valueAllowUnset:true,optionsCaption:'请选择'"></select></td>
				                                  <td><span data-bind="text:fee"></span></td>
				                                  <td><a class="btn btn-xs btn-danger" data-bind="click:$root.delMountDisks">删除</a></td>
				                                </tr>
				                       </tbody>
					              </table>
					          </div>    
					          <div class="clear">
		                        <h5 class="pull-left"><i class="fa fa-minus fa-rotate-90 text-info"></i>安装软件</h5>
		                          <a href="#" class="pull-right text-info m-t-sm">添加软件</a>
		                        </div>
		                        <div class="table-responsive no-height">
		                          <table class="table table-striped table-hover">
		                            <thead>
		                              <tr>
		                                <th>软件名称</th>
		                                <th>软件分类</th>
		                                <th>软件类型</th>
		                                <th>软件版本</th>
		                                <th>静默安装属性</th>
		                                <th>操作</th>
		                              </tr>
		                            </thead>
		                            <tbody>
		                              <tr>
		                                <td>oracle</td>
		                                <td>数据库</td>
		                                <td>oracle</td>
		                                <td>10g企业版</td>
		                                <td>
		                                  <a class="expand-btn">查看 <i class="fa fa-angle-double-right"></i></a> |
		                                  <a class="expand-btn">修改 <i class="fa fa-angle-double-right"></i></a>
		                                </td>
		                                <td><a href="#">删除</a></td>
		                              </tr>
		                              <tr style="display: none">
		                                  <td colspan="7" class="no-padder">
		                                    <div class="b wrapper-sm">
		                                      <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>静默安装属性</h5>
		                                      <div class="form-horizontal">
		                                        <div class="form-group">
		                                          <label class="col-xs-1 control-label">参数名称</label>
		                                          <div class="col-xs-3">
		                                            <input class="form-control" type="text" value="test1">
		                                          </div>
		                                          <label class="col-xs-1 control-label">参数代码</label>
		                                          <div class="col-xs-3">
		                                            <input class="form-control" type="text" value="test1">
		                                          </div>
		                                          <label class="col-xs-1 control-label">默认值</label>
		                                          <div class="col-xs-3">
		                                            <input class="form-control" type="text" value="test1">
		                                          </div>
		                                        </div>                        
		                                      </div>
		                                      <div class="wrapper-sm text-center"><button class="btn btn-sm btn-info">保存</button></div>
		                                    </div>                    
		                                  </td>
		                              </tr>                
		                            </tbody>
		                          </table>            
		                        </div>
		<!-- 
		                        <div class="clear">
		                          <h5 class="pull-left"><i class="fa fa-minus fa-rotate-90 text-info"></i>系统盘分区</h5>
		                          <a href="#" class="pull-right text-info m-t-sm">添加分区</a>
		                        </div>
		                        <div class="table-responsive no-height">
		                          <table class="table table-striped table-hover">
		                            <thead>
		                              <tr>
		                                <th>分区名称</th>
		                                <th>分区大小</th>
		                                <th>操作</th>
		                              </tr>
		                            </thead>
		                            <tbody>
		                              <tr>
		                                <td>NFS</td>
		                                <td>100G</td>
		                                <td><a href="#">修改</a> | <a href="#">删除</a></td>
		                              </tr>
		                            </tbody>
		                          </table>            
		                        </div> -->
		
		                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>高级选项</h5>
		                        <div class="form-horizontal">
		                          <div class="form-group">
		                            <label class="col-xs-2 control-label">所属业务系统</label>
		                            <div class="col-xs-5">
		                              <select class="form-control" data-bind="options: bussyList,optionsText:'name',optionsValue:'uuid',value:busSysUuid,valueAllowUnset:true,optionsCaption:'请选择'">
		                              </select>
		                            </div>
		                          </div>
		                          <div class="form-group">
		                            <label class="col-xs-2 control-label">备注</label>
		                            <div class="col-xs-5">
		                              <textarea cols="5" rows="5" class="form-control"></textarea>
		                            </div>
		                          </div>            
		                        </div>                                                                                                                     
		                 </div>                
                    </td>
                  </tr>
              </tbody>
          </table>
      </div>
   </div>
 </div>
 
<!-- 选择云服务页面 -->
 <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: selectVdiskService }">
   <div class='modal-dialog modal-lg' role='document'>
     <div class='modal-content'>
       <div class='modal-header'>
         <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>选择云硬盘服务</h3>
       </div>
       <div class='modal-body form-horizontal'>
         <div class="panel panel-default table-responsive no-height" style="margin:0;margin-top:10px" data-bind="with: $root.table_Vdisk_VM">
          <table class="table table-striped">
            <thead>
              <th></th>
              <th>云硬盘服务名称<i style="color:red">*</i></th>
              <th>类型<i style="color:red">*</i></th>
              <th>是否收费<i style="color:red">*</i></th>
            </thead>
            <tbody>
            <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
              <tr>
                <td><input type="radio" style="top:-2px;" name="optionsRadios0"  data-bind="checkedValue: $data, checked: $parent.chosenItems"></td>
                <td data-bind="text:serviceName"></td>
                <td data-bind="text:diskType">类型</td>
                <td data-bind="text:isFee">是/否</td>
              </tr>
              <!-- /ko -->
            </tbody>
          </table>
          <footer class="panel-footer" data-bind="with: $root.table_Vdisk_VM">
     <ul class="pagination">
         <li data-bind="css: leftPagerClass, click: prevPage">
           <a href="#">&laquo;</a>
         </li>
         <!-- ko foreach: {data: (new Array(pages()))} -->
         <li data-bind="css: $parent.pageClass($index() + 1)">
           <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
         </li>
         <!-- /ko -->
         <li data-bind="css: rightPagerClass, click: nextPage">
           <a href="#">&raquo;</a>
         </li>
     </ul>
     </footer>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
         <a class="btn btn-default btn-info" data-bind="click: submitVdiskService">确定添加</a>
         <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
       </div>
     </div>
   </div>
 </div>
 <!-- 选择云服务页面 -->
  
<script type="text/javascript">
  var scripts = [null, "assets/lib/moment/moment.js","assets/lib/bootstrap-daterangepicker/daterangepicker.js"];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    
	  
	  csc.rest.get('api/v5.0.0/workflows/tasks/'+args.taskId,function(data){
	   	     var processInstanceId = data.taskInfo[0].processInstanceId;
	   	     //获取订单数据
	      	 csc.rest.get('api/v5.0.0/orders/byFlowInstanceUuid/'+processInstanceId,function(orderData){
	      		         console.log("orderDataorderDataorderData",orderData)
	      		         
	      		          var vmOrderItems = [];
			      		  var diskOrderItems= [];
			      		  for(var i=0;i<orderData.orderItems.length;i++){
			      			  var orderItem = orderData.orderItems[i];
			      			  if(orderItem.resourceType == "VM"){
			      				  vmOrderItems.push(orderItem);
			      			  }else if(orderItem.resourceType == "DISK"){
			      				  diskOrderItems.push(orderItem);
			      			  }
			      		  }
			      		  
			      		 if(vmOrderItems && vmOrderItems.length == 1){//单个云主机时的界面
			      			$("#orderDetailedList").html($("#orderDetailedList").find(".host-edit-flag")[0]);
			      			$("#orderDetailedList").find(".host-edit-flag").css("display","block");
			      			$("#orderDetailedList").attr("data-bind","foreach:currentVO().vmApplyList");
			      			$("#orderDetailedList").css("display","block");
			      		 }else{
			      			$("#orderDetailedList").css("display","block");
			      		 }
	      		         
	      		         function ViewModel(){
				      		 var self = this;
				      	      this.currentVO = ko.validatedObservable({
				      	    	     vmApplyList : ko.observableArray([]),
				      	             diskApplyList : ko.observableArray([]),
				      	             orderData: ko.observable(orderData)
				      	      });
				      	    
				      	      function getServiceRelationInfo(callback,serviceUuid,vmInParamData,callbackCustParam){//获取服务关联的信息
				      	    	  var uri="serviceUuid="+serviceUuid+"&vdcUuid="+vmInParamData.vdcUuid+"&azUuid="+vmInParamData.azUuid+"&vpcUuid="+vmInParamData.vpcUuid+"&osType="+vmInParamData.osType;
				                    csc.rest.get("api/v5.0.0/cart/getCartSelectList?"+uri, function(result,textStatus,callbackCustParam){
				                     csc.rest.get("api/v5.0.0/bussys?vdcuuid="+vmInParamData.vdcUuid,function(result2,textStatus,callbackCustParam){
				                         csc.rest.get("api/v5.0.0/sshKeys?getList=true&azUuid="+vmInParamData.azUuid+"&vcdUuid="+vmInParamData.vdcUuid,function(result3,textStatus,callbackCustParam){
				                        	 callback(result,result2,result3,callbackCustParam);
				                         },function(){},callbackCustParam);
				                     },function(){},callbackCustParam);
				                   },function(){},callbackCustParam);
				      	      }
				      	      
				      	      
				      	     orderData.orderItems.sort(function(a,b){return a.instanceName > b.instanceName});//排序
 				      		  for(var i=0;i<orderData.orderItems.length;i++){
				      			  var orderItem = orderData.orderItems[i];
				      			  if(orderItem.resourceType == "VM"){
				      				var serviceUuid=orderItem.serviceUuid;
				 	      		    var metaData = JSON.parse(orderItem.metaData);
				 	      		    var vmInParamData = JSON.parse(metaData.resBaseInfo);
				 	                var networks = vmInParamData.networkList;
				 	                var selelctNetworkUuid = networks[0]?networks[0].networkId:"";
				 	           	    var vmInfo = new VmInfo();
				 	                var callbackCustParam = vmInfo;
				 	                getServiceRelationInfo(function(result,result2,result3,callbackCustParam){
				 	                	  var vmInfo = callbackCustParam;
				                          vmInfo.sshList(result3);
				 	                	  vmInfo.bussyList(result2.results); 
				                          vmInfo.vdcList(result.vdcList);
				                          vmInfo.vpcList(result.vpcList);
				                          vmInfo.privateNetworkList(result.networkList);
				                          vmInfo.azList(result.azList);
				                          vmInfo.osTypeList(result.osTypeList);
				                          vmInfo.cpuList(result.cpuList);
				                          vmInfo.memoryList(result.memoryList);
				                          vmInfo.osVersionList(result.osVersionList);
				                          vmInfo.billRuleList(setArrayCharge(result.chargeList));
				 	                },serviceUuid,vmInParamData,callbackCustParam);
				 	                
				 	                csc.rest.get("api/v5.0.0/vpcNetworks/"+selelctNetworkUuid+"/availableIp", function(result,textStatus,vmInfo){
	 	                        	     var ipList = [];
	 	                        	     if(result){
	 	                        	    	 for(var i=0;i<result.length;i++){
	 	                        	    		var objIp = result[i];
	 	                        	    		ipList.push(objIp.ip);
	 	                        	    	 }
	 	                        	     }
	 	                        	     vmInfo.availableIpList(ipList);
 	                                },function(){},vmInfo); 
				 	                
				 	                
				 	                vmInfo.uuid(orderItem.uuid);
				      				vmInfo.serviceUuid(orderItem.serviceUuid);
				      				vmInfo.instanceName(orderItem.instanceName);
				      				vmInfo.vdcUuid(vmInParamData.vdcUuid);
				      				vmInfo.azUuid(vmInParamData.azUuid);
				      				vmInfo.vpcUuid(vmInParamData.vpcUuid);
				      				vmInfo.osType(vmInParamData.osType);
				      				vmInfo.osVersion(vmInParamData.osVersion);
				      				vmInfo.vcpu(vmInParamData.vcpu);
				      				vmInfo.memory(vmInParamData.memory);
				      				vmInfo.storage(vmInParamData.storage);
				      				vmInfo.networkUuid(selelctNetworkUuid);
				      				vmInfo.ip(vmInParamData.ip);
				      				vmInfo.account(vmInParamData.account);
				      				vmInfo.password(vmInParamData.password);
				      				vmInfo.repeatPassword(vmInParamData.repeatPassword);
				      				vmInfo.sshKeyUuid(vmInParamData.sshUuid);
				      				vmInfo.billCycle(orderItem.billCycle);
				      				vmInfo.isBill(vmInfo.isBill);
				      				vmInfo.fee(orderItem.fee);
				      				vmInfo.expireType(orderItem.expireType);
				      				vmInfo.expireValue(orderItem.expireValue);
				      				vmInfo.busSysUuid(vmInParamData.busSysUuid);
				      				vmInfo.relateUuid(orderItem.relateUuid);
				      				self.currentVO().vmApplyList.push(vmInfo);
				      			  }else if(orderItem.resourceType == "DISK"){
				      				  var serviceUuid=orderItem.serviceUuid;
				 	      		      var metaData = JSON.parse(orderItem.metaData);
				 	      		      var diskInParamData = JSON.parse(metaData.resBaseInfo);
				      				  var diskInfo = new DiskInfo();
				      				  diskInfo.uuid(orderItem.uuid);
				      				  diskInfo.serviceUuid(orderItem.serviceUuid);
				      				  diskInfo.instanceName(orderItem.instanceName);
				      				  diskInfo.vdcUuid(orderItem.vdcUuid);
				      				  diskInfo.azUuid(orderItem.azUuid);
				      				  diskInfo.vpcUuid(orderItem.vpcUuid);
				      				  diskInfo.volumeSize(diskInParamData.volumeSize);
				      				  diskInfo.billCycle(orderItem.billCycle);
				      				  diskInfo.isBill(orderItem.isBill);
				      				  diskInfo.fee(orderItem.fee);
				      				  var callbackCustParam = diskInfo;
				      			 	  csc.rest.get("api/v5.0.0/service/getServiceInfo/"+serviceUuid, function(serviceVO,textStatus,callbackCustParam){
			                    	  csc.rest.get("api/v5.0.0/cart/getCartSelectList?serviceUuid="+serviceUuid, function(res,textStatus,callbackCustParam){
			                    		      var diskInfo = callbackCustParam;
			                    		     diskInfo.serviceName(serviceVO.name);
			                    		     diskInfo.billRuleList(setArrayCharge(res.chargeList));
			                    	     },function(){},callbackCustParam);
				      			 	  },function(){},callbackCustParam);
				      			 	  
				      				  //diskInfo.expireType(diskInParamData.expireType); 从云主机获取
				      				  //diskInfo.expireValue(diskInParamData.expireValue);
				      				  diskInfo.relateUuid(orderItem.relateUuid);
				      				  self.currentVO().diskApplyList.push(diskInfo);
				      			  }
				      		  }
				      		  
				      		 
				      		  var vmList = self.currentVO().vmApplyList();
				      		  var diskList = self.currentVO().diskApplyList();
				      	 
				      		  for(var j=0;j<vmList.length;j++){
				      			  var vmVO = vmList[j];
				          		  for(var i=0;i<diskList.length;i++){
				          			  var diskVo = diskList[i];
				          			  if(vmVO.relateUuid()  && vmVO.relateUuid() == diskVo.relateUuid()){
			          				      diskVo.vdcName(vmVO.vdcName());//把虚拟机的值给磁盘 然后监听虚拟机的值
				          				  vmVO.vdcName.subscribe(function(val){
				          					   this.vdcName(val);
						    			   },diskVo);
				          				  diskVo.azName(vmVO.azName())
				          				  vmVO.azName.subscribe(function(val){
				          					    this.azName(val);
						    			   },diskVo);
				          				  
				          				  diskVo.expireType(vmVO.expireType())
				          				  vmVO.expireType.subscribe(function(val){
				          					    this.expireType(val);
						    			   },diskVo);
				          				   
				          				  diskVo.expireValue(vmVO.expireValue())
				          				  vmVO.expireValue.subscribe(function(val){
				          					    this.expireValue(val);
						    			   },diskVo);
				          				  
				          				  diskVo.vmName(vmVO.instanceName());
				          				  vmVO.mountDiskList.push(diskVo);
				          			  }
				          		  }
				      		  }
				      		
				      		  
				      	  //选择云硬盘服务
		      	          this.selectVdiskService = ko.observable(false);
		      	          this.table_Vdisk_VM = null;
		      	          var  diskEditObject;//用于临时存储磁盘对象
		      	          this.selectVdiskService_VM = function(object){
		      	        	  diskEditObject  = null;
		      	              self.table_Vdisk_VM = new DataTable([], {path: 'api/v5.0.0/service/getServiceList/DISK',perPage:6});
		      	              self.selectVdiskService(true);
		      	              diskEditObject = object;
		      	          } 
		      	          
		      	          this.submitVdiskService = function(){
		      	        	  diskEditObject.uuid(csc.util.getUuid());
		      	        	  diskEditObject.serviceName(self.table_Vdisk_VM.chosenItems().serviceName);
		      	        	  diskEditObject.serviceUuid(self.table_Vdisk_VM.chosenItems().serviceUuid);
		      	        	  diskEditObject.isBill(self.table_Vdisk_VM.chosenItems().isFee == "是" ?true:false);//其他地方时用的中文 
		      	              var attr;
		      	              if(self.table_Vdisk_VM.chosenItems().feeType !=null && self.table_Vdisk_VM.chosenItems().feeType!=""){
		      	              	attr=self.table_Vdisk_VM.chosenItems().feeType.split(",")
		      	              }
		      	              diskEditObject.billRuleList(setArrayCharge(attr)); 
		      	              self.selectVdiskService(false);
		      	          }  
				      		  
				      		  
				      		this.addMountDisks = function(data){
				      			  var diskInfo =  new DiskInfo();
				      			  diskInfo.relateUuid(data.relateUuid());
				      			  diskInfo.expireType(data.expireType());
				      			  diskInfo.expireValue(data.expireValue());
				      			  data.mountDiskList.push(diskInfo);
			      	              self.currentVO().diskApplyList.push(diskInfo);
			      	        }
				      		
				      		this.delMountDisks = function (data){
				      			  var vmList = self.currentVO().vmApplyList();
					      		  for(var j=0;j<vmList.length;j++){
					      			  var vmVO = vmList[j];
					      			  if(vmVO.relateUuid() == data.relateUuid()){
					      				 vmVO.mountDiskList.remove(data);
					      			  }
					      		  }
			      	             self.currentVO().diskApplyList.remove(data);
			      	        }
				      		
				      		 this.removeVm = function(data){
				      			  if(self.currentVO().vmApplyList().length == 1){
				      				  systemMsg.alert('删除失败，订单中至少存在一个订单项！');	
				      				  return;
				      			  }
				      			 
				      			confirm("确定移除云主机["+data.instanceName()+"]？",function(arg){
				      				  var diskList = self.currentVO().diskApplyList();
						      		  for(var j=0;j<diskList.length;j++){
						      			  var diskVO = diskList[j];
						      			  if(diskVO.relateUuid() == data.relateUuid()){
						      					self.currentVO().diskApplyList.remove(diskVO);
						      			  }
						      		  }
					      			  self.currentVO().vmApplyList.remove(data);
				    			 });
				      		 }
				      		
				      	     this.vdcChange = function(data, event) { //根据变化的vdc及服务ID查找其下的可用分区
				      	    	  data.azList([]);data.azUuid("");
				      	    	  data.vpcList([]);data.vpcUuid("");
				      	    	  data.privateNetworkList([]);data.networkUuid("");
				      	    	  data.availableIpList([]);data.ip("");
			                      csc.rest.get("api/v5.0.0/cart/getAzList/"+data.serviceUuid()+"/" + data.vdcUuid(), function(result) { //需修改为服务UUID作为参数传递
			                    	  data.azList(result);
			                      });  
			                 };
			                 
			                 this.azChangeGetVpc = function(data, event) {
			                	  data.vpcList([]);data.vpcUuid("");
				      	    	  data.privateNetworkList([]);data.networkUuid("");
				      	    	  data.availableIpList([]);data.ip("");
			                      csc.rest.get("api/v5.0.0/cart/getVpcList/" + data.vdcUuid() + "/" + data.azUuid(), function(result) {
			                    	  data.vpcList(result);
			                      });
			                 }

			                  this.vpcChange = function(data, event) {
			                	  data.privateNetworkList([]);data.networkUuid("");
				      	    	  data.availableIpList([]);data.ip("");
			                      csc.rest.get("api/v5.0.0/cart/getNetworkList/"+data.serviceUuid()+"/" + data.vpcUuid(), function(result) { //需修改为服务UUID作为参数传递
			                    	  data.privateNetworkList(result);
			                      });
			                  }
			                  
			                  this.osTypeChangeGetOsVersion = function(data, event) {
			                	  data.osVersionList([]);
			                      csc.rest.get("api/v5.0.0/cart/getOsVersionList/" + data.azUuid() + "/" + data.osType(), function(result) {
			                    	  data.osVersionList(result);
			                      });
			                  }
			                  
			                  this.networkChangeGetIpList = function(data, event) {
				      	    	   data.availableIpList([]);data.ip("");
			                	   csc.rest.get("api/v5.0.0/vpcNetworks/"+data.networkUuid()+"/availableIp", function(result,textStatus){
				                 	     var ipList = [];
				                 	     if(result){
				                 	    	 for(var i=0;i<result.length;i++){
				                 	    		var objIp = result[i];
				                 	    		ipList.push(objIp.ip);
				                 	    	 }
				                 	     }
				                 	    data.availableIpList(ipList);
				                	},function(){});
			                  }
			                  
			                 this.chargeChangeCart = function(data, event){//vm
			                      var serviceUuid=data.serviceUuid();
			                      var cycle=data.billCycle();
			           	    	  csc.rest.get("api/v5.0.0/billing/rules/calculate?serviceUuid="+serviceUuid+"&cycle="+cycle, function(result,textStatus,data){
			           	    		var price = 0;
			           	    		var vcpu=data.vcpu!=null?data.vcpu():0;
			           	    		var memory=data.memory!=null?data.memory():0;
			           	    		var storage=data.storage!=null?data.storage():0;
			           	    		var size=data.volumeSize!=null?data.volumeSize():0;
			           	    		var type=data.billCycle();
			           	    	   
			                         if(typeof(type)=="undefined" ){
			                      	     data.fee("");
			             	    		 return;
			                         }
			           	    		result.ruleList.forEach(function(e){
			           	    			if(e.attrType=='CPU'){
			           	    				price += vcpu * e.unitPrice;
			           	    			}else if(e.attrType=='MEMORY'){
			           	    				price += memory * e.unitPrice;
			           	    			}else if(e.attrType=='STORAGE'){
			           	    				price += storage * e.unitPrice;
			           	    			}else if(e.attrType=='DISK'){
			           	    				price += size * e.unitPrice;
			           	    			}else if(e.attrType=='LOAD_BALANCING'){
			           	    				price +=e.unitPrice;
			           	    			}else if(e.attrType=='SECRET_KEY'){
			           	    				price +=e.unitPrice;
			           	    			}
			           	    		});
			           	    		if(type=="DAY"){
			           	    			price+="元/天";
			           	    		}else if(type=="MONTH"){
			           	    			price+="元/月";
			           	    		}else if(type=="QUARTER"){
			           	    			price+="元/季度";
			           	    		}else{
			           	    			price+="元/年";
			           	    		}
			           	    		data.fee(price);
			           	    	},function(){},data);	    	
			           	    }
			                 
			                function setArrayCharge(attr){
				      	  	    	var arrayCharge = [];
				      	  	    	if(attr !=null){
				      	  	    		for(var i=0;i<attr.length;i++){
				      	      	    		if(attr[i]=="DAY"){
				      	      	    			arrayCharge.push({name:"按天",value:"DAY"});
				      	      	    		}else if(attr[i]=="MONTH"){
				      	      	    			arrayCharge.push({name:"按月",value:"MONTH"});
				      	      	    		}else if(attr[i]=="QUARTER"){
				      	      	    			arrayCharge.push({name:"按季度",value:"QUARTER"});
				      	      	    		}else if(attr[i]=="YEAR"){
				      	      	    			arrayCharge.push({name:"按年",value:"YEAR"});
				      	      	    		}
				      	      	    	}
				      	  	    	}
				      	  	    	return arrayCharge;
				      	  	 }
			                 
				      		  
				      		function DiskInfo(){
				      			this.uuid= ko.observable(""),
				      			this.serviceUuid= ko.observable(""),
				      			this.serviceName = ko.observable(""),
				      	        this.instanceName= ko.observable(""),
				      	        this.vmName= ko.observable(""),
				      	        this.vdcUuid= ko.observable(""),
				      	        this.vdcName=ko.observable(""),
				      	        this.azUuid=ko.observable(""),
				      	        this.azName=ko.observable(""),
				      	        this.vpcUuid=ko.observable(""),
				      	        this.vpcName=ko.observable(""),
				      	        this.volumeSize = ko.observable(""),
				      	        this.billCycle= ko.observable(""),
				      	        this.billCycleText = ko.pureComputed(function(){
				 	            	 return csc.util.getBillCycleText(this.billCycle());
				 	            }, this);
				      	        this.fee= ko.observable(""),
				      	        this.expireType=ko.observable(""),
				      	        this.expireValue=ko.observable(""),
				      	        this.expireText = ko.pureComputed(function(){
				 	            	 return csc.util.getExpireText(this.expireType(),this.expireValue());
				 	            }, this);
				      	        this.isBill=ko.observable(""),
				      	        this.relateUuid=ko.observable(""),
				      	  	    this.billRuleList = ko.observableArray([])
				      	   }
				      		
				      		
				      		  
				      		  function VmInfo(){
				      			this.uuid= ko.observable(""),
				      			this.serviceUuid= ko.observable(""),
				      	        this.instanceName= ko.observable(""),
				      	        this.vdcUuid= ko.observable(""),
				      	        this.vdcName=ko.observable(""),
				 	      	    this.vdcName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.vdcList(), {uuid: this.vdcUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.azUuid=ko.observable(""),
				      	        this.azName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.azList(), {uuid: this.azUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.vpcUuid=ko.observable(""),
				      	        this.vpcName=ko.observable(""),
				      	        this.vpcName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.vpcList(), {uuid: this.vpcUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.osType= ko.observable(""),
				      	        this.osVersion= ko.observable(""),
				      	        this.osVersionName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.osVersionList(), {uuid: this.osVersion()});
				 	            	if(item!=null){
				 	            		return item.opSysVersion;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.vcpu= ko.observable(""),
				      	        this.memory= ko.observable(""),
				      	        this.storage= ko.observable(""),
				      	        this.networkUuid= ko.observable(""),
				      	        this.networkName= ko.observable(""),
				      	        this.networkName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.privateNetworkList(), {uuid: this.networkUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.ip= ko.observable(""),
				      	        this.account= ko.observable(""),
				      	        this.password= ko.observable(""),
				      	        this.repeatPassword= ko.observable(""),
				      	        this.sshKeyUuid= ko.observable(""),
				      	        this.sshKeyName=ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.sshList(), {uuid: this.sshKeyUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.billCycle= ko.observable(""),
				 	      	    this.billCycleText = ko.pureComputed(function(){
				 	            	 return csc.util.getBillCycleText(this.billCycle());
				 	            }, this);
				      	        this.fee= ko.observable(""),
				      	        this.expireType=ko.observable(""),
				      	        this.expireValue=ko.observable(""),
				      	        this.expireText = ko.pureComputed(function(){
				      	      	 return csc.util.getExpireText(this.expireType(),this.expireValue());
				 	            }, this);
				      	        this.isBill=ko.observable(""),
				      	        this.busSysUuid=ko.observable(""),
				      	        this.busSysName = ko.pureComputed(function(){
				 	            	var item = _.findWhere(this.bussyList(), {uuid: this.busSysUuid()});
				 	            	if(item!=null){
				 	            		return item.name;
				 	            	}else{
				 	            		return "";
				 	            	}
				 	            }, this);
				      	        this.relateUuid=ko.observable(""),
				      	        this.mountDiskList =  ko.observableArray([]),
				      	        this.vdcList = ko.observableArray([]),
				 	      	    this.vpcList = ko.observableArray([]),
				 	      	    this.azList = ko.observableArray([]),
				 	      	    this.privateNetworkList = ko.observableArray([]),
				 	      	    this.osTypeList = ko.observableArray([]),
				 	      	    this.cpuList = ko.observableArray([]),
				 	      	    this.memoryList = ko.observableArray([]),
				 	      	    this.osVersionList = ko.observableArray([]),
				 	      	    this.sshList = ko.observableArray([]),
				      			this.bussyList = ko.observableArray([]),
				      			this.billRuleList = ko.observableArray([]),
				      			this.availableIpList = ko.observableArray([])
				      		  }
				      		  
				      		  
				      		 self.save = function(){
				      	    
					      		    var orderUuid = self.currentVO.toJSON().orderData.uuid;
					      		    var orderData =  self.currentVO.toJSON().orderData;
					      		    
					      	    	console.log("pre----------",orderData)
					      		    
					      		    var vmOrderItems = [];
				        		    var diskOrderItems= [];
				        		    for(var i=0;i<orderData.orderItems.length;i++){
				        			  var orderItem = orderData.orderItems[i];
				        			  if(orderItem.resourceType == "VM"){
				        				  vmOrderItems.push(orderItem);
				        			  }else if(orderItem.resourceType == "DISK"){
				        				  diskOrderItems.push(orderItem);
				        			  }
				        		    }
				        		    
				      	            var vmOrderItemVONew = [];
				        			var vmList = self.currentVO().vmApplyList();
				      		        var diskList = self.currentVO().diskApplyList();
				      		        for(var j=0;j<vmList.length;j++){
					      			    var vmVO = vmList[j];
					      			    var vmOrderItemVO = {};
					      			    vmOrderItemVO.resourceType ="VM"; 
					      			 	vmOrderItemVO.orderUuid = orderUuid;
					      			 	vmOrderItemVO.serviceUuid = vmVO.serviceUuid();
					      				vmOrderItemVO.vdcUuid = vmVO.vdcUuid();
					      	 	    	vmOrderItemVO.relateUuid = vmVO.relateUuid();
						      			vmOrderItemVO.azUuid = vmVO.azUuid();
				        		    	vmOrderItemVO.billCycle = vmVO.billCycle();
				        		    	vmOrderItemVO.expireType = vmVO.expireType();
				        		    	vmOrderItemVO.expireValue = vmVO.expireValue();
				        		    	vmOrderItemVO.fee = vmVO.fee();
				        		    	vmOrderItemVO.instanceName = vmVO.instanceName();
				        		  	    var metaData = {};
				        		   	    var metaDataResBaseInfo= {};
				        		   	    metaDataResBaseInfo.networkList = [{networkId:vmVO.networkUuid(),ip:vmVO.ip()}];
				        		   	    metaDataResBaseInfo.azUuid = vmVO.azUuid();
					        		   	metaDataResBaseInfo.vdcUuid = vmVO.vdcUuid();
					        		   	metaDataResBaseInfo.vpcUuid = vmVO.vpcUuid();
				        		   	    metaDataResBaseInfo.osVersion = vmVO.osVersion();
					        		   	metaDataResBaseInfo.osType = vmVO.osType();
					        		 	metaDataResBaseInfo.account = vmVO.account();
					        		   	metaDataResBaseInfo.password = vmVO.password();
					        		 	metaDataResBaseInfo.repeatPassword = vmVO.repeatPassword();
					        		 	metaDataResBaseInfo.vcpu = vmVO.vcpu();
					        		   	metaDataResBaseInfo.memory = vmVO.memory();
					        		   	metaDataResBaseInfo.storage = vmVO.storage();
					        		 	metaDataResBaseInfo.ip = vmVO.ip();
					        		 	metaDataResBaseInfo.busSysUuid = vmVO.busSysUuid();
					        		   	metaDataResBaseInfo.sshUuid = vmVO.sshKeyUuid();
					        			metaData.resBaseInfo =  metaDataResBaseInfo;
			    		  		    	vmOrderItemVO.metaData =  JSON.stringify(metaData);
			    		  		    	vmOrderItemVONew.push(vmOrderItemVO);
				      		        }
				      		        
				      		      
					        		   // vmApplyList : ko.observableArray([]),
					      	           //  diskApplyList : ko.observableArray([]),
					      	           //  orderData: ko.observable(orderData)
				        		    
				        		    var diskOrderItemsNew = [];
				        		    var diskList = self.currentVO().diskApplyList();
			       		    	    for(var k=0;k<diskList.length;k++){
			       		    	    	var diskVO = diskList[k];
			       		    	    	var newDiskOrderItem = {};
			       		    	    	newDiskOrderItem.billCycle = diskVO.billCycle();
			       		    	    	newDiskOrderItem.expireType = diskVO.expireType();
			       		    	    	newDiskOrderItem.expireValue = diskVO.expireValue();
			       		    	    	newDiskOrderItem.fee = diskVO.fee();
			       		    	    	newDiskOrderItem.instanceName = diskVO.instanceName();
			       		    	    	newDiskOrderItem.isBill =  diskVO.isBill(); 
			       		    	    	newDiskOrderItem.itemState = "RESOURCE_APPLY";
			       		    	    	newDiskOrderItem.orderUuid = orderUuid;
			       		    	    	var metaData = {resBaseInfo:{}};
			       		    	    	metaData.resBaseInfo.volumeSize = diskVO.volumeSize();
			       		    	    	newDiskOrderItem.metaData = JSON.stringify(metaData)
			       		    	    	newDiskOrderItem.relateUuid = diskVO.relateUuid();
			       		    	    	newDiskOrderItem.resourceType ="DISK";
			       		    	    	newDiskOrderItem.serviceUuid =diskVO.serviceUuid();
			       		    	    	newDiskOrderItem.uuid =diskVO.uuid();
			       		    	    	diskOrderItemsNew.push(newDiskOrderItem);
			       		    	    }
			       		    	    
			       		    	    orderData.orderItems = vmOrderItemVONew.concat(diskOrderItemsNew)
			       		    	    console.log("after----------",orderData)
				               	    csc.rest.put("api/v5.0.0/orders/"+orderUuid,orderData, function(data){
				               		     alert("保存成功！");
				               	   });  
					     	   }
				      		  
				     }
				     ko.applyBindings(new ViewModel(), $('#approveContent')[0]);
				     
				     
				     
				     $('#orderDetailedList .applyDateFormat').each(function(n,v){
	             		 $(this).daterangepicker({
	                     	startDate: $(this).val() || new Date(), 
	                         endDate: false, 
	                         singleDatePicker:true
	                     }); 
	             	 })
				     
	      	 });
	    });
	  
	  

		

    
    $("#vmApplyUnSubmitVmTable").on("click",".expand-btn-detail",function(){
    	 $(this).find('i').toggleClass("fa-angle-double-down");
         $(this).parents('tr').next("tr").toggle();
         if($(this).parents('tr').next("tr").find('.sub-detail').css("display") == "block"){
        	 $(this).parents('tr').next("tr").find('.sub-detail').css("display","none");
        	 $(this).parents('tr').next("tr").find('.sub-edit').css("display","none");
        	  $(this).parents('tr').next("tr").css("display","none");
         }else{
        	 $(this).parents('tr').next("tr").find('.sub-edit').css("display","none");
        	 $(this).parents('tr').next("tr").find('.sub-detail').css("display","block");
        	 $(this).parents('tr').next("tr").css("display","table-row");
         }
         
    });
    
    $("#vmApplyUnSubmitVmTable").on("click",".expand-btn-edit",function(){
    	   $(this).find('i').toggleClass("fa-angle-double-down");
    	   $(this).parents('tr').next("tr").toggle();
    	   if($(this).parents('tr').next("tr").find('.sub-edit').css("display") == "block"){
          	 $(this).parents('tr').next("tr").find('.sub-edit').css("display","none");
          	 $(this).parents('tr').next("tr").find('.sub-detail').css("display","none");
          	 $(this).parents('tr').next("tr").css("display","none");
           }else{
          	 $(this).parents('tr').next("tr").find('.sub-detail').css("display","none");
          	 $(this).parents('tr').next("tr").find('.sub-edit').css("display","block");
          	 $(this).parents('tr').next("tr").css("display","table-row");
           }

           $('.applyDateFormat').each(function(n,v){
       		$(this).daterangepicker({
               	startDate: $(this).val() || new Date(), 
                   endDate: false, 
                   singleDatePicker:true
               });
       	  })
   });
    

  })
</script>