    <div class="panel panel-info">
        <div class="panel-heading">VDC变更</div>
        <div id="orderDetailedList" class="wrapper">
            <div class="panel panel-default">
              <div class="panel-heading"><strong>VDC名称：</strong><span data-bind="text: vdc().instanceName"></span></div>
              <div class="panel-body no-padder form-inline">
                <div class="form-group" style="padding:15px;">
                  <label for="exampleInputName2">支持的操作系统：</label>
                  <div class="checkbox"><label><input checked disabled class="form-group" type="checkbox" data-bind="checked: windows"/> Windows</label></div>&nbsp;&nbsp;
                  <div class="checkbox"><label><input disabled class="form-group" type="checkbox" data-bind="checked: linux"/> Linux</label></div>&nbsp;&nbsp;
                  <div class="checkbox"><label><input disabled class="form-group" type="checkbox" data-bind="checked: aix"/> Aix</label></div>
                </div>
                <div class="table-responsive no-height" data-bind="visible: quotas().length > 0">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th></th>
                        <th>申请前</th>
                        <th>申请后</th>
                        <th></th>
                        <th>申请前</th>
                        <th>申请后</th>
                      </tr>
                    </thead>
                    <tbody data-bind="foreach: quotas">
	                  <tr>
	                    <td>
	                    	<span data-bind="visible: q1.type=='CPU'">CPU(个)</span>
	                    	<span data-bind="visible: q1.type=='MEMORY'">内存(GB)</span>
	                    	<span data-bind="visible: q1.type=='STORAGE'">存储(GB)</span>
	                    	<span data-bind="visible: q1.type=='VPC'">VPC(个)</span>
	                    	<span data-bind="visible: q1.type=='VM'">云主机(个)</span>
	                    	<span data-bind="visible: q1.type=='DISK'">云硬盘(个)</span>
	                    	<span data-bind="visible: q1.type=='PUBLICIP'">公网IP(个)</span>
	                    	<span data-bind="visible: q1.type=='ROUTER'">路由器(个)</span>
	                    	<span data-bind="visible: q1.type=='FIREWALL'">防火墙(个)</span>
	                    	<span data-bind="visible: q1.type=='LOAD_BALANCING'">负载均衡器(个)</span>
	                    	<span data-bind="visible: q1.type=='SECRET_KEY'">SSH密钥(对)</span>
	                    	<span data-bind="visible: q1.type=='OBJECT_STORAGE'">对象存储(GB)</span>
	                    	<span data-bind="visible: q1.type=='SECURITY_GROUP'">安全组(个)</span>
	                    	<span data-bind="visible: q1.type=='VPN'">VPN(个)</span>
	                    </td>
	                    <td>
	                    	<span data-bind="text: $root.applyChangeVdc().cpu,visible: q1.type=='CPU'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().memory,visible: q1.type=='MEMORY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().storage,visible: q1.type=='STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpc,visible: q1.type=='VPC'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vm,visible: q1.type=='VM'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().disk,visible: q1.type=='DISK'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().publicIp,visible: q1.type=='PUBLICIP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().router,visible: q1.type=='ROUTER'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().firewall,visible: q1.type=='FIREWALL'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().loadBalance,visible: q1.type=='LOAD_BALANCING'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().secretKey,visible: q1.type=='SECRET_KEY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().objectStorage,visible: q1.type=='OBJECT_STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().securityGroup,visible: q1.type=='SECURITY_GROUP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpn,visible: q1.type=='VPN'"></span>
	                    </td>
	                    <td>
	                    	<input type="text" class="form-control input-sm" data-bind="value: q1.value" data-toggle="tooltip" data-placement="right" data-trigger="focus" disabled>
	                    </td>
	                    <td>
	                    	<span data-bind="visible: q2.type=='CPU'">CPU(个)</span>
	                    	<span data-bind="visible: q2.type=='MEMORY'">内存(GB)</span>
	                    	<span data-bind="visible: q2.type=='STORAGE'">存储(GB)</span>
	                    	<span data-bind="visible: q2.type=='VPC'">VPC(个)</span>
	                    	<span data-bind="visible: q2.type=='VM'">云主机(个)</span>
	                    	<span data-bind="visible: q2.type=='DISK'">云硬盘(个)</span>
	                    	<span data-bind="visible: q2.type=='PUBLICIP'">公网IP(个)</span>
	                    	<span data-bind="visible: q2.type=='ROUTER'">路由器(个)</span>
	                    	<span data-bind="visible: q2.type=='FIREWALL'">防火墙(个)</span>
	                    	<span data-bind="visible: q2.type=='LOAD_BALANCING'">负载均衡器(个)</span>
	                    	<span data-bind="visible: q2.type=='SECRET_KEY'">SSH密钥(对)</span>
	                    	<span data-bind="visible: q2.type=='OBJECT_STORAGE'">对象存储(GB)</span>
	                    	<span data-bind="visible: q2.type=='SECURITY_GROUP'">安全组(个)</span>
	                    	<span data-bind="visible: q2.type=='VPN'">VPN(个)</span>
	                    </td>
	                    <td>
	                    	<span data-bind="text: $root.applyChangeVdc().cpu,visible: q2.type=='CPU'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().memory,visible: q2.type=='MEMORY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().storage,visible: q2.type=='STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpc,visible: q2.type=='VPC'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vm,visible: q2.type=='VM'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().disk,visible: q2.type=='DISK'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().publicIp,visible: q2.type=='PUBLICIP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().router,visible: q2.type=='ROUTER'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().firewall,visible: q2.type=='FIREWALL'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().loadBalance,visible: q2.type=='LOAD_BALANCING'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().secretKey,visible: q2.type=='SECRET_KEY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().objectStorage,visible: q2.type=='OBJECT_STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().securityGroup,visible: q2.type=='SECURITY_GROUP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpn,visible: q2.type=='VPN'"></span>
	                    </td>
	                    <td>
	                    	<input type="text" class="form-control input-sm" data-bind="value: q2.value,visible:q2.value!=''" data-toggle="tooltip" data-placement="right" data-trigger="focus" disabled>
	                    </td>
	                  </tr>
	                </tbody>
                  </table>
                </div>
              </div>
            </div>
            
            <div>
            	<h5 class="text-info">可用分区 <button class="btn btn-sm btn-info" data-bind="click:addVdcAZ">添加</button></h5>
	            <table class="table table-striped">
	                <thead>
	                    <tr>
	                        <th>可用分区</th>
	                        <th>云管理平台</th>
	                        <th>虚拟化类型</th>
	                        <th>操作</th>
	                    </tr>
	                </thead>
	                <tbody id="vdcRelAcList" data-bind="foreach: azs">
	                	<tr>
	                		<input type="hidden" data-bind="value: uuid" name="azUuid">
	                		<td data-bind="text: name"></td>
	                		<td data-bind="text: cloudPlatform"></td>
	                		<td data-bind="text: virtualHypervisor"></td>
	                		<td><a data-bind="click: $root.removeAz">移除</a></td>
	                	</tr>
	                </tbody>
	            </table>
	            
	            <h5 class="text-info">网络 <button class="btn btn-sm btn-info" data-bind="click:addVdcNetwork">添加</button></h5>
	            <table class="table table-striped">
	                <thead>
	                    <tr>
	                        <th>网络名称/IP池</th>
	                        <th>云管理平台</th>
	                        <th>可用分区</th>
	                        <th>操作</th>
	                    </tr>
	                </thead>
	                <tbody data-bind="foreach: networks">
	                	<tr>
	                		<input type="hidden" data-bind="value: networkUuid,attr:{azUuid:azUuid}" name="networkUuid">
	                		<td data-bind="text: networkName"></td>
	                		<td data-bind="text: cloudPlatformName"></td>
	                		<td data-bind="text: azName"></td>
	                		<td><a data-bind="click: $root.removeNetwork">移除</a></td>
	                	</tr>
	                </tbody>
	            </table>
            </div>

	        </div>
	        
	        <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: addVdcAZModel }">
		      <div class='modal-dialog modal-lg' role='document'>
			    <div class='modal-content'>
			      <div class='modal-header'>
			        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加分区</h3>
			      </div>
			      <div class='modal-body'>
			        <div>
			          <div class="row" id="net_0">
			            <div class="col-xs-5">
			              <p>待选择：</p>
			              <div class="table-responsive">
			              <div style="height:400px; overflow:scroll;">
				              <table class="table table-striped">
				                <thead>
				                  <th>
				                    <div class="checkbox">
				                      <label class="i-checks">
				                        <input type="checkbox" value="">
				                        <i></i>
				                      </label>
				                    </div> 
				                  </th>
				                  <th>云管理平台</th>
				                  <th>虚拟化类型</th>
				                  <th>可用分区</th>
				                </thead>
				                <tbody  id="availableAzListTableId">
				                  <tr>
				                    <td>
				                      <div class="checkbox">
				                        <label class="i-checks">
				                          <input type="checkbox"  value="">
				                          <i></i>
				                        </label>
				                      </div> 
				                    </td>
				                    <td>wincenter</td>
				                    <td>WinServer</td>
				                    <td>zone1</td>
				                  </tr>
				                </tbody>
				              </table>
				             </div>
			              </div>
			            </div>
			            <div class="col-xs-2">
			              <button class="btn btn-block btn-default" id="addAz2PreAddList" style="margin-top:150px">&gt;&gt;</button>
			              <button class="btn btn-block btn-default" id="removeAz2PreAddList" >&lt;&lt;</button>
			            </div>
			            <div class="col-xs-5">
			              <p>已选择：</p>
			              <div class="table-responsive">               
			              <table class="table table-striped">
			                <thead>
			                  <th>
			                    <div class="checkbox">
			                      <label class="i-checks">
			                        <input type="checkbox" value="">
			                        <i></i>
			                      </label>
			                    </div> 
			                  </th>
			                  <th>云管理平台</th>
			                  <th>虚拟化类型</th>
			                  <th>可用分区</th>
			                </thead>
			                <tbody id="preAddAzListTableId">
			                </tbody>
			              </table>
			              </div>
			            </div>
			          </div>
			          <div id="net_1" style="display:none">
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>子网名称
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>生成IP方式
			              </label>
			              <div class="col-xs-3">
			                <select class="form-control" >
			                  <option>网段</option>
			                </select>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>开始地址
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>结束地址
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>掩码
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>网关
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>主DNS
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			            <div class="form-group string required">
			              <label class="string required col-xs-2 control-label">
			                <abbr title="必填项">*</abbr>备DNS
			              </label>
			              <div class="col-xs-3">
			                <input class="string required form-control" type="text"/>
			              </div>
			            </div>
			          </div>
			        </div>
			      </div>
			      <div class='modal-footer'>
			        <input type="button" name="commit" value="确定" data-bind="click:confirmAddAz" class="btn btn-default btn-info" />
			        <button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
			      </div>
			    </div>
			  </div>
		    </div>
		    
		    <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: addVdcNetworkModel }" >   
		    <div class='modal-dialog modal-lg' role='document'>
				<div class='modal-content'>
					<div class='modal-header'>
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加网络</h3>
					</div>
					<div class='modal-body form-horizontal'>
						<div class="row">
							<div class="col-xs-5" style="width:380px">
								<p>待选择：</p>
								<div class="form-inline text-right" style="margin-bottom:10px;">
									<select class="form-control input-sm"  data-bind="options:addVdcNetworkAzList,optionsText:'name',optionsValue:'uuid',value: addVdcNetworkAzVO().uuid">
									</select>
									<div class="form-group input-group">
		                            	<input type="text" class="input-sm form-control" style="width:100px;" placeholder="请输入名称" data-bind="value:addVdcNetworkSearchParam().name">
		                            	<button class="btn btn-sm btn-default" type="button" data-bind="click:addVdcNetworkSearch"  >搜索</button>
		                            </div>
								</div>
								<div style="height:400px; overflow:scroll;">
									<table class="table table-striped">
										<thead>
											<th>
							                  <div class="checkbox">
							                    <label class="i-checks">
							                      <input type="checkbox" value="">
							                      <i></i>
							                    </label>
							                  </div> 
							                </th>
											<th>可用分区</th>
											<th>外部网络/IP池</th>
										</thead>
										<tbody id="availableAzNetworkListTableId">
										</tbody>
									</table>
								</div>
							</div>
							<div class="col-xs-1">
								<button class="btn btn-block btn-default" id="addNetwork2PreAddList" style="margin-top:150px">&gt;&gt;</button>
								<button class="btn btn-block btn-default" id="removeNetwork2PreAddList" >&lt;&lt;</button>
							</div>
							<div class="col-xs-5" style="width:380px">
								<p>已选择：</p>
								<table class="table table-striped">
									<thead>
										<th>
						                  <div class="checkbox">
						                    <label class="i-checks">
						                      <input type="checkbox" value="">
						                      <i></i>
						                    </label>
						                  </div> 
						                </th>
										<th>可用分区</th>
										<th>外部网络/IP池</th>
									</thead>
									<tbody id="preAddAzNetworkListTableId">
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class='modal-footer'>
						<input type="button" name="commit" value="确定"  data-bind="click:confirmVdcAddNetwork" class="btn btn-default btn-info" />
						<button name="button" type="submit" class="btn btn-default btn btn-default" data-dismiss="modal">取消</button>
					</div>
				</div>
			</div>
	    </div>

    </div>


<!-- page specific plugin scripts -->
<script type="text/javascript">
  var scripts = ["api/vdc/vdc.js"]
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
	  function ViewModel(){
		  var self = this;
		  
		  this.order = ko.observable("");
	  	  this.vdc = ko.observable("");
	  	  this.resBaseInfo = ko.observable("");
	  	  this.osType = ko.observable("");
	  	  this.metaData = ko.observable("");
	  	  this.vdcQuotaList = ko.observable("");
	  	  this.expireType = ko.observable("");
	  	  this.expireValue = ko.observable("");
	  	  this.limitQuota = ko.observable("");
	  	
	  	  this.windows = ko.observable("");
	  	  this.linux = ko.observable("");
	  	  this.aix = ko.observable("");
	  	  this.quotas = ko.observable("");
	  	  
	  	  this.applyChangeVdc = ko.validatedObservable({
  	        cpu: ko.observable(""),
  	        memory: ko.observable(""),
  	        storage: ko.observable(""),
  	        vpc: ko.observable(""),
  	        vm: ko.observable(""),
  	        disk: ko.observable(""),
  	        publicIp: ko.observable(""),
  	        router: ko.observable(""),
  	        firewall: ko.observable(""),
  	        loadBalance: ko.observable(""),
  	        secretKey: ko.observable(""),
  	        objectStorage: ko.observable(""),
	  	    securityGroup: ko.observable(""),
	  	    vpn: ko.observable("")
  	      });
		  
		  this.metaVdc = ko.validatedObservable({
  	        cpu: ko.observable(""),
  	        memory: ko.observable(""),
  	        storage: ko.observable(""),
  	        vpc: ko.observable(""),
  	        vm: ko.observable(""),
  	        disk: ko.observable(""),
  	        publicIp: ko.observable(""),
  	        router: ko.observable(""),
  	        firewall: ko.observable(""),
  	        loadBalance: ko.observable(""),
  	        secretKey: ko.observable(""),
  	        objectStorage: ko.observable(""),
	  	    securityGroup: ko.observable(""),
	  	    vpn: ko.observable("")
  	      });
	  	  
		  csc.rest.get('api/v5.0.0/workflows/tasks/'+args.taskId,function(data){
	   	     var processInstanceId = data.taskInfo[0].processInstanceId;
			 //获取订单数据
	      	 csc.rest.get('api/v5.0.0/orders/byFlowInstanceUuid/'+processInstanceId,function(data){
	      		var orderData = data;
	      		var itemListData = data.orderItems;
	      		var metaData = JSON.parse(itemListData[0].metaData);
	      		var resBaseInfo = JSON.parse(metaData.resBaseInfo);
	      		var osType = metaData.osType;
	      		var vdcQuotaList = resBaseInfo.vdcQuotaList;
	      		var azs = resBaseInfo.azs;
	      		self.order(orderData);
	      		self.vdc(itemListData[0]);
	      		self.metaData(metaData);
	      		
	      		var quotas = [];
    			var quota = {};
	    		var num = 1;
	    		for(var i=vdcQuotaList.length-1;i>=0;i--){
	    			if(vdcQuotaList[i].value == ''){
	    				continue;
	    			}
	    			if(num == 1){
	    				quota.q1 = vdcQuotaList[i];
	    				num++;
	    				if(i == 0){
	    					quotas.push(quota);
	    					var q2={value:'',type:''};
	    					quota.q2 = q2;
	    				}
	    			}else{
	    				quota.q2 = vdcQuotaList[i];
	    				quotas.push(quota);
	    				quota = {};
	    				num = 1;
	    			}
	    		}
	    		self.quotas(quotas);
	    		
	      		$.VDC.getVdcQuota(itemListData[0].resourceUuid,"",function(data){
	      			var vdcQuotaList = data.results;
	      			for(var i=0;i<vdcQuotaList.length;i++){	      				
		      			if(vdcQuotaList[i].type=='CPU'){
		      				self.applyChangeVdc().cpu(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='MEMORY'){
		      				self.applyChangeVdc().memory(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='STORAGE'){
		      				self.applyChangeVdc().storage(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VPC'){
		      				self.applyChangeVdc().vpc(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VM'){
		      				self.applyChangeVdc().vm(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='DISK'){
		      				self.applyChangeVdc().disk(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='PUBLICIP'){
		      				self.applyChangeVdc().publicIp(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='ROUTER'){
		      				self.applyChangeVdc().router(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='FIREWALL'){
		      				self.applyChangeVdc().firewall(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='SECRET_KEY'){
		      				self.applyChangeVdc().secretKey(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='OBJECT_STORAGE'){
		      				self.applyChangeVdc().objectStorage(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='LOAD_BALANCING'){
		      				self.applyChangeVdc().loadBalance(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='SECURITY_GROUP'){
		      				self.applyChangeVdc().securityGroup(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VPN'){
		      				self.applyChangeVdc().vpn(vdcQuotaList[i].value);
		      			}
	      			}
		    	})
	      		
	      		for(var i=0;i<osType.length;i++){
	      			if(osType[i]=='windows'){
	      				self.windows(true);
	      			}else if(osType[i]=='linux'){
	      				self.linux(true);
	      			}else if(osType[i]=='aix'){
	      				self.aix(true);
	      			}
	      		}
	      		
	      		var azList = [];
	      		var networks = [];
	      		if(azs != undefined){	      			
		      		for(var i=0;i<azs.length;i++){
		      			$.VDC.getAvailableToVdc({uuid:azs[i].uuid},function(data){
			      			azList.push(data.results[0]);
			      			self.azs(azList);
		      			});
		      			var nwUuids = azs[i].networks;
		      			for(var j=0;j<nwUuids.length;j++){
		      				csc.rest.get('api/v5.0.0/networks?getOne=true&azUuid='+azs[i].uuid+'&networkUuid='+nwUuids[j].uuid,function(data){
		      					console.log(data);
			      				networks.push({'networkName':data.name,'azName':data.azName,'cloudPlatformName':data.cloudPlatformName,
			      					'networkUuid':data.uuid,'azUuid':data.azUuid});
			      				self.networks(networks);
		   					});
		      			}
		      		}
	      		}
	      	 })
		  })
		  
		  this.azs = ko.observable("");//可用分区列表
    	  this.networks = ko.observable("");//网络列表
		  /*****添加AZ start*****/
	        this.addVdcAZModel = ko.observable(false);
	        self.addVdcAZ = function(){
				$("#availableAzListTableId").html("");
				$("#preAddAzListTableId").html("");
				$.VDC.getAvailableToVdc({},function(data){
					  var tableBody = "";
					  if(data && data.results){
						  var azList = data.results;
						  for(var i=0;i<azList.length;i++){
							  var az = azList[i];
							  tableBody += "<tr><td><div class=\"checkbox\"><label class=\"i-checks\"><input type=\"checkbox\" value=\""+ az.uuid +"\" name=\"azUuid\"/><i></i></label></div></td>"
							  	+"<td id='cloudPlatform"+i+"'>"+az.cloudPlatform+"</td><td id=\"virtualHypervisor"+i+"\">"+az.virtualHypervisor+"</td><td id=\"name"+i+"\">"+az.name+"</td></tr>";
						  } 
					  }
					  $("#availableAzListTableId").html(tableBody);
				});
				self.addVdcAZModel(true);
				
				$("#addAz2PreAddList").bind("click",function(data){
				    $("#availableAzListTableId input[type='checkbox']:checked").each(function(){
				    	$("#preAddAzListTableId").append($(this).parents("tr").prop("outerHTML")) 
				    	$(this).parents("tr").remove()
				    })
				})
				
				$("#removeAz2PreAddList").bind("click",function(data){
					$("#preAddAzListTableId input[type='checkbox']:checked").each(function(){
						$("#availableAzListTableId").append($(this).parents("tr").prop("outerHTML")) 
						$(this).parents("tr").remove()
				    })
				})
			}
	        
	        
	        self.confirmAddAz = function(){
				var azs = [];
				$("#preAddAzListTableId input[type='checkbox']").each(function(index){
					//azs.push({uuid:$(this).val()});
					var cloudPlatform = $("#cloudPlatform"+index).text();
					var virtualHypervisor = $("#virtualHypervisor"+index).text();
					var name = $("#name"+index).text();
					var az={uuid:$(this).val(),cloudPlatform:$("#cloudPlatform"+index).text(),
							virtualHypervisor:$("#virtualHypervisor"+index).text(),name:$("#name"+index).text()};
					azs.push(az);
					/* $("#vdcRelAcList").append("<tr id='"+$(this).val()+"'><td><input type='hidden' value='"+$(this).val()+"'>"
							+name+"</td><td>"+cloudPlatform+"</td><td>"
							+virtualHypervisor+"</td><td><a data-bind='click: removeAz'>移除</a></td></tr>"); */
			    })
			    self.azs(azs);
			    self.addVdcAZModel(false);
			}
	        this.removeAz = function(object){
	        	$("input[name='azUuid'][value='"+object.uuid+"']").parent().remove();
	        }
	        /*****添加AZ end*****/
	        
	        
	        /*****添加AZ下的网络*****/
			self.addVdcNetworkModel = ko.observable(false);
			
			self.addVdcNetworkAzList = ko.observableArray();
			self.addVdcNetworkAzVO = ko.observable({"uuid":""})
			self.addVdcNetworkSearchParam = ko.observable({
	    	        name: ""
	    	    })
	    	self.addVdcNetworkAzList([]);
			
		    self.addVdcNetworkSearch = function(){
				$("#availableAzNetworkListTableId").html("");
				var azUuid = self.addVdcNetworkAzVO().uuid ;
				if(!azUuid){
					return;
				}
				var name = self.addVdcNetworkSearchParam().name;
				csc.rest.get('api/v5.0.0/networks?azUuid='+azUuid+"&name="+name,function(data){
					var tableBody = "";
				   if(data && data.results){
					   for(var i=0;i<data.results.length;i++){
						   var network = data.results[i];
						   tableBody += "<tr><td><div class=\"checkbox\"><label class=\"i-checks\"><input type=\"checkbox\" az=\""
						   		+ network.azUuid+"\" azName=\""+network.azName+"\" cloudPlatformName=\""+network.cloudPlatformName +"\" networkName=\""+network.name+"\" value=\""+network.uuid+"\"><i></i></label></div>";
                           tableBody += "</td><td>"+network.azName+"</td><td>"+network.name+"</td>/tr>"
					   }
				   }
				   $("#availableAzNetworkListTableId").html(tableBody);
   		    	}); 
       	    }
			
			self.addVdcNetwork = function(){
				$("#availableAzNetworkListTableId").html("");
				$("#preAddAzNetworkListTableId").html("");
				self.addVdcNetworkAzList(this.azs());
				self.addVdcNetworkModel(true)
				self.addVdcNetworkSearch();
				$("#addNetwork2PreAddList").bind("click",function(data){
				    $("#availableAzNetworkListTableId input[type='checkbox']").each(function(){
				        if($(this).prop("checked")){
				    	   $("#preAddAzNetworkListTableId").append($(this).parents("tr").prop("outerHTML")) 
				    	   $(this).parents("tr").remove();
				        } 
				    })
				})
				
				$("#removeNetwork2PreAddList").bind("click",function(data){
					$("#preAddAzNetworkListTableId input[type='checkbox']").each(function(){
					   if($(this).prop("checked")){
						  $("#availableAzNetworkListTableId").append($(this).parents("tr").prop("outerHTML")) 
						  $(this).parents("tr").remove()
					    }
				    })
				})
			}
			
			this.itemResults = ko.observable("");
			self.confirmVdcAddNetwork = function(){
				var azs = [];
				var networks = [];
				$("#preAddAzNetworkListTableId input[type='checkbox']").each(function(){
					var azUuid = $(this).attr("az");
					var networkName =  $(this).attr("networkName");
					var azName =  $(this).attr("azName");
					var cloudPlatformName =  $(this).attr("cloudPlatformName");
					var networkUuid = $(this).val();
				    var notFound = true;
				    
				    var net = '';
					for(var az in azs){
						var azVo = azs[az];
						if(azVo.uuid == azUuid){
							if(!azVo.networks){
								azVo.networks = [];
							}
							azVo.networks.push({"uuid":networkUuid,"networkName":networkName});
							
							net = {"azUuid":azUuid,"networkName":networkName,"azName":azName,
									"cloudPlatformName":cloudPlatformName,"networkUuid":networkUuid};
							networks.push(net);
							notFound = false;
							break;
						}
					}
					if(notFound){
						azs.push({"uuid":azUuid,networks:[{"uuid":networkUuid,"name":networkName}]});
						net = {"azUuid":azUuid,"networkName":networkName,"azName":azName,
								"cloudPlatformName":cloudPlatformName,"networkUuid":networkUuid};
						networks.push(net);
					}
			    })
			    self.networks(networks);
			    self.addVdcNetworkModel(false);
				 
			}
			this.removeNetwork = function(object){
				$("input[name='networkUuid'][value='"+object.networkUuid+"']").parent().remove();
			}
			/*****添加AZ下的网络*****/
	        
	        
	        this.save = function(obj,event,callback){
	          	saveComment(args.taskId,function(){
	          		var azs = [];
					$("input[name='networkUuid']").each(function(){					
		          		var azUuid = $(this).attr("azuuid");
						var networkUuid = $(this).val();
					    var notFound = true;
					    
						for(var az in azs){
							var azVo = azs[az];
							if(azVo.uuid == azUuid){
								if(!azVo.networks){
									azVo.networks = [];
								}
								azVo.networks.push({"uuid":networkUuid});
								notFound = false;
								break;
							}
						}
						if(notFound){
							azs.push({"uuid":azUuid,networks:[{"uuid":networkUuid}]});
						}
					})
					var metaData = self.metaData();
					var osType = metaData.osType;
					var resBaseInfo = JSON.parse(metaData.resBaseInfo);
					var vdcQuotaList = resBaseInfo.vdcQuotaList;
					
					var meta = {"osType":osType,"resBaseInfo":{"vdcQuotaList":vdcQuotaList,"azs":azs}};
					meta = JSON.stringify(meta);
				    var itemResults = {"metaData":meta};
					
					csc.rest.put('api/v5.0.0/orders/'+self.order().uuid+'/modifyItem/'+self.vdc().uuid,itemResults,function(data){
						if(typeof(callback) != 'undefined'){
							callback();
							return;
						}
		          		alert('保存成功！');
	    		    });
	          	});
			}
			
			this.next = function(){
				self.save("","",function(){
					if(isLast){
					  saveComment(args.taskId,function(){
						var databody = {"userId":"","action":"designated"};
						csc.rest.put('api/v5.0.0/workflows/tasks/'+args.taskId,databody,function(data){
						  alert("审核成功！");
						  location.href = "#pages/workflows/tasks?type=work";
						},function(){alert("操作失败！")});
					  });
				  	}else{		  
					  showModal("pages/workflows/next.html");
				  	}
				})
			}
		}
		ko.applyBindings(new ViewModel(), $('#approveContent')[0]); 
  });
</script>