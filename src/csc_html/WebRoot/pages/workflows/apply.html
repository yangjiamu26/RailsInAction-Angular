<div class="bg-light lter b-b wrapper-sm">
  <ol class="breadcrumb">
    <li>当前位置：</li>
    <li>工作</li>
    <li class="active">新建工作</li>
  </ol>
</div>

<div id="workflow_content">
	<div class='wrapper-md'>
		<div class="row" data-bind="foreach:items">
		    <div class="col-xs-4">
		      <div class="panel panel-default">
		        <div class="panel-heading" data-bind="text: name"></div>
		        <div class="panel-body">
		          <div><span class="glyphicon glyphicon-equalizer"></span> <a data-bind="click: $root.review">流程图</a></div>
		          <div><a class="btn btn-primary pull-right" data-url="pages/resources/partitions/recovery/index" href="#pages/resources/partitions/recovery/index">申请</a></div>
		        </div>
		      </div>
		    </div>
		</div>
	</div>
</div>



<div id="workflow_edit" class="main_content_container" style="display:none;"></div>
<input id="editModelId" type="hidden">
<input id="editModelType" type="hidden">

<!-- page specific plugin scripts -->
<script type="text/javascript">
    
    function ViewModel(){
        var self = this;
        this.items = ko.observableArray([]);
        //定义一个更新表格的方法
        this.loadData = function(){
          $.ajax("api/v5.0.0/workflows/works").done(function(data){
            self.items(data);
          });
        }
        
        this.review = function(object, event){
    	  showModelView(this.id,'processDef');
      	}
    }
  
    var viewModel = new ViewModel();
    ko.applyBindings(viewModel,$("#page-content")[0]);
    //更新表格
    viewModel.loadData();
      
      
    function showModelView(id,type){	
    	showFlowContent("pages/systems/workflows/workflow_edit_index.html",id,type);
    }
    function showFlowContent(url,id,type){
    	$("#workflow_content").hide();
        $("#workflow_edit").show();
        $("#workflow_edit").html();
        $("#workflow_edit").load(url);
        $("#editModelId").val(id);
        $("#editModelType").val(type);
    }
      
</script>