    <div class="panel panel-info">
        <div class="panel-heading">VDC变更</div>
        <div id="orderDetailedList" class="wrapper">
            <div class="panel panel-default">
              <div class="panel-heading"><strong>VDC名称：</strong><span data-bind="text: vdc().instanceName"></span></div>
              <div class="panel-body no-padder form-inline">
                <div class="form-group" style="padding:15px;">
                  <label for="exampleInputName2">支持的操作系统：</label>
                  <div class="checkbox"><label><input checked disabled class="form-group" type="checkbox" data-bind="checked: windows"/> Windows</label></div>&nbsp;&nbsp;
                  <div class="checkbox"><label><input disabled class="form-group" type="checkbox" data-bind="checked: linux"/> Linux</label></div>&nbsp;&nbsp;
                  <div class="checkbox"><label><input disabled class="form-group" type="checkbox" data-bind="checked: aix"/> Aix</label></div>
                </div>
                <div class="table-responsive no-height" data-bind="visible: quotas().length > 0">
                  <table class="table table-striped">
                    <thead>
                      <tr>
                        <th></th>
                        <th>申请前</th>
                        <th>申请后</th>
                        <th></th>
                        <th>申请前</th>
                        <th>申请后</th>
                      </tr>
                    </thead>
                    <tbody data-bind="foreach: quotas">
	                  <tr>
	                    <td>
	                    	<span data-bind="visible: q1.type=='CPU'">CPU(个)</span>
	                    	<span data-bind="visible: q1.type=='MEMORY'">内存(GB)</span>
	                    	<span data-bind="visible: q1.type=='STORAGE'">存储(GB)</span>
	                    	<span data-bind="visible: q1.type=='VPC'">VPC(个)</span>
	                    	<span data-bind="visible: q1.type=='VM'">云主机(个)</span>
	                    	<span data-bind="visible: q1.type=='DISK'">云硬盘(个)</span>
	                    	<span data-bind="visible: q1.type=='PUBLICIP'">公网IP(个)</span>
	                    	<span data-bind="visible: q1.type=='ROUTER'">路由器(个)</span>
	                    	<span data-bind="visible: q1.type=='FIREWALL'">防火墙(个)</span>
	                    	<span data-bind="visible: q1.type=='LOAD_BALANCING'">负载均衡器(个)</span>
	                    	<span data-bind="visible: q1.type=='SECRET_KEY'">SSH密钥(对)</span>
	                    	<span data-bind="visible: q1.type=='OBJECT_STORAGE'">对象存储(GB)</span>
	                    	<span data-bind="visible: q1.type=='SECURITY_GROUP'">安全组(个)</span>
	                    	<span data-bind="visible: q1.type=='VPN'">VPN(个)</span>
	                    </td>
	                    <td>
	                    	<span data-bind="text: $root.applyChangeVdc().cpu,visible: q1.type=='CPU'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().memory,visible: q1.type=='MEMORY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().storage,visible: q1.type=='STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpc,visible: q1.type=='VPC'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vm,visible: q1.type=='VM'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().disk,visible: q1.type=='DISK'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().publicIp,visible: q1.type=='PUBLICIP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().router,visible: q1.type=='ROUTER'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().firewall,visible: q1.type=='FIREWALL'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().loadBalance,visible: q1.type=='LOAD_BALANCING'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().secretKey,visible: q1.type=='SECRET_KEY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().objectStorage,visible: q1.type=='OBJECT_STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().securityGroup,visible: q1.type=='SECURITY_GROUP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpn,visible: q1.type=='VPN'"></span>
	                    </td>
	                    <td>
	                    	<input type="text" class="form-control input-sm" data-bind="value: q1.value" data-toggle="tooltip" data-placement="right" data-trigger="focus" disabled>
	                    </td>
	                    <td>
	                    	<span data-bind="visible: q2.type=='CPU'">CPU(个)</span>
	                    	<span data-bind="visible: q2.type=='MEMORY'">内存(GB)</span>
	                    	<span data-bind="visible: q2.type=='STORAGE'">存储(GB)</span>
	                    	<span data-bind="visible: q2.type=='VPC'">VPC(个)</span>
	                    	<span data-bind="visible: q2.type=='VM'">云主机(个)</span>
	                    	<span data-bind="visible: q2.type=='DISK'">云硬盘(个)</span>
	                    	<span data-bind="visible: q2.type=='PUBLICIP'">公网IP(个)</span>
	                    	<span data-bind="visible: q2.type=='ROUTER'">路由器(个)</span>
	                    	<span data-bind="visible: q2.type=='FIREWALL'">防火墙(个)</span>
	                    	<span data-bind="visible: q2.type=='LOAD_BALANCING'">负载均衡器(个)</span>
	                    	<span data-bind="visible: q2.type=='SECRET_KEY'">SSH密钥(对)</span>
	                    	<span data-bind="visible: q2.type=='OBJECT_STORAGE'">对象存储(GB)</span>
	                    	<span data-bind="visible: q2.type=='SECURITY_GROUP'">安全组(个)</span>
	                    	<span data-bind="visible: q2.type=='VPN'">VPN(个)</span>
	                    </td>
	                    <td>
	                    	<span data-bind="text: $root.applyChangeVdc().cpu,visible: q2.type=='CPU'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().memory,visible: q2.type=='MEMORY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().storage,visible: q2.type=='STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpc,visible: q2.type=='VPC'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vm,visible: q2.type=='VM'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().disk,visible: q2.type=='DISK'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().publicIp,visible: q2.type=='PUBLICIP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().router,visible: q2.type=='ROUTER'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().firewall,visible: q2.type=='FIREWALL'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().loadBalance,visible: q2.type=='LOAD_BALANCING'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().secretKey,visible: q2.type=='SECRET_KEY'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().objectStorage,visible: q2.type=='OBJECT_STORAGE'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().securityGroup,visible: q2.type=='SECURITY_GROUP'"></span>
	                    	<span data-bind="text: $root.applyChangeVdc().vpn,visible: q2.type=='VPN'"></span>
	                    </td>
	                    <td>
	                    	<input type="text" class="form-control input-sm" data-bind="value: q2.value,visible:q2.value!=''" data-toggle="tooltip" data-placement="right" data-trigger="focus" disabled>
	                    </td>
	                  </tr>
	                </tbody>
                  </table>
                </div>
              </div>
            </div>

        </div>
    </div>


<!-- page specific plugin scripts -->
<script type="text/javascript">
  var scripts = ["api/vdc/vdc.js"]
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
	  function ViewModel(){
		  var self = this;
		  
		  this.order = ko.observable("");
	  	  this.vdc = ko.observable("");
	  	  this.resBaseInfo = ko.observable("");
	  	  this.osType = ko.observable("");
	  	  this.metaData = ko.observable("");
	  	  this.vdcQuotaList = ko.observable("");
	  	  this.expireType = ko.observable("");
	  	  this.expireValue = ko.observable("");
	  	  this.limitQuota = ko.observable("");
	  	
	  	  this.windows = ko.observable("");
	  	  this.linux = ko.observable("");
	  	  this.aix = ko.observable("");
	  	  this.quotas = ko.observable("");
	  	  
	  	  this.applyChangeVdc = ko.validatedObservable({
  	        cpu: ko.observable(""),
  	        memory: ko.observable(""),
  	        storage: ko.observable(""),
  	        vpc: ko.observable(""),
  	        vm: ko.observable(""),
  	        disk: ko.observable(""),
  	        publicIp: ko.observable(""),
  	        router: ko.observable(""),
  	        firewall: ko.observable(""),
  	        loadBalance: ko.observable(""),
  	        secretKey: ko.observable(""),
  	        objectStorage: ko.observable(""),
	  	    securityGroup: ko.observable(""),
	  	    vpn: ko.observable("")
  	      });
		  
		  this.metaVdc = ko.validatedObservable({
  	        cpu: ko.observable(""),
  	        memory: ko.observable(""),
  	        storage: ko.observable(""),
  	        vpc: ko.observable(""),
  	        vm: ko.observable(""),
  	        disk: ko.observable(""),
  	        publicIp: ko.observable(""),
  	        router: ko.observable(""),
  	        firewall: ko.observable(""),
  	        loadBalance: ko.observable(""),
  	        secretKey: ko.observable(""),
  	        objectStorage: ko.observable(""),
  	        securityGroup: ko.observable(""),
	  	    vpn: ko.observable("")
  	      });
	  	  
		  csc.rest.get('api/v5.0.0/workflows/tasks/'+args.taskId,function(data){
	   	     var processInstanceId = data.taskInfo[0].processInstanceId;
			 //获取订单数据
	      	 csc.rest.get('api/v5.0.0/orders/byFlowInstanceUuid/'+processInstanceId,function(data){
	      		var orderData = data;
	      		var itemListData = data.orderItems;
	      		var metaData = JSON.parse(itemListData[0].metaData);
	      		var resBaseInfo = JSON.parse(metaData.resBaseInfo);
	      		var osType = metaData.osType;
	      		var vdcQuotaList = resBaseInfo.vdcQuotaList;
	      		self.order(orderData);
	      		self.vdc(itemListData[0]);
	      		self.metaData(metaData);
	      		
	    		var quotas = [];
    			var quota = {};
	    		var num = 1;
	    		for(var i=vdcQuotaList.length-1;i>=0;i--){
	    			if(vdcQuotaList[i].value == ''){
	    				continue;
	    			}
	    			if(num == 1){
	    				quota.q1 = vdcQuotaList[i];
	    				num++;
	    				if(i == 0){
	    					quotas.push(quota);
	    					var q2={value:'',type:''};
	    					quota.q2 = q2;
	    				}
	    			}else{
	    				quota.q2 = vdcQuotaList[i];
	    				quotas.push(quota);
	    				quota = {};
	    				num = 1;
	    			}
	    		}
	    		self.quotas(quotas);
	    		
	      		$.VDC.getVdcQuota(itemListData[0].resourceUuid,"",function(data){
	      			var vdcQuotaList = data.results;
	      			for(var i=0;i<vdcQuotaList.length;i++){	      				
		      			if(vdcQuotaList[i].type=='CPU'){
		      				self.applyChangeVdc().cpu(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='MEMORY'){
		      				self.applyChangeVdc().memory(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='STORAGE'){
		      				self.applyChangeVdc().storage(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VPC'){
		      				self.applyChangeVdc().vpc(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VM'){
		      				self.applyChangeVdc().vm(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='DISK'){
		      				self.applyChangeVdc().disk(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='PUBLICIP'){
		      				self.applyChangeVdc().publicIp(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='ROUTER'){
		      				self.applyChangeVdc().router(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='FIREWALL'){
		      				self.applyChangeVdc().firewall(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='SECRET_KEY'){
		      				self.applyChangeVdc().secretKey(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='OBJECT_STORAGE'){
		      				self.applyChangeVdc().objectStorage(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='LOAD_BALANCING'){
		      				self.applyChangeVdc().loadBalance(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='SECURITY_GROUP'){
		      				self.applyChangeVdc().securityGroup(vdcQuotaList[i].value);
		      			}else if(vdcQuotaList[i].type=='VPN'){
		      				self.applyChangeVdc().vpn(vdcQuotaList[i].value);
		      			}
	      			}
		    	})
	      		
	      		for(var i=0;i<osType.length;i++){
	      			if(osType[i]=='windows'){
	      				self.windows(true);
	      			}else if(osType[i]=='linux'){
	      				self.linux(true);
	      			}else if(osType[i]=='aix'){
	      				self.aix(true);
	      			}
	      		}
	      		self.vdcQuotaList(vdcQuotaList);
	      		
	      	 })
		  })
		  
		  this.save = function(){
       		saveComment(args.taskId,function(){
       			alert("保存成功！");
       		});
		  }
		  
		  this.next = function(){
			if(isLast){
			  saveComment(args.taskId,function(){
				var databody = {"userId":"","action":"designated"};
				csc.rest.put('api/v5.0.0/workflows/tasks/'+args.taskId,databody,function(data){
				  alert("审核成功！");
				  location.href = "#pages/workflows/tasks?type=work";
				},function(){alert("操作失败！")});
			  });
		  	}else{		  
			  showModal("pages/workflows/next.html");
		  	}
		  }
		}
		ko.applyBindings(new ViewModel(), $('#approveContent')[0]); 
  });
</script>