  <div class="panel panel-info">
    <div class="panel-heading">申请信息</div>
    <div id="vmApplyDetailedList" class="wrapper">

          <h5 class="text-info">基本信息</h5>
          <div class='form-horizontal'>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">云主机名称</label>
              <div class="col-xs-2">
                <input type="text" class="form-control" data-bind="value: currentVO().instanceName"/>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">所属VDC</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options:currentVO().vdcList,optionsText:'name',optionsValue:'uuid',value: currentVO().vdcUuid,optionsCaption:'请选择'"></select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">可用分区</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options: currentVO().azList, optionsText: 'name', optionsValue: 'uuid',value: currentVO().azUuid,optionsCaption:'请选择'"></select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">操作系统类型</label>
              <div class="col-xs-2">
                <select class="form-control input-sm"   data-bind="options: currentVO().osTypeList, optionsText: $data, optionsValue: $data,value: currentVO().osType,optionsCaption:'请选择'">
                </select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">操作系统版本</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options: currentVO().osVersionList, optionsText: 'imageName', optionsValue: 'uuid',value: currentVO().osVersion,optionsCaption:'请选择'">
                </select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">CPU(个)</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options: currentVO().cpuList, optionsText: $data, optionsValue: $data,value: currentVO().vcpu,optionsCaption:'请选择'">
                </select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">内存(GB)</label>
              <div class="col-xs-2">
                 <select class="form-control input-sm" data-bind="options: currentVO().memoryList, optionsText: $data, optionsValue: $data,value: currentVO().memory,optionsCaption:'请选择'">
                </select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">存储(GB)</label>
              <div class="col-xs-2">
                <input type="text" class="form-control" data-bind="value: currentVO().storage"/>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">VPC/IP池</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options: currentVO().vpcList, optionsText: 'name', optionsValue: 'uuid',value: currentVO().vpcUuid,optionsCaption:'请选择'"></select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">网络名称</label>
              <div class="col-xs-2">
                <select class="form-control input-sm" data-bind="options: currentVO().privateNetworkList, optionsText: 'name', optionsValue: 'uuid',value: currentVO().network,optionsCaption:'请选择'"></select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">指定IP</label>
              <div class="col-xs-2">
                <input type="text" class="form-control" data-bind="value: currentVO().assignIp">
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
                <a href="#" class="text-info">选择</a>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">主机账号</label>
              <div class="col-xs-2">
                <input type="text" class="form-control" data-bind="value: currentVO().account">
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
              <label class="col-xs-1 control-label no-padder-h">密码</label>
              <div class="col-xs-2">
                <input type="password" class="form-control" data-bind="value: currentVO().password">
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div> 
              <label class="col-xs-1 control-label no-padder-h">重复密码</label>
              <div class="col-xs-2">
                <input type="password" class="form-control" data-bind="value: currentVO().repeatPassword">
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
            <div class="form-group">
              <div id="resource_instance_vm_add_ssh">
                <label class="col-xs-1 control-label no-padder-h">选择密钥</label>
                <div class="col-xs-2">
                  <select class="form-control input-sm" data-bind="options: currentVO().sshList, optionsText: 'name', optionsValue: 'uuid',value: currentVO().sshKey,optionsCaption:'请选择'"></select>
                </div>
                <div class="col-xs-1">
                  <span class="text-danger inline m-l-n m-t-sm"></span>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">申请时长</label>
              <div class="col-xs-10">
                <label class="radio-inline" style="padding-top: 2px">
                  <input type="radio" name="inlineRadioOptions" id="inlineRadio1" value="1"  data-bind="checked:currentVO().expireType"   > 永久
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" id="inlineRadio2" value="2"   data-bind="checked:currentVO().expireType"   style="margin-top:10px"> 
                  <input type="text" class="form-control inline w-xxs" data-bind="value:currentVO().expireType==2?currentVO().expireValue:''" >
                  <select class="form-control inline w-xs">
                    <option value="">月</option>
                  </select>  
                </label>
                <label class="radio-inline">
                  <input type="radio" name="inlineRadioOptions" id="inlineRadio3" value="3"  data-bind="checked:currentVO().expireType"  style="margin-top:10px"> 有效期至
                  <input type="text" value="" class="form-control inline w"  data-bind="value:currentVO().expireType==3?currentVO().expireValue:''"  id="vm_duration">
                </label>                                    
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-1 control-label no-padder-h">套餐</label>
              <div class="col-xs-10">
                <select class="form-control inline w-xs"  data-bind="options:currentVO().billRuleList,optionsText:'name',optionsValue:'value',value:currentVO().billRuleUuid,optionsCaption:'请选择'" >
                </select>    
               <span class="control-label col-sm-5 text-left" style="height:34px;" data-bind="text:currentVO().price"></span>                      
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>
            </div>
          </div>

          <div class="clear">
            <h5 class="text-info pull-left">挂载云硬盘</h5>
            <a href="#" class="pull-right text-info m-t-sm" data-bind="click: addMountDisks">添加硬盘</a>
          </div>
          <div class="table-responsive no-height">
              <table class="table table-striped table-hover">
                <thead>
                  <tr>
                    <th>序号</th>
                    <th>云硬盘名称<span class="text-danger">*</span></th>
                    <th>存储大小(GB)<span class="text-danger">*</span></th>
                    <th>所属服务<span class="text-danger">*</span></th>
                    <th>申请时长</th>
                    <th>套餐</th>
                    <th>收费标准</th>
                    <th>操作</th>
                  </tr>
                </thead>
                   <tbody data-bind="foreach:currentVO().mountDisks">
	                     <tr>
	                         <td><span data-bind="text: ($index()+1)"></span></td>
	                         <td><input type="text" class="form-control" data-bind="value:name"/></td>
	                         <td><input type="text" class="form-control" data-bind="value:size"/></td>
	                         <td><input type="text" data-bind="value:serviceName" disabled/> <a class="btn btn-xs btn-default" data-bind="click:$root.selectVdiskService_VM">选择</a></td>
	                         <td><span ></span></td>
	                         <td><select class="form-control w-xs" data-bind="options: billRuleList,optionsText:'name',optionsValue:'value',value:billRuleUuid,optionsCaption:'请选择'"></select></td>
	                         <td><span data-bind="text: price"></span></td>
	                         <td><a class="btn btn-xs btn-danger" data-bind="click:$root.delMountDisks">删除</a></td>
	                     </tr>
                   </tbody>
              </table>
          </div>
          
          
          <!-- 选择云服务页面 -->
		    <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: selectVdiskService }">
		      <div class='modal-dialog modal-lg' role='document'>
		        <div class='modal-content'>
		          <div class='modal-header'>
		            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>选择云硬盘服务</h3>
		          </div>
		          <div class='modal-body form-horizontal'>
		            <div class="panel panel-default table-responsive no-height" style="margin:0;margin-top:10px" data-bind="with: $root.table_Vdisk_VM">
		             <table class="table table-striped">
		               <thead>
		                 <th></th>
		                 <th>云硬盘服务名称<i style="color:red">*</i></th>
		                 <th>类型<i style="color:red">*</i></th>
		                 <th>是否收费<i style="color:red">*</i></th>
		               </thead>
		               <tbody>
		               <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
		                 <tr>
		                   <td><input type="radio" style="top:-2px;" name="optionsRadios0"  data-bind="checkedValue: $data, checked: $parent.chosenItems"></td>
		                   <td data-bind="text:serviceName"></td>
		                   <td data-bind="text:diskType">类型</td>
		                   <td data-bind="text:isFee">是/否</td>
		                 </tr>
		                 <!-- /ko -->
		               </tbody>
		             </table>
		             <footer class="panel-footer" data-bind="with: $root.table_Vdisk_VM">
		        <ul class="pagination">
		            <li data-bind="css: leftPagerClass, click: prevPage">
		              <a href="#">&laquo;</a>
		            </li>
		            <!-- ko foreach: {data: (new Array(pages()))} -->
		            <li data-bind="css: $parent.pageClass($index() + 1)">
		              <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
		            </li>
		            <!-- /ko -->
		            <li data-bind="css: rightPagerClass, click: nextPage">
		              <a href="#">&raquo;</a>
		            </li>
		        </ul>
		        </footer>
		           </div>
		           
		         </div>
		         <div class='modal-footer' style="text-align:center;">
		            <a class="btn btn-default btn-info" data-bind="click: submitVdiskService">确定添加</a>
		            <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
		          </div>
		        </div>
		      </div>
		    </div>
		    <!-- 选择云服务页面 -->

       <!--    <div class="clear">
            <h5 class="text-info pull-left">安装软件</h5>
            <a href="#" class="pull-right text-info m-t-sm">添加软件</a>
          </div>
          <div class="table-responsive no-height">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>软件名称</th>
                  <th>软件分类</th>
                  <th>软件类型</th>
                  <th>软件版本</th>
                  <th>静默安装属性</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>oracle</td>
                  <td>数据库</td>
                  <td>oracle</td>
                  <td>10g企业版</td>
                  <td>
                    <a class="expand-btn">查看 <i class="fa fa-angle-double-right"></i></a> |
                    <a class="expand-btn">修改 <i class="fa fa-angle-double-right"></i></a>
                  </td>
                  <td><a href="#">删除</a></td>
                </tr>
                <tr style="display: none">
                    <td colspan="7" class="no-padder">
                      <div class="b wrapper-sm">
                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>静默安装属性</h5>
                        <div class="form-horizontal">
                          <div class="form-group">
                            <label class="col-xs-1 control-label">参数名称</label>
                            <div class="col-xs-3">
                              <input class="form-control" type="text" value="test1">
                            </div>
                            <label class="col-xs-1 control-label">参数代码</label>
                            <div class="col-xs-3">
                              <input class="form-control" type="text" value="test1">
                            </div>
                            <label class="col-xs-1 control-label">默认值</label>
                            <div class="col-xs-3">
                              <input class="form-control" type="text" value="test1">
                            </div>
                          </div>                        
                        </div>
                        <div class="wrapper-sm text-center"><button class="btn btn-sm btn-info">保存</button></div>
                      </div>                    
                    </td>
                </tr>                
              </tbody>
            </table>            
          </div>

          <div class="clear">
            <h5 class="text-info pull-left">系统盘分区</h5>
            <a href="#" class="pull-right text-info m-t-sm">添加分区</a>
          </div>
          <div class="table-responsive no-height">
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>分区名称</th>
                  <th>分区大小</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>NFS</td>
                  <td>100G</td>
                  <td><a href="#">修改</a> | <a href="#">删除</a></td>
                </tr>
              </tbody>
            </table>            
          </div> -->

          <h5 class="text-info">高级选项</h5>
          <div class="form-horizontal">
            <div class="form-group">
              <label class="col-xs-2 control-label">所属业务系统</label>
              <div class="col-xs-5">
                <select class="form-control"  data-bind="options:currentVO().bussyList,optionsText:'name',optionsValue:'uuid',value:currentVO().busSysUuid,optionsCaption:'请选择'">
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-2 control-label">备注</label>
              <div class="col-xs-5">
                <textarea cols="5" rows="5" class="form-control"></textarea>
              </div>
            </div>            
          </div>

    </div>

<script type="text/javascript">
  var scripts = [null, "assets/lib/moment/moment.js","assets/lib/bootstrap-daterangepicker/daterangepicker.js", null];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
	  
	  function ViewModel(){
	      var self = this;
	      this.currentVO = ko.validatedObservable({
	        id: ko.observable(),
	        instanceName: ko.observable("").extend({required: true}),
	        vdcId: ko.observable("").extend({required: true}),
	        partition: ko.observable().extend({required: true}),
	        systemType: ko.observable("").extend({required: true}),
	        systemVersion: ko.observable("").extend({required: true}),
	        vcpu: ko.observable("").extend({required: true}),
	        memory: ko.observable("").extend({required: true}),
	        storage: ko.observable("").extend({required: true}),
	        ipPool: ko.observable("").extend({required: true}),
	        network: ko.observable("").extend({required: true}),
	        assignIp: ko.observable("").extend({required: true}),
	        account: ko.observable("").extend({required: true}),
	        password: ko.observable("").extend({required: true}),
	        repeatPassword: ko.observable("").extend({required: true}),
	        isBind: ko.observable("").extend({required: true}),
	        sshKey: ko.observable("").extend({required: true}),
	        expireType:ko.observable(""),
	        expireValue:ko.observable(""),
	        expireText:ko.observable(""),
	        busSysUuid:ko.observable(""),
	        //分区
            partitions: ko.observableArray([]),
            //硬盘
            mountDisks : ko.observableArray([]),
            
            softwares : ko.observableArray([]),
            vdcList:ko.observableArray([]),
            azList:ko.observableArray([]),
            osTypeList:ko.observableArray([]),
            osVersionList:ko.observableArray([]),
            cpuList:ko.observableArray([]),
            memoryList:ko.observableArray([]),
            vpcList:ko.observableArray([]),
            privateNetworkList:ko.observableArray([]),
            bussyList:ko.observableArray([]),
            sshList:ko.observableArray([]),
            billRuleList:ko.observableArray([])
	      });
	      
		  
		  
	      this.addMountDisks = function(){
              self.currentVO().mountDisks.push(new MountDiskVO());
          }
          this.delMountDisks = function (object){
              self.currentVO().mountDisks.remove(object);
          }
          
          this.submitVdiskService = function(){
             /*  editObject.serviceName(self.table_Vdisk_VM.chosenItems().serviceName);
              editObject.serviceUuid(self.table_Vdisk_VM.chosenItems().serviceUuid);
              var attr;
              if(self.table_Vdisk_VM.chosenItems().feeType !=null && self.table_Vdisk_VM.chosenItems().feeType!=""){
              	attr=self.table_Vdisk_VM.chosenItems().feeType.split(",")
              }
              editObject.billRuleList(setArrayCharge(attr)); */
              self.selectVdiskService(false);
          }
          
	      function MountDiskVO(){
              this.name = ko.observable();
              this.size = ko.observable();
              this.type = ko.observable();
              this.serviceUuid = ko.observable();
              this.serviceName = ko.observable();
              this.billRuleUuid = ko.observable();
              this.applyType = ko.observable();
              this.applyNum = ko.observable();
              this.applyTime = ko.observable();
              this.applyText = ko.observable();
              this.billRuleList=ko.observableArray([]);
              this.price = ko.observable();
          }
	      
	      function setArrayCharge(attr){
  	    	var arrayCharge = [];
  	    	if(attr !=null){
  	    		for(var i=0;i<attr.length;i++){
      	    		if(attr[i]=="DAY"){
      	    			arrayCharge.push({name:"按天",value:"DAY"});
      	    		}else if(attr[i]=="MONTH"){
      	    			arrayCharge.push({name:"按月",value:"MONTH"});
      	    		}else if(attr[i]=="QUARTER"){
      	    			arrayCharge.push({name:"按季度",value:"QUARTER"});
      	    		}else{
      	    			arrayCharge.push({name:"按年",value:"YEAR"});
      	    		}
      	    	}
  	    	}
  	    	return arrayCharge;
  	    }
		  
		  var  inParamData = {"resourceType":"VM","orderItems":[
		                                                        {"instanceName":"d01","serviceUuid":"6d1dd0c2-7fcd-4e11-8f44-9a2e9cae58c0","isBill":"false","expireType":"2","expireValue":"3","billcycle":"DAY","fee":"1110元/天","metaData":"{\"resBaseInfo\":{\"volumeSize\":\"10\"}}","resourceType":"DISK","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"},
		                                                        {"instanceName":"d02","serviceUuid":"ea312741-014f-4080-af58-6d0eb1c45cfc","isBill":"false","expireType":"2","expireValue":"3","billcycle":"MONTH","fee":"2000元/月","metaData":"{\"resBaseInfo\":{\"volumeSize\":\"20\"}}","resourceType":"DISK","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"},
		                                                        {"instanceName":"xxx","serviceUuid":"8507c5d1-76c7-4e08-8a57-55e6b0375bc2","isBill":"false","expireType":"3","expireValue":"2016-08-09","billcycle":"DAY","fee":"52元/天","metaData":"{\"resBaseInfo\":{\"azUuid\":\"000eb1c8-ac92-4b39-96cc-b2dc19f2c4b7\",\"osType\":\"linux\",\"osVersion\":\"8c0b816e-3448-473a-854f-0c13315e0719\",\"memory\":\"8\",\"name\":\"xxx\",\"storage\":\"10\",\"vcpu\":\"8\",\"vdcUuid\":\"3b8a7d11-02e3-4e44-bb71-1e7f2fb36ecf\",\"vpcUuid\":\"d50125e6-9d32-4e02-941c-fbbf4688ee0f\",\"partitionList\":[{}],\"networkList\":[],\"ip\":\"10.10.10.10\",\"account\":\"a\",\"password\":\"b\",\"repeatPassword\":\"b\",\"sshIsMount\":\"NO\",\"busSysUuid\":\"ed81da58-e30d-4395-b089-857cf1890a44\"}}","desc":"tset","azUuid":"000eb1c8-ac92-4b39-96cc-b2dc19f2c4b7","resourceType":"VM","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"}]}

		  //选择云硬盘服务
          this.selectVdiskService = ko.observable(false);
          this.table_Vdisk_VM = null;
          this.selectVdiskService_VM = function(object){
              self.table_Vdisk_VM = new DataTable([], {path: 'api/v5.0.0/service/getServiceList/DISK',perPage:6});
              self.selectVdiskService(true);
             // editObject = object;
          } 
		  
		  var vmOrderItems = [];
		  var diskOrderItems= [];
		  for(var i=0;i<inParamData.orderItems.length;i++){
			  var orderItem = inParamData.orderItems[i];
			  if(orderItem.resourceType == "VM"){
				  vmOrderItems.push(orderItem);
			  }else if(orderItem.resourceType == "DISK"){
				  diskOrderItems.push(orderItem);
			  }
		  }
		  
		  var vmOrderItemVO = vmOrderItems[0];
		  var serviceUuid=vmOrderItemVO.serviceUuid;
		  var metaData = JSON.parse(vmOrderItemVO.metaData);
		  var vmInParamData = metaData.resBaseInfo;
          var vdcUuid=vmInParamData.vdcUuid;
          var azUuid=vmInParamData.azUuid;
          var vpcUuid=vmInParamData.vpcUuid;
          var osType=vmInParamData.osType;
          var uri="serviceUuid="+serviceUuid+"&vdcUuid="+vdcUuid+"&azUuid="+azUuid+"&vpcUuid="+vpcUuid+"&osType="+osType;
          csc.rest.get("api/v5.0.0/cart/getCartSelectList?"+uri, function(result){
             csc.rest.get("api/v5.0.0/bussys?vdcuuid="+vdcUuid,function(result2){
                 csc.rest.get("api/v5.0.0/sshKeys?getList=true&azUuid="+azUuid+"&vcdUuid="+vdcUuid+"&userUuid=",function(result3){
                	 console.log("********************###################")
                	 console.log(result)
                	 console.log(result2)
                	 console.log(result3)
                	 console.log("********************###################")
                	  
                    self.currentVO().sshList(result3.results);
                    self.currentVO().bussyList(result2.results); 
                    self.currentVO().vdcList(result.vdcList);
                    self.currentVO().vpcList(result.vpcList);
                    self.currentVO().privateNetworkList(result.networkList);
                    self.currentVO().azList(result.azList);
                    self.currentVO().osTypeList(result.osTypeList);
                    self.currentVO().cpuList(result.cpuList);
                    self.currentVO().memoryList(result.memoryList);
                    self.currentVO().osVersionList(result.osVersionList);
                    self.currentVO.fromJSON(vmInParamData);
                    self.currentVO.fromJSON({
                    	instanceName:vmOrderItemVO.instanceName,
                    	expireType:vmOrderItemVO.expireType,
                    	expireValue:vmOrderItemVO.expireValue
                    });
                    console.log("currentVO",self.currentVO.toJSON())
                   
                    diskOrderItems.forEach(function(e){
                    	var metaDataJson = JSON.parse(e.metaData);
                    	var diskData = metaDataJson.resBaseInfo;
                    	
                    	
                    	
                        csc.rest.get("api/v5.0.0/cart/getCartSelectList?serviceUuid="+e.serviceUuid, function(res){
                        	var vo=new MountDiskVO();
                        	vo.name(e.instanceName);
                            vo.size(diskData.volumeSize);
                            vo.serviceUuid(e.serviceUuid);
                            vo.serviceName(e.serviceName);
                            vo.billRuleUuid(e.billcycle);
                            vo.billRuleList(setArrayCharge(res.chargeList));
                            vo.price(e.price);
                            self.currentVO().mountDisks.push(vo);
                        });
                    });
                    
                    console.log(self.currentVO.toJSON())
                    
                    var v="";
                    if("1"==vmOrderItemVO.expireType){
                        v="永久";
                    }else if("2"==vmOrderItemVO.expireType){
                        v=vmOrderItemVO.expireValue+"个月";
                    }else if("3"==vmOrderItemVO.expireType){
                        v= "有效期至:"+vmOrderItemVO.expireValue.substr(0,10); 
                    }
                    self.currentVO().expireText(v);
                    self.currentVO().billRuleList(setArrayCharge(result.chargeList));
                   
                 
                   
                 });                             
             });
         });
	  
		  
	   }
	  ko.applyBindings(new ViewModel(), $('#vmApplyDetailedList')[0]);


          // daterange             
          $('#vm_duration').val(moment().subtract('days', 29).format('YYYY/MM/DD') + ' 至 ' + moment().format('YYYY/MM/DD')).daterangepicker(
            {
              singleDatePicker:true,
              format:'YYYY/MM/DD',
              startDate: moment().subtract('days', 29),
              endDate: moment(),
              separator:'至',
              locale:{
                applyLabel: '确认',
                cancelLabel: '取消',
                fromLabel: '开始日期',
                toLabel: '结束日期',
                weekLabel: '周',
                customRangeLabel: '自定义范围',                            
                daysOfWeek:["日","一","二","三","四","五","六"],
                monthNames:['01月','02月','03月','04月','05月','06月','07月','08月','09月','10月','11月','12月',]
              },
              ranges: {
               '当天': [moment(), moment()],
               '昨天': [moment().subtract('days', 1), moment().subtract('days', 1)],
               '近7天': [moment().subtract('days', 6), moment()],
               '近30天': [moment().subtract('days', 29), moment()],
               '当月': [moment().startOf('month'), moment().endOf('month')],
               '上月': [moment().subtract('month', 1).startOf('month'), moment().subtract('month', 1).endOf('month')]
              }
            }

          ); 

    
        $(".expand-btn").click(function(){
          $(this).find('i').toggleClass("fa-angle-double-down");
          $(this).parents('tr').next("tr").toggle();
        });


  })
</script>