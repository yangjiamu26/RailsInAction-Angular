
<div class="b wrapper-sm sub-detail">
	<h5>
		<i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息
	</h5>
	<div class="bg-light b-t b-b wrapper-sm">
		<div class="row m-b">
			<div class="col-xs-1 font-bold">云主机名称：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_name"></span>
			</div>
			<div class="col-xs-1 font-bold">所属VDC：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_vdcName"></span>
			</div>
			<div class="col-xs-1 font-bold">可用分区：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_azName"></span>
			</div>
		</div>
		<div class="row m-b">
			<div class="col-xs-1 font-bold">操作系统类型：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_osType"></span>
			</div>
			<div class="col-xs-1 font-bold">操作系统版本：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_osVersion"></span>
			</div>
			<div class="col-xs-1 font-bold">CPU(个)：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_cpu"></span>
			</div>
		</div>
		<div class="row m-b">
			<div class="col-xs-1 font-bold">内存(GB)：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_memory"></span>
			</div>
			<div class="col-xs-1 font-bold">存储(GB)：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_storage"></span>
			</div>
			<div class="col-xs-1 font-bold">VPC/IP池：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_vpcName"></span>
			</div>
		</div>
		<div class="row m-b">
			<div class="col-xs-1 font-bold">网络名称：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_networkName"></span>
			</div>
			<div class="col-xs-1 font-bold">指定IP：</div>
			<div class="col-xs-3">
				<span  id="vmapply_detail_assignIp"></span>
			</div>
			<div class="col-xs-1 font-bold">主机账号：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_account"></span>
			</div>
		</div>
		<div class="row m-b">
			<div class="col-xs-1 font-bold">选择密钥：</div>
			<div class="col-xs-3">
				<span  id="vmapply_detail_sshkey"></span>
			</div>
			<div class="col-xs-1 font-bold">申请时长：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_expireText"></span>
			</div>
		</div>
		<div class="row m-b">
			<div class="col-xs-1 font-bold">套餐：</div>
			<div class="col-xs-3">
				<span id="vmapply_detail_billcycleText"></span>
			</div>
			<div class="col-xs-1 font-bold">费用：</div>
			<div class="col-xs-3">
				<span  id="vmapply_detail_fee"></span>
			</div>
		</div>
	</div>

	<!-- <h5>
		<i class="fa fa-minus fa-rotate-90 text-info"></i>高级选项
	</h5>
	<div class="bg-light b-t b-b wrapper-sm">
		<div class="row m-b">
			<div class="col-xs-1">所属业务系统：</div>
			<div class="col-xs-3">15137</div>
			<div class="col-xs-1">备注：</div>
			<div class="col-xs-7">abc</div>
		</div>
	</div> -->
</div>
<script type="text/javascript">
    var scripts = [null,null];
    $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    	 var vmOrderDetail =  $('#approveContent').data("vmOrderDetail");
    	 $('#approveContent').data("vmOrderDetail",null);//清理数据
    	 var taskId = args.taskId;
    	 csc.rest.get('api/v5.0.0/workflows/tasks/'+args.taskId,function(data){
 	   	     var processInstanceId = data.taskInfo[0].processInstanceId;   //获取订单数据
 	      	 csc.rest.get('api/v5.0.0/orders/byFlowInstanceUuid/'+processInstanceId,function(orderData){
 	      	  var vmOrderItems = [];
       		  var diskOrderItems= [];
       		  for(var i=0;i<orderData.orderItems.length;i++){
       			  var orderItem = orderData.orderItems[i];
       			  if(orderItem.resourceType == "VM"){
       				  vmOrderItems.push(orderItem);
       			  }else if(orderItem.resourceType == "DISK"){
       				  diskOrderItems.push(orderItem);
       			  }
       		  }
       		  var vmOrderItemVO = vmOrderItems[0];
       		  var serviceUuid=vmOrderItemVO.serviceUuid;
       		  var metaData = JSON.parse(vmOrderItemVO.metaData);
       		  var vmInParamData = JSON.parse(metaData.resBaseInfo);
              var vdcUuid=vmInParamData.vdcUuid;
              var azUuid=vmInParamData.azUuid;
              var vpcUuid=vmInParamData.vpcUuid;
              var osType=vmInParamData.osType;
              var osVersionUuid = vmInParamData.osVersion;
              var networks = vmInParamData.networkList;
              var selelctNetworkUuid = networks[0]?networks[0].networkId:"";
                 var callbackParam = {};
                 callbackParam.vmOrderItemVO = vmOrderItemVO;
                 var uri="serviceUuid="+serviceUuid+"&vdcUuid="+vdcUuid+"&azUuid="+azUuid+"&vpcUuid="+vpcUuid+"&osType="+osType;
                 csc.rest.get("api/v5.0.0/cart/getCartSelectList?"+uri, function(result,textStatus,callbackCustParam){
                    csc.rest.get("api/v5.0.0/bussys?vdcuuid="+vdcUuid,function(result2,textStatus,callbackCustParam){
                        csc.rest.get("api/v5.0.0/sshKeys?getList=true&azUuid="+azUuid+"&vcdUuid="+vdcUuid+"&userUuid=",function(result3,textStatus,callbackCustParam){
                       	 
                     	 var vmOrderItemVO = callbackParam.vmOrderItemVO;
                       	  
                           var vdcList = result.vdcList;
                           for(var i=0;i<vdcList.length;i++){
                         	  var vdcVO = vdcList[i];
                         	  if(vdcUuid == vdcVO.uuid){
                         		  vmOrderItemVO.vdcName = vdcVO.name;
                         		  break;
                         	  }
                           }
                         
                           var vpcList = result.vpcList;
                           for(var i=0;i<vpcList.length;i++){
                         	  var vpcVO = vpcList[i];
                         	  if(vpcUuid == vpcVO.uuid){
                         		  vmOrderItemVO.vpcName = vpcVO.name;
                         		  break;
                         	  }
                           }
                           
                           
                           var networkList = result.networkList;
                           for(var i=0;i<networkList.length;i++){
                         	  var networkVO = networkList[i];
                         	  if(selelctNetworkUuid == networkVO.uuid){
                         		  vmOrderItemVO.networkName = networkVO.name;
                         		  vmOrderItemVO.networkUuid = networkVO.uuid;
                         		  break;
                         	  }
                           }
                           
                           
                           var azList = result.azList;
                           for(var i=0;i<azList.length;i++){
                         	  var azVO = azList[i];
                         	  if(azUuid == azVO.uuid){
                         		  vmOrderItemVO.azName = azVO.name;
                         		  break;
                         	  }
                           }
                           
                           var osVersionList = result.osVersionList;
                           for(var i=0;i<osVersionList.length;i++){
                         	  var osVersionVO = osVersionList[i];
                         	  if(osVersionUuid == osVersionVO.uuid){
                         		  vmOrderItemVO.osVersionName = osVersionVO.opSysVersion;
                         		  break;
                         	  }
                           }
                           
                            
                           var v="";
                           if("1"==vmOrderItemVO.expireType){
                               v="永久";
                           }else if("2"==vmOrderItemVO.expireType){
                               v=vmOrderItemVO.expireValue+"个月";
                           }else if("3"==vmOrderItemVO.expireType){
                               v= "有效期至:"+vmOrderItemVO.expireValue.substr(0,10); 
                           }
                           vmOrderItemVO.expireText = v;
                           
                           $("#vmapply_detail_name").html(vmOrderItemVO.instanceName);
                           $("#vmapply_detail_vdcName").html(vmOrderItemVO.vdcName);
                           $("#vmapply_detail_azName").html(vmOrderItemVO.azName);
                           $("#vmapply_detail_osType").html(vmInParamData.osType);
                           $("#vmapply_detail_osVersion").html(vmOrderItemVO.osVersionName);
                           $("#vmapply_detail_cpu").html(vmInParamData.vcpu);
                           $("#vmapply_detail_memory").html(vmInParamData.memory);
                           $("#vmapply_detail_storage").html(vmInParamData.storage);
                           $("#vmapply_detail_vpcName").html(vmOrderItemVO.vpcName);
                           $("#vmapply_detail_networkName").html(vmOrderItemVO.networkName);
                           $("#vmapply_detail_assignIp").html(vmInParamData.ip);
                           $("#vmapply_detail_account").html(vmInParamData.account);
                           $("#vmapply_detail_sshkey").html(vmInParamData.sshKeyName);
                           $("#vmapply_detail_expireText").html(vmOrderItemVO.expireText);
                           $("#vmapply_detail_billcycleText").html(getBillTxt(vmOrderItemVO.billCycle));
                           $("#vmapply_detail_fee").html(vmOrderItemVO.fee);
                          
                           
                           function getBillTxt(billcycle){
                               var billTxt = "";
	   	                        if(billcycle=="DAY"){
	   	                           	billTxt = "按天"
	   	           	    		}else if(billcycle=="MONTH"){
	   	           	    			billTxt = "按月"
	   	           	    		}else if(billcycle =="QUARTER"){
	   	           	    			billTxt = "按季度"
	   	           	    		}else if(billcycle =="YEAR"){
	   	           	    			billTxt = "按年"
	   	           	    		}
	   	           	    		return billTxt;
       	                  }
                           
                        },function(){},callbackParam);                             
                    },function(){},callbackParam);
                },function(){},callbackParam);
 	      		 
 	      		 
 	      		 
 	      	 });
    	  });
    });
 </script>