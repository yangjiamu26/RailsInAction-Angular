<div class="panel panel-info">
        <div class="panel-heading">申请信息</div>
                   <div class="b wrapper-sm sub-detail" >

                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息</h5>
                        <div class="bg-light b-t b-b wrapper-sm">
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">云主机名称：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().instanceName"></span></div>
                            <div class="col-xs-1 font-bold">所属VDC：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().vdcName"></span></div>
                            <div class="col-xs-1 font-bold">可用分区：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().azName"></span></div>
                          </div>
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">操作系统类型：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().osType"></span></div>
                            <div class="col-xs-1 font-bold">操作系统版本：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().osVersionName"></span></div>
                            <div class="col-xs-1 font-bold">CPU(个)：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().vcpu"></span></div>
                          </div>
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">内存(GB)：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().memory"></span></div>
                            <div class="col-xs-1 font-bold">存储(GB)：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().storage"></span></div>
                            <div class="col-xs-1 font-bold">VPC/IP池：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().vpcName"></span></div>
                          </div>
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">网络名称：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().networkName"></span></div>
                            <div class="col-xs-1 font-bold">指定IP：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().assignIp"></span></div>
                            <div class="col-xs-1 font-bold">主机账号：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().account"></span></div>
                          </div>
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">选择密钥：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().sshKey"></span></div>
                            <div class="col-xs-1 font-bold">申请时长：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().expireText"></span></div>
                          </div>
                          <div class="row m-b">
                            <div class="col-xs-1 font-bold">套餐：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().billcycleText"></span></div>
                            <div class="col-xs-1 font-bold">费用：</div>
                            <div class="col-xs-3"><span data-bind="text: currentVO().fee"></span></div>
                          </div>
                        </div>            

                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>挂载云硬盘</h5>
                        <div class="table-responsive no-height">
                            <table class="table table-striped table-hover">
                              <thead>
                                <tr>
                                  <th>序号</th>
                                  <th>云硬盘名称</th>
                                  <th>存储大小(GB)</th>
                                  <th>所属服务</th>
                                  <th>申请时长</th>
                                  <th>套餐</th>
                                  <th>收费标准</th>
                                </tr>
                              </thead>
                                   <tbody data-bind="foreach:currentVO().mountDisks">
				                     <tr>
				                         <td><span data-bind="text: ($index()+1)"></span></td>
				                         <td><span data-bind="text:name"></span></td>
				                         <td><span data-bind="text:size"></span></td>
				                         <td><span data-bind="text:serviceName"></span></td>
				                         <td><span data-bind="text:$root.currentVO().expireText" ></span></td>
				                         <td><span data-bind="text:billRuleText"></span></td>
				                         <td><span data-bind="text: fee"></span></td>
				                     </tr>
                              </tbody>
                            </table>
                        </div>    

                        <!-- <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>安装软件</h5>
                        <div class="table-responsive no-height">
                          <table class="table table-striped table-hover">
                            <thead>
                              <tr>
                                <th>软件名称</th>
                                <th>软件分类</th>
                                <th>软件类型</th>
                                <th>软件版本</th>
                                <th>静默安装属性</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <td>oracle</td>
                                <td>数据库</td>
                                <td>oracle</td>
                                <td>10g企业版</td>
                                <td>
                                  <a class="expand-btn-detail">查看 <i class="fa fa-angle-double-right"></i></a>
                                </td>
                              </tr>
                              <tr style="display: none">
                                  <td colspan="7" class="no-padder">
                                    <div class="wrapper-sm sub-detail" style="display: none">
                                      <h5 class="text-info">静默安装属性</h5>
                                      <div class="bg-light b-t b-b wrapper-sm">
                                        <div class="row m-b">
                                          <div class="col-xs-1">参数名称：</div>
                                          <div class="col-xs-3">15137</div>
                                          <div class="col-xs-1">参数代码：</div>
                                          <div class="col-xs-3">abc</div>
                                          <div class="col-xs-1">默认值：</div>
                                          <div class="col-xs-3">000</div>
                                        </div>
                                      </div>                                      
                                    </div>                    
                                  </td>
                              </tr>                
                            </tbody>
                          </table>            
                        </div>          

                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>系统盘分区</h5>
                        <table class="table table-striped table-hover">
                          <thead>
                            <tr>
                              <th>分区名称</th>
                              <th>分区大小</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td>NFS</td>
                              <td>100G</td>
                            </tr>
                          </tbody>
                        </table>  -->

                        <h5><i class="fa fa-minus fa-rotate-90 text-info"></i>高级选项</h5>
                        <div class="bg-light b-t b-b wrapper-sm">
                          <div class="row m-b">
                            <div class="col-xs-1">所属业务系统：</div>
                            <div class="col-xs-3">15137</div>
                            <div class="col-xs-1">备注：</div>
                            <div class="col-xs-7">abc</div>
                          </div>
                        </div> 

                      </div>
     </div>                 
                      
<script type="text/javascript">
    var scripts = [null,null];
    $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    	  csc.rest.get('api/v5.0.0/workflows/tasks/'+args.taskId,function(data){
    	   	     var processInstanceId = data.taskInfo[0].processInstanceId;
    	   	     //获取订单数据
    	      	 csc.rest.get('api/v5.0.0/orders/byFlowInstanceUuid/'+processInstanceId,function(orderData){
    	      		console.log(orderData);
    	      		
    	      	  function ViewModel(){
    	      	      var self = this;
    	      	      this.currentVO = ko.validatedObservable({
    	      	        id: ko.observable(),
    	      	        instanceName: ko.observable(""),
    	      	        vdcId: ko.observable(""),
    	      	        vdcName:ko.observable(""),
    	      	        azName:ko.observable(""),
    	      	        vpcName:ko.observable(""),
    	      	        partition: ko.observable(),
    	      	        osType: ko.observable(""),
    	      	        osVersion: ko.observable(""),
    	      	        osVersionName: ko.observable(""),
    	      	        vcpu: ko.observable(""),
    	      	        memory: ko.observable(""),
    	      	        storage: ko.observable(""),
    	      	        ipPool: ko.observable(""),
    	      	        network: ko.observable(""),
    	      	        networkName: ko.observable(""),
    	      	        assignIp: ko.observable(""),
    	      	        account: ko.observable(""),
    	      	        password: ko.observable(""),
    	      	        repeatPassword: ko.observable(""),
    	      	        isBind: ko.observable(""),
    	      	        sshKey: ko.observable(""),
    	      	        billcycle:ko.observable(""),
    	      	        billcycleText:ko.observable(""),
	    	            fee:ko.observable(""),
    	      	        expireType:ko.observable(""),
    	      	        expireValue:ko.observable(""),
    	      	        expireText:ko.observable(""),
    	      	        busSysUuid:ko.observable(""),
    	     	          //分区
    	                 partitions: ko.observableArray([]),
    	                 //硬盘
    	                 mountDisks : ko.observableArray([]),
    	                 
    	                 softwares : ko.observableArray([]),
    	                 vdcList:ko.observableArray([]),
    	                 azList:ko.observableArray([]),
    	                 osTypeList:ko.observableArray([]),
    	                 osVersionList:ko.observableArray([]),
    	                 cpuList:ko.observableArray([]),
    	                 memoryList:ko.observableArray([]),
    	                 vpcList:ko.observableArray([]),
    	                 privateNetworkList:ko.observableArray([]),
    	                 bussyList:ko.observableArray([]),
    	                 sshList:ko.observableArray([]),
    	                 billRuleList:ko.observableArray([])
    	      	      });
    	      	      
    	      		  
    	      	      function MountDiskVO(){
    	                    this.name = ko.observable();
    	                    this.size = ko.observable();
    	                    this.type = ko.observable();
    	                    this.serviceUuid = ko.observable();
    	                    this.serviceName = ko.observable();
    	                    this.billRuleUuid = ko.observable();
    	                    this.billRuleText = ko.observable();
    	                    this.applyType = ko.observable();
    	                    this.applyNum = ko.observable();
    	                    this.applyTime = ko.observable();
    	                    this.applyText = ko.observable();
    	                    this.billRuleList=ko.observableArray([]);
    	                    this.fee = ko.observable();
    	                    this.vdcName = ko.observable();
    	                    this.azName = ko.observable();
    	                    this.vpcName = ko.observable();
    	                    this.vmName = ko.observable();
    	              }
    	      	      
    	      	       function getBillTxt(billcycle){
                            var billTxt = "";
	                        if(billcycle=="DAY"){
	                           	billTxt = "按天"
	           	    		}else if(billcycle=="MONTH"){
	           	    			billTxt = "按月"
	           	    		}else if(billcycle =="QUARTER"){
	           	    			billTxt = "按季度"
	           	    		}else{
	           	    			billTxt = "按年"
	           	    		}
	           	    		return billTxt;
    	              }
    	      	      
    	      	      function setArrayCharge(attr){
    	        	    	var arrayCharge = [];
    	        	    	if(attr !=null){
    	        	    		for(var i=0;i<attr.length;i++){
    	            	    		if(attr[i]=="DAY"){
    	            	    			arrayCharge.push({name:"按天",value:"DAY"});
    	            	    		}else if(attr[i]=="MONTH"){
    	            	    			arrayCharge.push({name:"按月",value:"MONTH"});
    	            	    		}else if(attr[i]=="QUARTER"){
    	            	    			arrayCharge.push({name:"按季度",value:"QUARTER"});
    	            	    		}else{
    	            	    			arrayCharge.push({name:"按年",value:"YEAR"});
    	            	    		}
    	            	    	}
    	        	    	}
    	        	    	return arrayCharge;
    	        	    }
    	      		  
    	      		 /* test data var  inParamData = {"resourceType":"VM","orderItems":[
    	      		                                                        {"instanceName":"d01","serviceUuid":"6d1dd0c2-7fcd-4e11-8f44-9a2e9cae58c0","isBill":"false","expireType":"2","expireValue":"3","billcycle":"DAY","fee":"1110元/天","metaData":"{\"resBaseInfo\":{\"volumeSize\":\"10\"}}","resourceType":"DISK","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"},
    	      		                                                        {"instanceName":"d02","serviceUuid":"ea312741-014f-4080-af58-6d0eb1c45cfc","isBill":"false","expireType":"2","expireValue":"3","billcycle":"MONTH","fee":"2000元/月","metaData":"{\"resBaseInfo\":{\"volumeSize\":\"20\"}}","resourceType":"DISK","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"},
    	      		                                                        {"instanceName":"xxx","serviceUuid":"8507c5d1-76c7-4e08-8a57-55e6b0375bc2","isBill":"false","expireType":"3","expireValue":"2016-08-09","billcycle":"DAY","fee":"52元/天","metaData":"{\"resBaseInfo\":{\"azUuid\":\"000eb1c8-ac92-4b39-96cc-b2dc19f2c4b7\",\"osType\":\"linux\",\"osVersion\":\"8c0b816e-3448-473a-854f-0c13315e0719\",\"memory\":\"8\",\"name\":\"xxx\",\"storage\":\"10\",\"vcpu\":\"8\",\"vdcUuid\":\"3b8a7d11-02e3-4e44-bb71-1e7f2fb36ecf\",\"vpcUuid\":\"d50125e6-9d32-4e02-941c-fbbf4688ee0f\",\"partitionList\":[{}],\"networkList\":[{\"networkId\":\"437f6417-0483-4418-b0f1-62d4c6ef4d3d\"}],\"ip\":\"10.10.10.10\",\"account\":\"a\",\"password\":\"b\",\"repeatPassword\":\"b\",\"sshIsMount\":\"NO\",\"busSysUuid\":\"ed81da58-e30d-4395-b089-857cf1890a44\"}}","desc":"tset","azUuid":"000eb1c8-ac92-4b39-96cc-b2dc19f2c4b7","resourceType":"VM","relateUuid":"99924abf-4b9e-4815-8c6c-d182061a3e07"}]}
 */
    	      		  var vmOrderItems = [];
    	      		  var diskOrderItems= [];
    	      		  for(var i=0;i<orderData.orderItems.length;i++){
    	      			  var orderItem = orderData.orderItems[i];
    	      			  if(orderItem.resourceType == "VM"){
    	      				  vmOrderItems.push(orderItem);
    	      			  }else if(orderItem.resourceType == "DISK"){
    	      				  diskOrderItems.push(orderItem);
    	      			  }
    	      		  }
    	      		 
    	      		    var vmOrderItemVO = vmOrderItems[0];
    	      		    var serviceUuid=vmOrderItemVO.serviceUuid;
    	      		    var metaData = JSON.parse(vmOrderItemVO.metaData);
    	      		    var vmInParamData = JSON.parse(metaData.resBaseInfo);
    	                var vdcUuid=vmInParamData.vdcUuid;
    	                var azUuid=vmInParamData.azUuid;
    	                var vpcUuid=vmInParamData.vpcUuid;
    	                var osType=vmInParamData.osType;
    	                var osVersionUuid = vmInParamData.osVersion;
    	                var networks = vmInParamData.networkList;
    	                var selelctNetworkUuid = networks[0]?networks[0].networkId:"";
    	                var uri="serviceUuid="+serviceUuid+"&vdcUuid="+vdcUuid+"&azUuid="+azUuid+"&vpcUuid="+vpcUuid+"&osType="+osType;
    	                csc.rest.get("api/v5.0.0/cart/getCartSelectList?"+uri, function(result){
    	                   csc.rest.get("api/v5.0.0/bussys?vdcuuid="+vdcUuid,function(result2){
    	                       csc.rest.get("api/v5.0.0/sshKeys?getList=true&azUuid="+azUuid+"&vcdUuid="+vdcUuid+"&userUuid=",function(result3){
    	                      	 console.log("********************###################")
    	                      	 console.log(result)
    	                      	 console.log(result2)
    	                      	 console.log(result3)
    	                      	 console.log("********************###################")
    	                      	  
    	                          self.currentVO().sshList(result3.results);
    	                          self.currentVO().bussyList(result2.results); 
    	                          var vdcList = result.vdcList;
    	                          var vdcName;
    	                          for(var i=0;i<vdcList.length;i++){
    	                        	  var vdcVO = vdcList[i];
    	                        	  if(vdcUuid == vdcVO.uuid){
    	                        		  vdcName = vdcVO.name;
    	                        		  break;
    	                        	  }
    	                          }
    	                          self.currentVO().vdcList(vdcList);
    	                        
    	                          var vpcList = result.vpcList;
    	                          var vpcName;
    	                          for(var i=0;i<vpcList.length;i++){
    	                        	  var vpcVO = vpcList[i];
    	                        	  if(vpcUuid == vpcVO.uuid){
    	                        		  vpcName = vpcVO.name;
    	                        		  break;
    	                        	  }
    	                          }
    	                          self.currentVO().vpcList(vpcList);
    	                          
    	                          
    	                          var networkList = result.networkList;
    	                          var networkName;
    	                          for(var i=0;i<networkList.length;i++){
    	                        	  var networkVO = networkList[i];
    	                        	  if(selelctNetworkUuid == networkVO.uuid){
    	                        		  networkName = networkVO.name;
    	                        		  break;
    	                        	  }
    	                          }
    	                          self.currentVO().privateNetworkList(networkList);
    	                          
    	                          
    	                          var azList = result.azList;
    	                          var azName;
    	                          for(var i=0;i<azList.length;i++){
    	                        	  var azVO = azList[i];
    	                        	  if(azUuid == azVO.uuid){
    	                        		  azName = azVO.name;
    	                        		  break;
    	                        	  }
    	                          }
    	                          self.currentVO().azList(azList);
    	                          self.currentVO().osTypeList(result.osTypeList);
    	                          self.currentVO().cpuList(result.cpuList);
    	                          self.currentVO().memoryList(result.memoryList);
    	                          
    	                          var osVersionList = result.osVersionList;
    	                          var osVersionName;
    	                          for(var i=0;i<osVersionList.length;i++){
    	                        	  var osVersionVO = osVersionList[i];
    	                        	  if(osVersionUuid == osVersionVO.uuid){
    	                        		  osVersionName = osVersionVO.opSysVersion;
    	                        		  break;
    	                        	  }
    	                          }
    	                          self.currentVO().osVersionList(result.osVersionList);
    	                          self.currentVO.fromJSON(vmInParamData);
    	                          self.currentVO.fromJSON({
	    	                          	instanceName:vmOrderItemVO.instanceName,
	    	                          	vdcName:vdcName,
	    	                        	azName:azName,
	    	                        	vpcName:vpcName,
	    	                        	networkName:networkName,
	    	                        	osVersionName:osVersionName,
	    	                        	billcycle:vmOrderItemVO.billCycle,
	    	                        	fee:vmOrderItemVO.fee,
	    	                        	billcycleText:getBillTxt(vmOrderItemVO.billCycle),
	    	                          	expireType:vmOrderItemVO.expireType,
	    	                          	expireValue:vmOrderItemVO.expireValue
    	                          });
    	                         
    	                          console.log("diskOrderItems----",diskOrderItems)
    	                          
    	                          
    	                          diskOrderItems.forEach(function(e){
    	                          	var metaDataJson = JSON.parse(e.metaData);
    	                            var diskData = JSON.parse(metaDataJson.resBaseInfo);
    	                          	csc.rest.get("api/v5.0.0/service/getServiceInfo/"+e.serviceUuid, function(serviceVO){
    	                          		 csc.rest.get("api/v5.0.0/cart/getCartSelectList?serviceUuid="+e.serviceUuid, function(res){
    	                          			  console.log(e,"serviceVO",serviceVO)
    	                                   	  var vo=new MountDiskVO();
    	                          			   vo.vdcName();
    	                                       vo.azName();
    	                                       vo.vpcName();
    	                                       vo.vmName();
    	                                   	   vo.name(e.instanceName);
    	                                       vo.size(diskData.volumeSize);
    	                                       vo.serviceUuid(e.serviceUuid);
    	                                       vo.serviceName(serviceVO.name);
    	                                       vo.billRuleUuid(e.billcycle);
    	                                       console.log("=====",e.billcycle,res.chargeList)
    	                                       
    	                                       vo.billRuleText(getBillTxt(e.billcycle));
    	                                       //vo.billRuleList(setArrayCharge(res.chargeList));
    	                                       vo.fee(e.fee);
    	                                       self.currentVO().mountDisks.push(vo);
    	                                   });
    	                          	})
    	                          });
    	                          
    	                          console.log(self.currentVO.toJSON())
    	                          
    	                          var v="";
    	                          if("1"==vmOrderItemVO.expireType){
    	                              v="永久";
    	                          }else if("2"==vmOrderItemVO.expireType){
    	                              v=vmOrderItemVO.expireValue+"个月";
    	                          }else if("3"==vmOrderItemVO.expireType){
    	                              v= "有效期至:"+vmOrderItemVO.expireValue.substr(0,10); 
    	                          }
    	                          self.currentVO().expireText(v);
    	                          self.currentVO().billRuleList(setArrayCharge(result.chargeList));
    	                         
    	                          console.log("currentVO--------------",self.currentVO.toJSON())
    	                         
    	                       });                             
    	                   });
    	               });
    	      	   }
    	      	  ko.applyBindings(new ViewModel(), $('#approveContent')[0]);
    	      		
    	      		
    	      	 });
    	  });
  	  
    });//
   </script>