<div class="app-content-full">
	<div class="bg-light lter b-b wrapper-sm">
		<ol class="breadcrumb">
			<li>当前位置：</li>
			<li>服务</li>
			<li class="active">服务申请</li>
		</ol>
	</div>
	<!-- hbox layout -->
	<div class="hbox hbox-auto-xs bg-light ">
		<!-- column -->
		<div class="col w lter b-r" id="productListBox">
			<div class="vbox">
				<div class="wrapper b-b">
					<div class="left-title">
						<span style="font-size: 16px;">产品列表</span>
					</div>
				</div>
				<div class="row-row">
					<div class="cell scrollable hover">
						<div class="cell-inner">
							<div class='table-responsive'>
								<table class='table table-striped table-hover left-list'>
									<tbody>
										<tr class="active">
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(1)">VDC</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(2)">云主机</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(3)">云硬盘</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(4)">对象存储</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(5)">公网IP</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(6)">负载均衡器</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(7)">SSH密钥</a></td>
										</tr>
										<tr>
											<td><a href="javascript:void(0)" data-bind="click: $root.productTypeChecked(8)">自定义产品</a></td>
										</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- /column -->

		<!-- column -->
		<div class="col">
			<div class="vbox">
				<div class="row-row">
					<div class="cell">
						<div class="cell-inner">
							<div class="wrapper-md">

								<div class="service-right-content">
									<div class="service-list-box row">
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="" alt="" width="60" height="60"></th>
															<td class="v-middle text-lg" ></td>
														</tr>
														<tr>
															<th>支持操作系统：</th>
															<td>windows/linux/aix</td>
														</tr>
														<tr>
															<th>虚拟化平台类型：</th>
															<td>Openstack/CNware</td>
														</tr>
														<tr>
															<th>虚拟化：</th>
															<td>KVM/powerVM</td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														onclick="showModal('pages/services/service_applies/modal1.html')">申请服务</a>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="service-right-content" style="display: none;">
									<div class="form-inline" style="margin-bottom: 10px;">
										<div class="input-group">
											<span class="input-group-addon">操作系统类型</span> <select name=""
												id="" class="form-control input-sm">
												<option value="">1</option>
											</select>
										</div>
										<div class="input-group">
											<span class="input-group-addon">CPU(核)</span> <select name=""
												id="" class="form-control input-sm">
												<option value="">1</option>
											</select>
										</div>
										<div class="input-group">
											<span class="input-group-addon">内存(G)</span> <select name=""
												id="" class="form-control input-sm">
												<option value="">1</option>
											</select>
										</div>
										<a class="btn btn-default btn-sm">搜索</a>
									</div>

									<div class="service-list-box row">
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="assets/img/winhost.png" alt=""
																width="60" height="60"></th>
															<td class="v-middle text-lg">xxxxxxx</td>
														</tr>
														<tr>
															<th>虚拟化：</th>
															<td>KVM/powerVM</td>
														</tr>
														<tr>
															<th>操作系统类型：</th>
															<td>windows/linux/aix</td>
														</tr>
														<tr>
															<th>CPU(核)：</th>
															<td>2</td>
														</tr>
														<tr>
															<th>内存(G)：</th>
															<td>2</td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														onclick="showModal('pages/services/service_applies/modal2.html')">申请服务</a>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="service-right-content" style="display: none;">

									<div class="service-list-box row">
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="assets/img/windisc.png" alt=""
																width="60" height="60"></th>
															<td class="v-middle text-lg"><span>xxxxxxx</span></td>
														</tr>
														<tr>
															<th>硬盘类型：</th>
															<td>SSD</td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														onclick="showModal('pages/services/service_applies/modal3.html')">申请服务</a>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="service-right-content" style="display: none;">

									<div class="service-list-box row">
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="" alt="" width="60" height="60"></th>
															<td class="v-middle text-lg"><span>xxxxxxx</span></td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														onclick="showModal('pages/services/service_applies/modal4.html')">申请服务</a>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="service-right-content" style="display: none;">

									<div class="service-list-box row">
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="" alt="" width="60" height="60"></th>
															<td class="v-middle text-lg"><span>xxxxxxx</span></td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														onclick="showModal('pages/services/service_applies/modal5.html')">申请服务</a>
												</div>
											</div>
										</div>
									</div>
								</div>

								<div class="service-right-content" style="display: none;">
                                   	
									<div class="service-list-box row" data-bind="with: table">
										<!-- ko foreach: {data: pagedRows, as: '$row'}  -->
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="" alt="" width="60" height="60"></th>
															<td class="v-middle text-lg"><span data-bind="text:name"></span></td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														data-bind="click: $root.add">申请服务</a>
												</div>
											</div>
										</div>
										<!-- /ko -->
									</div>
									<footer class="panel-footer" data-bind="with: table">
										<ul class="pagination">
									        <li data-bind="css: leftPagerClass, click: prevPage">
									          <a href="#">&laquo;</a>
									        </li>
									        <!-- ko foreach: {data: (new Array(pages()))} -->
									        <li data-bind="css: $parent.pageClass($index() + 1)">
									          <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
									        </li>
									        <!-- /ko -->
									        <li data-bind="css: rightPagerClass, click: nextPage">
									          <a href="#">&raquo;</a>
									        </li>
									    </ul>
							    	</footer>
								</div>
								
								

								<div class="service-right-content" style="display: none;">

									<div class="service-list-box row" data-bind="with: table">
									    <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
										<div class="col-xs-4">
											<div class="panel b-a">
												<div class="panel-heading wrapper-xs bg-primary no-border"></div>
												<table class="table table-properties">
													<tbody>
														<tr>
															<th><img src="" alt="" width="60" height="60"></th>
															<td class="v-middle text-lg"><span>xxxxxxx</span></td>
														</tr>
														<tr>
															<th>是否收费：</th>
															<td>是</td>
														</tr>
														<tr>
															<th>服务介绍：</th>
															<td>服务介绍文字。。</td>
														</tr>
													</tbody>
												</table>
												<div class="panel-footer text-center">
													<a href="javascript:void(0)"
														class="btn btn-success font-bold m-sm"
														data-bind="click: $root.add_SSH">申请服务</a>
												</div>
											</div>
										</div>
										<!-- /ko -->
									</div>
									
									<footer class="panel-footer" data-bind="with: table_SSH">
										<ul class="pagination">
									        <li data-bind="css: leftPagerClass, click: prevPage">
									          <a href="#">&laquo;</a>
									        </li>
									        <!-- ko foreach: {data: (new Array(pages()))} -->
									        <li data-bind="css: $parent.pageClass($index() + 1)">
									          <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
									        </li>
									        <!-- /ko -->
									        <li data-bind="css: rightPagerClass, click: nextPage">
									          <a href="#">&raquo;</a>
									        </li>
									    </ul>
							    	</footer>
								</div>

								<div class="service-right-content" style="display: none;">

								</div>

							</div>
							
							
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- page specific plugin scripts -->
	<script type="text/javascript">
var scripts = [null, "assets/lib/moment/moment.js","assets/lib/bootstrap-daterangepicker/daterangepicker.js", null];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    
    if(args.type){
    	//如果是普通用户清除产品列表
    	$("#productListBox").remove();
    	$(".service-right-content").eq(args.type).show().siblings().hide();
    }else{
    	$('.left-list tr td a').click(function(){
	    	var _tr = $(this).parent().parent();
	    	if(_tr.hasClass('active')) return;
	    	_tr.addClass('active').siblings().removeClass('active');
	    	$(".service-right-content").eq(_tr.index()).show().siblings().hide();
	    })
    };
    $(".form-edit").click(function(){
    	$(this).hide();
    	$(this).siblings('.form-save').show();
    	$(this).siblings('.row').find(".value-span").hide().next('.input-span').show();
    })
    $(".form-save").click(function(){
    	$(this).hide();
    	$(this).siblings('.form-edit').show();
    	$(this).siblings('.row').find('.value-span').show().html($(this).siblings('.row').find('input').val());
    	$(this).siblings('.row').find(".input-span").hide();
    })

    $(".product-add-btn").click(function(){
    	$(".add-praoduct").show().siblings().hide();
    })
    $(".product-delete-btn").click(function(){
    	if(confirm('确认删除吗？')){
    		console.log('执行删除！')
    	}
    })

  //负载均衡申请
    function ViewModel(){
	    var self = this;
	    
	    this.productType = ko.observable();
	    this.productTypeChecked = function(obj){
	    	self.productType(obj);
	    }
	    
	    
	    
	    
	    this.modelVO = ko.validatedObservable({
	        loadbalancerCartInfo: ko.observableArray([])
	    });
	    
	    this.loadBalancerNum = ko.observable().extend({max:20});
	    
	    //vdc下拉列表
	    this.vdcList = ko.observableArray();
	    this.loadCatelogs = function(){
	        csc.rest.get("api/v5.0.0/cart/getselect", function(data){
	        	self.vdcList(data);
	        });
	    }

	    var billRoles = [{name:'按天',value:'1'},{name:'按月',value:'2'},{name:'按季度',value:'3'},{name:'按年',value:'4'}];
	    var countries = [{name:'1',value:'1'},{name: '2',value:'2'},{name: '3', value:'3'}];  
	    //申请时长 下拉列表
	    this.applyList = ko.observableArray(countries);
	    this.billRoleList = ko.observableArray(billRoles);
	    
	    this.loadBalancerNum.subscribe(function(){
	    	self.modelVO().loadbalancerCartInfo([]);
	    	
	    	var num = self.loadBalancerNum();
	    	for(var i=0; i<num; i++){
	    		self.modelVO().loadbalancerCartInfo.push({
	    			name: ko.observable("").extend({required:true}),
					vdcUuid: ko.observable(""),
					applyType: ko.observable("1"),
					applyNum: ko.observable(""),
					applyTime: ko.observable(""),
					billRuleUuid: ko.observable("")
						/* userUuid: ko.observable(),
	    		        serviceUuid: observable(),
	    		        price: ko.observable() */
	    		})
	    	}
	    	
	    	
	    });
	    
	    //控制 负载均衡服务 申请页面显示
	    this.isAdd = ko.observable(false);
	    this.add = function(){
	        self.isAdd(true);
	        self.loadBalancerNum(1);
	        self.loadCatelogs();
	    }

	    //添加到购物车操作
		this.addToCart = function(){
			//console.log(this.modelVO.toJSON());
			if(self.productType()=='6'){
				if(this.modelVO.isValid()){
				 	console.log(this.modelVO.toJSON());
				 	/* csc.rest.post('api/v5.0.0/cart',this.modelVO.toJSON(),function(data){
				 		systemMsg.alert('添加到购物车成功！');
				 		self.isAdd(false);
				    }); */
				}
			}else if(self.productType()=='7'){
				if(this.model_SSH.isValid()){
				 	console.log(this.model_SSH.toJSON());
				 	/* csc.rest.post('api/v5.0.0/cart',this.model_SSH.toJSON(),function(data){
				 		systemMsg.alert('添加到购物车成功！');
				 		self.isAdd(false);
				    }); */
				}
			}
			
		} 
		
		//添加到购物车操作
		this.addToOrder = function(){
			if(this.modelVO.isValid()){
			 	csc.rest.post('api/v5.0.0/orders',this.modelVO.toJSON(),function(data){
			 		systemMsg.alert('提交订单成功！');
			 		self.isAdd(false);
			    });
			}
		} 
		
		//负载均衡列表数据
		
		this.table = new DataTable([], {path: 'api/v5.0.0/cart/findLoadBalancer',perPage:6});
		
		//SSH密钥
	    this.isAdd_SSH = ko.observable(false);
	    this.add_SSH = function(){
	    	self.isAdd_SSH(true);
	    	self.sshNum(1);
	    	self.loadCatelogs();
	    }
	    this.sshNum = ko.observable().extend({max:20});
	    
	    this.model_SSH = ko.validatedObservable({
	    	sshKeytCartInfo: ko.observableArray([])
	    });
	    
	    this.sshNum.subscribe(function(){
	    	self.model_SSH().sshKeytCartInfo([]);
	    	var num = self.sshNum();
	    	for(var i=0; i<num; i++){
	    		self.model_SSH().sshKeytCartInfo.push({
	    			name: ko.observable("").extend({required:true}),
					vdcUuid: ko.observable(""),
					applyType: ko.observable("1"),
					applyNum: ko.observable(""),
					applyTime: ko.observable(""),
					billRuleUuid: ko.observable("")
	    		})
	    	}
	    	
	    	
	    });
	    this.table_SSH = new DataTable([], {path: 'api/v5.0.0/cart/findLoadBalancer',perPage:6});
    }
	ko.applyBindings(new ViewModel, $('#page-content .tab-pane')[0]); 
  });
  
</script>
<!-- 负载均衡 start -->
<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAdd }">
	<div class='modal-dialog modal-lg' role='document'>
        <div class='modal-content'>
			<div class='modal-header'>
				<button type="button" class="close" data-dismiss="modal">
					<span aria-hidden="true">&times;</span>
				</button>
				<h3 class='modal-title'>申请负载均衡器</h3>
			</div>
			<div class='modal-body form-horizontal'>
				<div class="form-inline">
					<div class="input-group">
						<span class="input-group-addon">申请数量</span> <input type="text"
							class="form-control" data-bind="value: loadBalancerNum, valueUpdate: 'afterkeydown'">
					</div>
				</div>
				<div class="panel panel-default table-responsive no-height"
					style="margin: 0; margin-top: 10px">
					<table class="table table-striped">
						<thead>
							<th>序号</th>
							<th>负载均衡器名称<i style="color: red">*</i></th>
							<th>所属VDC<i style="color: red">*</i></th>
							<th>申请时长<i style="color: red">*</i></th>
							<th>套餐</th>
							<th>收费标准</th>
						</thead>
						<tbody id="applyServiceBalancingBox"
							data-bind="foreach: modelVO().loadbalancerCartInfo">
							<tr>
								<td><span data-bind="text: ($index()+1)"></span></td>
								<td><input type="text" class="form-control input-sm"
									data-bind="value: name"></td>
								<td><select class="form-control input-sm" data-bind="options:$parent.vdcList,optionsText:'name',optionsValue:'uuid',value:vdcUuid"></select></td>
								<td>
									<div class="radio">
										<label class="form-inline"> <input type="radio"
											name="optionsRadios'+i+'" id="optionsRadios'+i+'1"
											value="1" data-bind="checked: applyType" > 永久
										</label>
									</div>
									<div class="radio">
										<label class="form-inline"> <input type="radio"
											class="form-control" style="top: 2px;"
											name="optionsRadios'+i+'" id="optionsRadios'+i+'2"
											value="2" data-bind="checked: applyType"> <select class="form-control"  data-bind="options:$parent.applyList,optionsText:'name',optionsValue:'value',value:applyNum"></select> 个月
										</label>
									</div>
									<div class="radio disabled">
										<label class="form-inline"> <input type="radio"
											class="form-control" style="top: 2px;"
											name="optionsRadios'+i+'" id="optionsRadios'+i+'3"
											value="3" data-bind="checked: applyType"> <input type="text"
											style="width: 206px" class="form-control"
											id="applyServiceBalancingBox_daterange'+i+'">
										</label>
									</div>
								</td>
								<td><select class="form-control"  data-bind="options:$parent.billRoleList,optionsText:'name',optionsValue:'value',value:billRuleUuid">
								</select></td>
								<td>0.5元/小时</td>
							</tr>
						</tbody>
					</table>
				</div>
            </div>
			<div class='modal-footer' style="text-align: center;">
				<a class="btn btn-default btn-info"
					data-bind="click: $root.addToCart">添加到购物车</a> <a
					class="btn btn-default btn-success" data-bind="click: $root.addToOrder">提交订单</a> <a
					class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
			</div>
		</div>
	</div>
</div>
<!-- 负载均衡 end -->	
<!-- SSH密钥 start -->
  <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAdd_SSH }">
	<div class='modal-dialog modal-lg' role='document'>
  
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>申请SSH密钥服务</h3>
      </div>
      <div class='modal-body form-horizontal'>
        <div class="form-inline">
          <div class="input-group">
             <span class="input-group-addon">申请数量</span>
             <input type="text" class="form-control"  data-bind="value: sshNum, valueUpdate: 'afterkeydown'">
          </div>
        </div>
        <div class="panel panel-default table-responsive no-height" style="margin:0;margin-top:10px">
          <table class="table table-striped">
            <thead>
              <th>序号</th>
              <th>SSH密钥名称<i style="color:red">*</i></th>
              <th>所属VDC<i style="color:red">*</i></th>
              <th>申请时长<i style="color:red">*</i></th>
              <th>收费标准</th>
            </thead>
            <tbody id="applyServiceSSHBox" data-bind="foreach: model_SSH().sshKeytCartInfo">
                  <tr>
						<td><span data-bind="text: ($index()+1)"></span></td>
						<td><input type="text" class="form-control input-sm"
							data-bind="value: name"></td>
						<td><select class="form-control input-sm" data-bind="options:$parent.vdcList,optionsText:'name',optionsValue:'uuid',value:vdcUuid"></select></td>
						<td>
							<div class="radio">
								<label class="form-inline"> <input type="radio"
									name="optionsRadios'+i+'" id="optionsRadios'+i+'1"
									value="1" data-bind="checked: applyType" > 永久
								</label>
							</div>
							<div class="radio">
								<label class="form-inline"> <input type="radio"
									class="form-control" style="top: 2px;"
									name="optionsRadios'+i+'" id="optionsRadios'+i+'2"
									value="2" data-bind="checked: applyType"> <select class="form-control"  data-bind="options:$parent.applyList,optionsText:'name',optionsValue:'value',value:applyNum"></select> 个月
								</label>
							</div>
							<div class="radio disabled">
								<label class="form-inline"> <input type="radio"
									class="form-control" style="top: 2px;"
									name="optionsRadios'+i+'" id="optionsRadios'+i+'3"
									value="3" data-bind="checked: applyType"> <input type="text"
									style="width: 206px" class="form-control"
									id="applyServiceBalancingBox_daterange'+i+'">
								</label>
							</div>
						</td>
						<td><select class="form-control"  data-bind="options:$parent.billRoleList,optionsText:'name',optionsValue:'value',value:billRuleUuid">
						</select></td>
						<td>0.5元/小时</td>
					</tr>  
            </tbody>
          </table>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info" 
           data-bind="click: $root.addToCart">添加到购物车</a>
        <a class="btn btn-default btn-success">提交订单</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>
<!-- SSH密钥 end -->