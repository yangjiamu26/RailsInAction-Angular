<style>
  .ace-settings-container {
  position: fixed;
  right: 0;
  top: 60px;
  z-index: 9999;
}
.bigger-130{font-size:22px;padding:6px 0;}
.btn.btn-app.ace-settings-btn {
  float: left;
  display: block;
  text-align: center;
  border-radius: 6px 0 0 6px;
  opacity: 0.55;
  vertical-align: top;
  margin: 0;
}
.btn.btn-app.ace-settings-btn:hover,
.btn.btn-app.ace-settings-btn.open {
  opacity: 1;
}
.btn.btn-app.ace-settings-btn.btn-xs {
  width: 42px;
}
.ace-settings-box {
  display: block;
  float: left;
  max-width: 0;
  max-height: 0;
  overflow: hidden;
  padding: 0;
  -moz-transform: translate(0,0);
  -webkit-transform: translate(0,0);
  -o-transform: translate(0,0);
  -ms-transform: translate(0,0);
  transform: translate(0,0);
  background-color: #FFF;
  border: 0 solid #fad733;
  -webkit-transition: max-width 0.25s linear 0s, max-height 0s linear 0.25s, padding 0s linear 0.25s, border-width 0s linear 0.25s;
  -o-transition: max-width 0.25s linear 0s, max-height 0s linear 0.25s, padding 0s linear 0.25s, border-width 0s linear 0.25s;
  transition: max-width 0.25s linear 0s, max-height 0s linear 0.25s, padding 0s linear 0.25s, border-width 0s linear 0.25s;
}
.ace-settings-box.open {
  max-width: 320px;
  max-height: 1000px;
  padding: 0 14px;
  border-width: 2px;
  -webkit-transition-delay: 0s;
  -moz-transition-delay: 0s;
  -o-transition-delay: 0s;
  transition-delay: 0s;
}
.ace-settings-box.open .ace-settings-item {
  z-index: auto;
  min-width: 140px;
}
.ace-settings-box .ace-settings-item {
  margin: 6px 0;
  color: #444;
  max-height: 24px;
  position: relative;
  z-index: -1;
  white-space: nowrap;
}
.ace-settings-box .ace-settings-item > label.lbl {
  font-size: 13px;
}
.checkbox{padding:5px;display: block;}
.checkbox label{position:relative;display: block;background:#fff;border-radius:5px;height:30px;line-height:30px;text-align:center;}
.widget-placeholder{border:2px dashed #D9D9D9}
input[type="checkbox"]{opacity: 0;position:absolute!important;}
input[type="checkbox"]+span{display:block;z-index:1;width:100%;height:100%;border-radius:5px;border:1px solid #eee;left:0;top:0;position:absolute;font: normal normal normal 14px/1 FontAwesome;}
input[type="checkbox"]:checked+span{border:1px solid #39bee8;color:#39bee8;}
input[type="checkbox"]:checked+span::before{display:block;z-index:1;width:20px;height:20px;top:0;left:0;content:"\f00c";}
.spanDiv{
  position:relative;
  width:5px;
  height:5px;
}

.dragDiv,.nodragDiv{
  position:relative;
  filter:alpha(opacity=100);
  opacity:1;
  background-color:#FFFFFF;
}
.dragDiv{display:none;}
.panel-right-link{position:absolute;right:10px;top:10px;}
#dragTable{width:100%;display:block;}
#dragTable>tbody{display: block;}
#dragTable>tbody>tr{display:block;margin:0 -10px;}
#dragTable>tbody>tr>td{width:50%;display:block;float:left;}
</style>
<div class="ace-settings-container" id="ace-settings-container">
  <div class="btn btn-app btn-xs btn-warning ace-settings-btn" id="ace-settings-btn">
    <i class="ace-icon fa fa-cog bigger-130"></i>
  </div>
  
  <!-- 浮动配置窗 -->
  <div class="ace-settings-box clearfix" id="ace-settings-box">
    <form action="" class="wrapper-sm form-inline w-lg row">
      <div id="setting_box">
      </div>
    </form>
  </div><!-- /.ace-settings-box -->
</div>

<div class='wrapper-md'>
    <table id="dragTable" style="">
      <tr style="">
        <td valign="top" style="padding-right:10px;">
          
          <div class='panel panel-default dragDiv' id="dragDiv1">
            <!-- 资源管理 -->
            <div id="titleBar1" class='panel-heading text-base'>资源管理</div>
            <div class='panel-body'>
              <div class='row text-center welcome-resource-manger'>
                <a href="#pages/vdcs/businesses/index">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-business"></div>
                    <div class="manger-title">业务系统</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().businessNum"></span></div>
                  </div>
                </a>
                <a data-bind="attr:{href:vmUri}">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-vm"></div>
                    <div class="manger-title">云主机</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().vmNum"></span></div>
                  </div>
                </a>
                <a data-bind="attr:{href:volumeUri}">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-vdisk"></div>
                    <div class="manger-title">云硬盘</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().volumeNum"></span></div>
                  </div>
                </a>
                <a href="#pages/vdcs/vpcs/index?type=0&showTab=routerTab" data-bind="visible: resourceVO().role()!='普通用户'">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-router"></div>
                    <div class="manger-title">路由器</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().routerNum"></span></div>
                  </div>
                </a>
                <a href="#pages/vdcs/vpcs/index?type=0&showTab=safegroupTab" data-bind="visible: resourceVO().role()!='普通用户'">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-securityGroup"></div>
                    <div class="manger-title">安全组</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().securityGroupNum"></span></div>
                  </div> 
                </a>
                <a data-bind="attr:{href:ipUri}">             
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-ip"></div>
                    <div class="manger-title">公网IP</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().ipNum"></span></div>
                  </div>
                </a>
                <a data-bind="attr:{href:loadBalanceUri}">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-loadBalancing"></div>
                    <div class="manger-title">负载均衡器</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().loadBalanceNum"></span></div>
                  </div>
                </a>
                <a href="#pages/vdcs/vpcs/index?type=0&showTab=firewallTab" data-bind="visible: resourceVO().role()!='普通用户'">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-firewall"></div>
                    <div class="manger-title">防火墙</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().firewallNum"></span></div>
                  </div>
                </a>
                <a data-bind="attr:{href:sshUri}">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-secretKey"></div>
                    <div class="manger-title">SSH密钥</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().sshNum"></span></div>
                  </div>
                </a>
                <a data-bind="attr:{href:objStorageUri}">
                  <div class='col-lg-2-4 col-xs-4'>
                    <div class="resource-icon resource-icon-storage"></div>
                    <div class="manger-title">对象存储</div>
                    <div class='h2 m-b-sm'><span data-bind="text: resourceVO().objStorageNum"></span></div>
                  </div>
                </a>
              </div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv2">
            <!-- VDC配额信息 -->
            <div id="titleBar2" class='panel-heading'>
              <span class="text-base">VDC配额信息</span>
            </div>
            <div class='panel-body'>
              <div class="panel-right-link">
                <select class="pull-right" data-bind="options: vdcList,optionsText:'name',optionsValue:'uuid',value:selectedVdc,event:{change:$root.loadVdcStat}">
                </select> 
              </div>
              <div class="row">
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>CPU</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().cpu()"></span></h5>
                  <div id="total_cpu_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>內存</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().mem()"></span></h5>
                  <div id="total_memory_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>存储</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().sto()"></span></h5>
                  <div id="total_storage_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>云主机</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().vm()"></span></h5>
                  <div id="total_vm_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>云硬盘</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().disk()"></span></h5>
                  <div id="total_vdisk_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>对象存储</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().obj()"></span></h5>
                  <div id="total_objectStorage_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>路由器</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().router()"></span></h5>
                  <div id="total_router_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>防火墙</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().firewall()"></span></h5>
                  <div id="total_firewall_chart" style="height: 150px"></div>
                </div>
                <div class="col-lg-4 col-xs-4 text-center">
                  <h4>安全组</h4>
                  <h5 class="text-black font-bold"><span data-bind="text: vdcQuotaVO().secgroup()"></span></h5>
                  <div id="total_secgroup_chart" style="height: 150px"></div>
                </div>
                <div class="clear wrapper m m-b-none">
                  <div>
                    <h4>
                      VPC
                      <span class="text-black text-base font-bold m-l" data-bind="text: vdcQuotaVO().vpcA()"></span>
                      <span class="text-black text-xs m-l">已用/未用：<b data-bind="text: vdcQuotaVO().vpcB()"></b></span>
                    </h4>       
                    <div class="progress progress-sm m-t-sm">
                      <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" data-bind="style: {width: vdcQuotaVO().vpcRate()}">
                          <span data-bind="text: vdcQuotaVO().vpcRate()"></span>
                      </div>
                    </div>
                  </div>
                  <div>
                    <h4>
                                                                  负载均衡器
                      <span class="text-black text-base font-bold m-l" data-bind="text: vdcQuotaVO().blaA()"></span>
                      <span class="text-black text-xs m-l">已用/未用：<b data-bind="text: vdcQuotaVO().blaB()"></b></span>
                    </h4>       
                    <div class="progress progress-sm m-t-sm">
                      <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" data-bind="style: {width: vdcQuotaVO().blaRate()}">
                          <span data-bind="text: vdcQuotaVO().blaRate()"></span>
                      </div>
                    </div>
                  </div>
                  <div>
                    <h4>
                                                                  公网IP
                      <span class="text-black text-base font-bold m-l" data-bind="text: vdcQuotaVO().ipA()"></span>
                      <span class="text-black text-xs m-l">已用/未用：<b data-bind="text: vdcQuotaVO().ipB()"></b></span>
                    </h4>       
                    <div class="progress progress-sm m-t-sm">
                      <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="94.7" aria-valuemin="0" aria-valuemax="100" data-bind="style: {width: vdcQuotaVO().ipRate()}">
                          <span data-bind="text: vdcQuotaVO().ipRate()"></span>
                      </div>
                    </div>
                  </div>
                  <div>
                    <h4>
                      SSH密钥
                      <span class="text-black text-base font-bold m-l" data-bind="text: vdcQuotaVO().sshA()"></span>
                      <span class="text-black text-xs m-l">已用/未用：<b data-bind="text: vdcQuotaVO().sshB()"></b></span>
                    </h4>       
                    <div class="progress progress-sm m-t-sm">
                      <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="78.6" aria-valuemin="0" aria-valuemax="100" data-bind="style: {width: vdcQuotaVO().sshRate()}">
                          <span data-bind="text: vdcQuotaVO().sshRate()"></span>
                      </div>
                    </div>
                  </div>
                  <div>
                    <h4>
                      VPN
                      <span class="text-black text-base font-bold m-l" data-bind="text: vdcQuotaVO().vpnA()"></span>
                      <span class="text-black text-xs m-l">已用/未用：<b data-bind="text: vdcQuotaVO().vpnB()"></b></span>
                    </h4>       
                    <div class="progress progress-sm m-t-sm">
                      <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="78.6" aria-valuemin="0" aria-valuemax="100" data-bind="style: {width: vdcQuotaVO().vpnRate()}">
                          <span data-bind="text: vdcQuotaVO().vpnRate()"></span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv3" >
            <!-- 最近订单 -->
            <div class="panel-right-link">
            	<a data-bind="attr:{href:$root.orderUri}" class="pull-right">更多</a>      
            </div>
            <div id="titleBar3" class='panel-heading'>
              <span class="text-base">最近订单</span>
            </div>
            <div class='panel-body' ui-jq='slimScroll' ui-options="{height:'250px'}">
                  <table class="table table-properties" data-bind="visible:orderList().length >0">
                      <tbody data-bind="foreach:orderList">
                          <tr>
                              <td width="10%"><span class='label text-base pos-rlt m-r' data-bind="css:$root.orderStateCss(state),text:$root.orderState(state)"></span></td>
                              <td data-bind="text:code"></td>
                              <td data-bind="text:resourceNames"></td>
                          </tr>
                      </tbody>
                  </table>
                  <div data-bind="visible:(orderList().length==0),text:'当前没有最近订单信息'">
              	  </div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv4">
            <!-- 最新通知 -->
            <div class="panel-right-link">
            	<a href="#pages/systems/notices/index" class="pull-right" >更多</a>
            </div>
            <div id="titleBar4" class='panel-heading'>
              <span class="text-base">最新通知</span>
            </div>
            <div class='panel-body' ui-jq='slimScroll' ui-options="{height:'310px'}">
               <!-- <div class='media'>
                <div class='media-body'>
                  <div class='pull-right text-right text-muted'>
                    <strong>12:18</strong>
                    <br>
                    <small class='label bg-light m-l-sm'>下午</small>
                  </div>
                  <span class='label bg-dark pull-left'>未读</span>
                  <a class='text-danger w-xl text-ellipsis' href='#'>服务到期服务到期服务到期服务到期服务到期服务到期服务到期服务到期服务到期
                  </a>
                  <div class='m-t-sm'>云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.</div>
                </div>
              </div>
              <div class='line'></div>
              <div class='media'>
                <div class='media-body'>
                  <div class='pull-right text-right text-muted'>
                    <strong>12:18</strong>
                    <br>
                    <small class='label bg-light m-l-sm'>2016-06-19</small>
                  </div>
                  <span class='label bg-light pull-left'>已读</span>
                  <a class='text-success w-xl text-ellipsis' href='#'>审核通过
                  </a>
                  <div class='m-t-sm'>云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.</div>
                </div>
              </div>
              <div class='line'></div>
              <div class='media'>
                <div class='media-body'>
                  <div class='pull-right text-right text-muted'>
                    <strong>12:18</strong>
                    <br>
                    <small class='label bg-light m-l-sm'>2016-06-19</small>
                  </div>
                  <span class='label bg-light pull-left'>已读</span>
                  <a class='text-info w-xl text-ellipsis' href='#'>普通提醒
                  </a>
                  <div class='block m-t-sm'>云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.云主机在2016-09-09将会过期.</div>
                </div>
              </div>
              <div class='line'></div>  -->
              <div data-bind="visible:(noticeList().length>0),foreach:noticeList">
				  <div class='media'>
	                <div class='media-body'>
	                  <div class='pull-right text-right text-muted'>
	                    <strong data-bind="text:moment(noticeTime).format('HH:mm')"></strong>
	                    <br>
	                    <small class='label bg-light m-l-sm' data-bind="text:moment(noticeTime).format('YYYY-MM-DD')"></small>
	                  </div>
	                  <span class='label bg-light pull-left' data-bind="css:$root.noticeStateClass(noticeState),text:$root.noticeStateShow(noticeState)"></span>
	                  <span class="w-xl text-ellipsis text-info" data-bind="text:noticeTitle">
	                  </span>
	                  <div class='block m-t-sm' data-bind="text:noticeContent"></div>
	                </div>
	              </div> 
              </div>
              
              <div data-bind="visible:(noticeList().length==0),text:'当前没有最新通知'">
           	  </div>
           </div>
          </div>
        </td>
        <td valign="top" style="padding-left:10px;">
          
          <div class='panel panel-default dragDiv' id="dragDiv5">
            <!-- 快捷入口 -->
            <div id="titleBar5" class='panel-heading text-base'>快捷入口</div>
            <div class='panel-body'>
              <div class='row row-sm text-center'>
                <div class='col-xs-4'>
                  <a class='block panel padder-v bg-primary m-t' href='#pages/vdcs/businesses/index' >
                    <span class='text-white font-thin h4 block'>创建业务系统</span>
                  </a>
                </div>
                <div class='col-xs-4'>
                  <a class='block panel padder-v bg-info m-t' href='#pages/services/service_applies/index'>
                    <span class='text-white font-thin h4 block'>申请服务</span>
                  </a>
                </div>
                <div class='col-xs-4'>
                  <a class='block panel padder-v bg-success m-t' href='#pages/services/service_definitions/index' data-bind="visible: resourceVO().role()=='系统管理员' || resourceVO().role()=='运营管理员'">
                    <span class='text-white font-thin h4 block'>创建服务</span>
                  </a>
                </div>
              </div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv6">
            <!-- 数据中心资源 -->
            <div id="titleBar6" class='panel-heading'>
              <span class="text-base">数据中心资源</span>
            </div>
            <div class='panel-body'>
              <div class="panel-right-link">
                <!-- <select class="pull-right">
                  <option selected="selected">数据中心总览</option>
                  <option>数据中心一</option>
                  <option>数据中心二</option>
                </select> -->
                <select class="pull-right" style="max-width:300px;" data-bind="options: dcList,optionsText:'name',value:selectedDc, optionsCaption:'数据中心总览',event:{change:$root.loadDCStatistics}">
              	</select>
              </div>
              <div id="dcMessage" style="padding-top:10px;padding-battom:6px;" class="alert alert-warning alert-dismissible" role="alert" data-bind="visible:dcStatResult" style="">
				  <button type="button" class="close" aria-label="Close" data-bind="click:function(){$('#dcMessage').hide()}"><span aria-hidden="true">&times;</span></button>
				  <strong data-bind="text:dcStatResult"></strong>
				</div>
              <div class="welcome-dataCenter" >
                  <div class="resource-vm">
                    <div>虚拟机</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('vmNum')&&dcStatistics().vmNum!=null)?dcStatistics().vmNum:0"></strong></div>
                  </div>
                  <div class="resource-partition">
                    <div>可用分区</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('azNum')&&dcStatistics().azNum!=null)?dcStatistics().azNum:0"></strong></div>
                  </div>
                  <div class="resource-storageNum">
                    <div>存储池</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('storagePoolNum')&&dcStatistics().storagePoolNum!=null)?dcStatistics().storagePoolNum:0"></strong></div>
                  </div>
                  <div class="resource-pool" data-bind="visible:isShowResourcePool">
                    <div>资源池</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('resourcePoolNum')&&dcStatistics().resourcePoolNum!=null)?dcStatistics().resourcePoolNum:0"></strong></div>
                  </div>
                  <div class="resource-image">
                    <div>镜像</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('imageNum')&&dcStatistics().imageNum!=null)?dcStatistics().imageNum:0"></strong></div>
                  </div>
                  <div class="resource-host">
                    <div>物理机</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('hostNum')&&dcStatistics().hostNum!=null)?dcStatistics().hostNum:0"></strong></div>
                  </div>
                  <div class="resource-ip">
                    <div data-bind="text:netWorkTextName">网络</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('networkNum')&&dcStatistics().networkNum!=null)?dcStatistics().networkNum:0"></strong></div>
                  </div>
                  <div class="resource-storageVolumen">
                    <div>存储</div>
                    <div><strong data-bind="text:storageSize"></strong></div>
                  </div>
                  <div class="resource-memory">
                    <div>内存</div>
                    <div><strong data-bind="text:memorySize"></strong></div>
                  </div>
                  <div class="resource-cpu">
                    <div>CPU逻辑单元</div>
                    <div><strong data-bind="text:(dcStatistics().hasOwnProperty('cpuNum')&&dcStatistics().cpuNum!=null)?dcStatistics().cpuNum:0"></strong></div>
                  </div>
              </div>

            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv7">
            <!-- 我的任务 -->
            <div id="titleBar7" class='panel-heading text-base'>我的任务</div>
            <div class='panel-body'>
              <div class='list-group list-group-lg m-b-none'>
                <a href='#pages/workflows/tasks?type=work&showTab=doingTab' class='list-group-item'>
                  <span class='pull-right label bg-danger inline' data-bind="text:taskStat().todoCount"></span>我的待办</a>
                <a href='#pages/workflows/tasks?type=work&showTab=didTab' class='list-group-item'>
                  <span class='pull-right label bg-info inline' data-bind="text:taskStat().finishCount"></span>我的已办</a>
              </div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv8">
            <!-- 总体告警统计 -->
            <div id="titleBar8" class='panel-heading text-base'>总体告警统计</div>
            <div class='panel-body'>
              <div id="total_alarm_chart" style="height:190px;"></div>
              <div id="vdc_alarm_chart" class="m-t" style="height:190px;"></div>
            </div>
          </div>
          
          <div class='panel panel-default dragDiv' id="dragDiv9">
            <!-- 最近告警 -->
            <div class="panel-right-link">
            	<a href="#pages/systems/warnings/index" class="pull-right">更多</a>       
            </div>
            <div id="titleBar9" class='panel-heading'>
              <span class="text-base">最近告警</span>
            </div>	
            <div class='panel-body' ui-jq='slimScroll' ui-options="{height:'250px'}">
              <div class='streamline b-l m-b b-warning'>
                <div data-bind="visible: alarmInfoVO().length>0 ,foreach: alarmInfoVO">
	                <div class='sl-item b-l' data-bind="css:$root.alarmStateCss($index()+1)">
	                  <div class='m-l'>
	                    <div><span class='text-muted small' data-bind="text: alarmTime"></span> <span class='text-danger' data-bind="translate: {type: 'alarmSource', key: alarmSource}"></span> <span>告警对象名称</span></div>
	                    <p><span class='text-danger' data-bind="text: alarmName"></span>上的<span data-bind="text: alarmReason"></span></p>
	                  </div>
	                </div>
                </div>
                <div data-bind="visible: alarmInfoVO().length==0,text:'当前无告警'">
	            </div>
              </div>
              
            </div>
          </div>
        </td>
      </tr>
    </table>
</div>

<!-- page specific plugin scripts -->
<script type="text/javascript">
  var scripts = [null,"assets/lib/highcharts/highstock.js", "assets/js/jquery-ui.custom.js","assets/js/jquery.ui.touch-punch.js","assets/lib/drap/drap.js","assets/lib/moment/moment.js",];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(query) {
	
  	// 如果是 系统管理员、运维管理员、运营管理员，并且系统还没有创建数据中心，则跳转到向导页预览
 	csc.rest.get('api/v5.0.0/homepage/user',function(data){
		if(data == null || data == "" ){
			return ;
		}
		if(data.roleName == '系统管理员' || data.roleName == '运维管理员' || data.roleName == '运营管理员'){
			csc.rest.get('api/v5.0.0/service?maxResult=1&firstResult=0&state=1',function(data1){//判断是否已完成运营向导
				if(data1 == null || data1 == ""){
					return ;
				}
				if(data1.results.length > 0){//如果还未创建产品，则进入向导页面
					csc.rest.get('api/v5.0.0/datacenters?maxResult=1&firstResult=0',function(data2){//判断是否完成入云向导
						if(data2 == null || data2 == "" || data2.results == null){
							return ;
						}
						if(data2.results.length == 0){//如果还未创建数据中心，则进入向导页面
							window.location.href='#pages/guide/index';
						}else{
							csc.rest.get('api/v5.0.0/azs?cloudPlatform=CNware&maxResult=1&firstResult=0',function(data3){
								if(data3 == null || data3 == ""){
									return ;
								}
								if(data3.results.length == 0){//如果还未创建CNWARE可用分区，则判断是否有openstack可用分区
									csc.rest.get('api/v5.0.0/azs?cloudPlatform=OpenStack&maxResult=1&firstResult=0',function(data4){
										if(data4 == null || data4 == ""){
											return ;
										}
										if(data4.results.length == 0){//如果还未创建openstack可用分区，则进入向导页面
											window.location.href='#pages/guide/index';
										}else{
											csc.rest.get('api/v5.0.0/images/counts',function(data5){
												if(data5 == null || data5 == ""){
													return ;
												}
												if(data5.imageCount == 0){//如果已创建openstack可用分区，则判断有没镜像存在，没则进入向导页面
													window.location.href='#pages/guide/index';
												}
											});
										}
									});
								}
							});
						}
					});
				}else{
					window.location.href='#pages/guide/index';
				}
			});
		} 
    });	 
  	
    function doHighchartsVDC(data){
      // cpu占比图
      $('#total_cpu_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'CPU',
            data: [{
                    name: '已用',
                    y: parseFloat(data.cpuUsed),
                    unit: data.cpuUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.cpuTotal)-parseFloat(data.cpuUsed),
                    unit: data.cpuUnit,
                    color:"#fad733"
                }
            ]
        }]
      });   

      // 内存占比图
      $('#total_memory_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: '内存',
            data: [{
                    name: '已用',
                    y: parseFloat(data.memUsed),
                    unit: data.memUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.memTotal)-parseFloat(data.memUsed),
                    unit: data.memUnit,
                    color:"#fad733"
                }
            ]
        }]
      });   

      // 存储占比图
      $('#total_storage_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: '存储',
            data: [{
                    name: '已用',
                    y: parseFloat(data.stoUsed),
                    unit: data.stoUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.stoTotal)-parseFloat(data.stoUsed),
                    unit: data.stoUnit,
                    color:"#fad733"
                }
            ]
        }]
      });    

      // 云主机占比图
      $('#total_vm_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.vmUsed),
                    unit: data.vmUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.vmTotal)-parseFloat(data.vmUsed),
                    unit: data.vmUnit,
                    color:"#fad733"
                }
            ]
        }]
      });   

      // 云硬盘占比图
      $('#total_vdisk_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.diskUsed),
                    unit: data.diskUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.diskTotal)-parseFloat(data.diskUsed),
                    unit: data.diskUnit,
                    color:"#fad733"
                }
            ]
        }]
      });   

      // 对象存储占比图
      $('#total_objectStorage_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.objUsed),
                    unit: data.objUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.objTotal)-parseFloat(data.objUsed),
                    unit: data.objUnit,
                    color:"#fad733"
                }
            ]
        }]
      });
      
   	  //路由器占比图
      $('#total_router_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.routerUsed),
                    unit: data.routerUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.routerTotal)-parseFloat(data.routerUsed),
                    unit: data.routerUnit,
                    color:"#fad733"
                }
            ]
        }]
      });
   	  
      //防火墙占比图
      $('#total_firewall_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.firewallUsed),
                    unit: data.firewallUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.firewallTotal)-parseFloat(data.firewallUsed),
                    unit: data.firewallUnit,
                    color:"#fad733"
                }
            ]
        }]
      });
      
      //安全组占比图
      $('#total_secgroup_chart').highcharts({
        chart: {
            marginTop: 0,
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            backgroundColor: "none"
        },
        exporting:{
            enabled: false
        },
        credits:{
            enabled: false,
            text : ""
        },

        title: {
            floating:true,
            text: ''
        },
        legend:{
          enabled:true,
          margin: 0,
          layout: 'vertical',
          backgroundColor:"none",
          borderColor:"none",
          itemStyle: {
            
            fontWeight: 'normal'
          },
          labelFormat: '{name} <b>{y}</b>{unit}',
        },
        plotOptions: {
            pie: {
                innerSize: '70%',
                borderWidth:1,
                allowPointSelect: false,
                cursor: 'pointer',
                dataLabels: {
                    enabled: true,
                    distance: -10,
                    color: '#6d6d72',
                    style:{
                      fontSize:'11px',
                      fontWeight: 'normal'
                    },
                    connectorColor: '#000000',
                    format: '{point.percentage:.1f} %'
                },
                showInLegend: true
            }
        },
        series: [{
            type: 'pie',
            name: 'VPC',
            data: [{
                    name: '已用',
                    y: parseFloat(data.securityGroupUsed),
                    unit: data.securityGroupUnit,
                    color:"#23b7e5"
                },
                {
                    name: '未用',
                    y: parseFloat(data.securityGroupTotal)-parseFloat(data.securityGroupUsed),
                    unit: data.securityGroupUnit,
                    color:"#fad733"
                }
            ]
        }]
      }); 
    }

    function doHighchartsWarning(data){
      // 资源告警统计
      $("#total_alarm_chart").highcharts({
        chart: {
                type: 'column'
            },
        credits:{ 
            enabled:false
          },
        title: {
            text: '资源告警统计',
            style:{
              fontSize:'12px'
            }
        },
        legend: {
            margin: 10,
            padding: 0,
            itemStyle: {
                fontWeight: 'normal'
            }
        },
        colors:['#39bee8'],
        xAxis: {
            categories: [
                '系统告警','VDC配额告警','云主机告警'
            ]
        },
        yAxis: {
            min: 0,
            gridLineColor: '#eee',
            title: {
                text: '单位 (条)'
            }
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [
          {
              name: '告警数量',
              data: [data.systemAlarm, data.vdcQuotaAlarm, data.vmAlarm]
          }
        ]
      });

    // VDC配额告警统计
    $("#vdc_alarm_chart").highcharts({
        chart: {
                type: 'column'
            },
        credits:{ 
            enabled:false
          },
        title: {
            text: 'VDC配额告警统计',
            style:{
              fontSize:'12px'
            }            
        },
        legend: {
            margin: 10,
            padding: 0,
            itemStyle: {
                fontWeight: 'normal'
            }
        },
        colors:['#f9d21a'],
        xAxis: {
            categories: [
                'CPU','内存','存储','VPC','云主机','云硬盘','对象存储','负载均衡器',
                '公网IP','SSH密钥','路由器','防火墙','安全组','VPN'
            ]
        },
        yAxis: {
            min: 0,
            gridLineColor: '#eee',
            title: {
                text: '单位 (条)'
            }
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0,
            }
        },
        series: [
          {
              name: '告警数量',
              data: [data.cpuAlarmNum, data.memAlarmNum, data.stoAlarmNum, data.vpcAlarmNum, data.vmAlarmNum, 
                     data.volAlarmNum, data.objAlarmNum, data.blaAlarmNum, data.ipAlarmNum, data.sshAlarmNum,
                     data.routerAlarmNum, data.firewallAlarmNum, data.sgAlarmNum, data.vpnAlarmNum]
          }
        ]
      });
    }
    
   
    // 获取用户信息
    function getUserInfo(){
    	 csc.rest.get('api/v5.0.0/homepage/user',function(data){
	  	     if(data == null || data == "" ){
	  	     	return ;
	  	     }
	 	     userId = data.account + "_" + data.roleName;
	  	     roleId = data.roleName;
	  	     getPanelConfig();
    	 });
    }
    	 
   	// 获取用户板块信息
    function getPanelConfig(){
    	csc.rest.get('api/v5.0.0/homeConfigs?state=1&orderBy=displayOrder:asc',function(data){
	     	if(data == null || data == "" || data.results == null || data.results.length==0){
				return ;
	     	}
	     	var results = data.results;
	     	var modelIdMap = {};
	     	$('#setting_box').html('');
	     	for(var i=0;i<results.length;i++){
	     		var record = results[i];
	     		var panelStr =  '<div class="checkbox col-xs-4 widget-container-col">'+
	            				'<label>'+
	              				'<input type="checkbox" index="'+record.modleID+'"><span></span> '+record.homeModleName+
	            				'</label>'+
	            				'</div>';
	            $('#setting_box').append($(panelStr));
	            modelIdMap['dragDiv'+record.modleID]=true;
	     	}
	     	$('.dragDiv').each(function(){
	     		if(modelIdMap[$(this).attr('id')]!=true){
	     			$(this).remove();
	     		}
	     	});
	     	$("#ace-settings-box input[type=checkbox]").change(function() {
	     	    updateList();
	     	});
	     	getDisplayConfig();
    	});
    }
    
	// 获取板块显隐配置
   	function getDisplayConfig(){
        csc.rest.get("api/v5.0.0/homepage/display", function(data){
          if(data != null && data != ""){
            myList = data.displayVisible;
          }
            //localStorage 初始化       start
            if(myList){
              myList = myList
            }else{//初始化
              myList = '{\"data\":[{\"userId\":\"'+userId+'\",\"list\":[{\"index\":1,\"select\":true},{\"index\":2,\"select\":true},{\"index\":3,\"select\":true},{\"index\":4,\"select\":true},{\"index\":5,\"select\":true},{\"index\":6,\"select\":true},{\"index\":7,\"select\":true},{\"index\":8,\"select\":true},{\"index\":9,\"select\":true}]}]}';
              var sequence = DrapCommon.getCookie("configArr");
              csc.rest.post("api/v5.0.0/homepage/display", {
                  displayVisible:myList,
                  dispalySequence: sequence=='undefined'?'':sequence
                }, function(data){
                console.info("保存成功");
              });
            }
            window.localStorage.removeItem("index_list");
          	window.localStorage.setItem("index_list",myList);
          	index_LocalStorage = JSON.parse(window.localStorage.index_list);
            var MY_List = JSON.parse(myList).data[0].list;  
            //配置栏 start
            var settingOptoins = [];
            for(var i=0;i<MY_List.length;i++){
              if(MY_List[i].select){
				if($("#setting_box input[type='checkbox'][index="+MY_List[i].index+"]").length>0){
	                $("#setting_box input[type='checkbox'][index="+MY_List[i].index+"]").attr("checked",true);
				}
              }
            }
            enterList(MY_List);
        });
   	}
	
    //浮动窗配置开始
    var userId = "";
    var roleId = null;
    var myList = null;
	var index_LocalStorage = null;
    $("#index_list_box").css("opacity",1);
   	getUserInfo();
	//浮动窗配置结束

  //解决highchart图标溢出div问题
  function doHighchartInList(item,action){
    if(action == "show"){
      if(item.index == 2 && $("#dragDiv"+item.index).attr('redrawed') != "true"){
    	  viewModel.loadVdcStat();
        $("#dragDiv2").attr("redrawed","true");
      };

      if(item.index == 8 && $("#dragDiv"+item.index).attr('redrawed') != "true"){
    	  viewModel.loadAlarmStat();
        $("#dragDiv8").attr("redrawed","true");
      };
    };
    if(action == "hide"){
      if(item.index == 2){
        $("#dragDiv2").attr("redrawed","false");
      }
      if(item.index == 8){
        $("#dragDiv8").attr("redrawed","false");
      }
    }
  };

  //列表渲染 start
  function enterList(_List){
    //var newListHtml=[];
    for(var i=0;i<_List.length;i++){
      if(_List[i].select){
        $("#dragDiv"+_List[i].index).show();
        doHighchartInList(_List[i],"show");
      }else{
        $("#dragDiv"+_List[i].index).hide();
        doHighchartInList(_List[i],"hide");
      }
    }
    
    // $("#index_list_box").html('');
    // for(var i=0;i<newListHtml.length;i++){
    //   $("#index_list_box").append(newListHtml[i]);
    //   if((i+1)%2==0){
    //     $("#index_list_box").append("<div style='clear:both;'></div>");
    //   }
    // }
  }
  //列表渲染 end

  function updateList(){
    var list=[];
    $("#ace-settings-box input[type=checkbox]").each(function(){
      var sel=false;
      if($(this).is(':checked')){
        sel=true;
      }
      list.push({"index":$(this).attr("index"),"select":sel});
    });
    $.each(index_LocalStorage.data,function(index,value){
      if(value.userId == userId){ 
        index_LocalStorage.data[index].list = list;
      }
    });
    window.localStorage.removeItem("index_list");
    window.localStorage.setItem("index_list",JSON.stringify(index_LocalStorage));
    enterList(list);
    
    //添加到数据库中
    var dataList = JSON.stringify(index_LocalStorage);
    var re = new RegExp('"', "g");
    dataList = dataList.replace(re, '\"');
    //debugger;
      csc.rest.post("api/v5.0.0/homepage/display", {
          displayVisible:dataList,
          dispalySequence:DrapCommon.getCookie("configArr")
        }, function(data){
        console.info("更新成功");
      });
  }

  $('#ace-settings-btn').unbind("click");
  $("#ace-settings-btn").click(function(){ 
    $("#ace-settings-box").toggleClass('open');
  });

  $("#ace-settings-box input[type=checkbox]").change(function() {
    updateList();
  });

  // $('.widget-container-col').sortable({
  //       connectWith: '.widget-container-col',
  //   items:'> label',
  //   handle: ace.vars['touch'] ? 'label' : false,
  //   cancel: '.fullscreen',
  //   opacity:0.8,
  //   revert:true,
  //   forceHelperSize:true,
  //   placeholder: 'widget-placeholder',
  //   forcePlaceholderSize:true,
  //   tolerance:'pointer',
  //   start: function(event, ui) {
  //     //when an element is moved, it's parent becomes empty with almost zero height.
  //     //we set a min-height for it to be large enough so that later we can easily drop elements back onto it
  //     ui.item.parent().css({'min-height':ui.item.height()})
  //     //ui.sender.css({'min-height':ui.item.height() , 'background-color' : '#F5F5F5'})
  //   },
  //   update: function(event, ui) {
  //     ui.item.parent({'min-height':''})
  //     //p.style.removeProperty('background-color');

  //     updateList();
  //   }
  //   });

   //从数据库中数据库中
   csc.rest.get("api/v5.0.0/homepage/display", function(data){
	  if(data != null){
		  DrapCommon.setCookie("configArr", data.dispalySequence);  
	  }
	  var dragTbl = document.getElementById("dragTable");
	  if (DrapCommon.getCookie("configArr")) {
	      var configArr = eval("(" + DrapCommon.getCookie("configArr") + ")");
	      if(configArr != null){
	          for (i = 0; i < dragTbl.rows[0].cells.length; i++) {
	    		  for (j = 0; j < configArr[i].length; j++) {
		              dragTbl.rows[0].cells[i].appendChild(document.getElementById(configArr[i][j]));
		          }  
	    	  }
	      }
	  }
   });
  
  new Drag("titleBar1", "dragDiv1");
  new Drag("titleBar2", "dragDiv2");
  new Drag("titleBar3", "dragDiv3");
  new Drag("titleBar4", "dragDiv4");
  new Drag("titleBar5", "dragDiv5");
  new Drag("titleBar6", "dragDiv6");
  new Drag("titleBar7", "dragDiv7");
  new Drag("titleBar8", "dragDiv8");
  new Drag("titleBar9", "dragDiv9");

  $("#dragDiv3").click(function(event){
	  event.stopPropagation();
  });

  function ViewModel(){
	  var self = this;
	  
	  //--------------------资源管理模块start--------------//
      this.resourceVO = ko.observable({
    	  businessNum: ko.observable(),
    	  vmNum: ko.observable(),
    	  volumeNum: ko.observable(),
    	  routerNum: ko.observable(),
    	  securityGroupNum: ko.observable(),
    	  ipNum: ko.observable(),
    	  loadBalanceNum: ko.observable(),
    	  firewallNum: ko.observable(),
    	  sshNum: ko.observable(),
    	  objStorageNum: ko.observable(),
    	  role: ko.observable()
      });
	  
      this.vmUri = ko.observable();//云主机
      this.volumeUri = ko.observable();//云硬盘
//    this.routerUri = ko.observable();//路由器
//    this.securityGroupUri = ko.observable();//安全组
      this.ipUri = ko.observable();//公网IP
      this.loadBalanceUri = ko.observable();//负载均衡
//    this.firewallUri = ko.observable();//防火墙
      this.sshUri = ko.observable();//ssh密钥
      this.objStorageUri = ko.observable();//对象存储
      
      //订单更多URI
      this.orderUri = ko.observable();
      
      //加载资源管理统计信息
      this.loadResourceStat = function(){
    	  csc.rest.get("api/v5.0.0/homepage/resource", function(data){
    		  self.resourceVO().businessNum(data.businessNum);
    		  self.resourceVO().vmNum(data.vmNum);
    		  self.resourceVO().volumeNum(data.volumeNum);
    		  self.resourceVO().routerNum(data.routerNum);
    		  self.resourceVO().securityGroupNum(data.securityGroupNum);
    		  self.resourceVO().ipNum(data.ipNum);
    		  self.resourceVO().loadBalanceNum(data.loadBalanceNum);
    		  self.resourceVO().firewallNum(data.firewallNum);
    		  self.resourceVO().sshNum(data.sshNum);
    		  self.resourceVO().objStorageNum(data.objStorageNum);
    		  self.resourceVO().role(data.role);
    		  
    		  if("普通用户" == data.role){
    			  //云主机、云硬盘、对象存储、负载均衡器、公网IP、SSH密钥；
    			  self.vmUri("#pages/resources/instances/index?type=0");
    			  self.volumeUri("#pages/resources/instances/index?type=1");
    			  self.ipUri("#pages/resources/instances/index?type=2");
    			  self.loadBalanceUri("#pages/resources/instances/index?type=3");
    			  self.sshUri("#pages/resources/instances/index?type=4");
    			  self.objStorageUri("#pages/resources/instances/index?type=5");
    			  self.orderUri("#pages/orders/service_orders");
    		  } else{
    			  self.vmUri("#pages/resources/instances/index?showTab=vmsTab");
    			  self.volumeUri("#pages/resources/instances/index?showTab=storagesTab");
    			  self.ipUri("#pages/resources/instances/index?showTab=publicipsTab");
    			  self.loadBalanceUri("#pages/resources/instances/index?showTab=balancerTab");
    		      self.sshUri("#pages/resources/instances/index?showTab=sshkeysTab");
    		      self.objStorageUri("#pages/resources/instances/index?showTab=objectStoragesTab");
    		      self.orderUri("#pages/orders/service_orders?type=order");
    		  }
   	      });
      }
      this.loadResourceStat();
      
      this.resourceIsvisible = function(role){
    	  console.log(role());
    	  if("普通用户" == role()){
    		  return false;
    	  }
    	  return true;
      }
      
	  //--------------------资源管理模块end--------------//
	  
	  //--------------------最新通知模块start--------------//
      this.noticeList = ko.observableArray([]);
      //加载通知列表
      csc.rest.get("api/v5.0.0/homepage/notice?firstResult=0&maxResult=5", function(data){
    	  self.noticeList(data.results);
      });
      
      this.noticeStateShow = function(noticeState){
    	  switch(noticeState){
	    	  case "YesRealize":
	    		  return "已阅";
	    	  case "NoRealize":
	    		  return "未阅";
    	  }
      }
      
      //通知状态颜色
      this.noticeStateClass = function(noticeState){
    	  switch(noticeState){
	    	  case 1:
	    		  return "bg-light";
	    	  case 2:
	    		  return "bg-dark";
    	  }
      }
	  //--------------------最新通知模块end--------------//
      
      //--------------------数据中心资源模块start--------------//
      //加载数据中心列表
	  self.dcList = ko.observableArray();
      csc.rest.get("api/v5.0.0/homepage/datacenter", function(data){
     	 self.dcList(data);
      },function(){},null,true);
      
      //默认没有选中
      this.selectedDc = ko.observable("");
      
      var dcStatisticsInfo = function(){
    	  this.azNum = ko.observable("");
    	  this.azNumCnware = ko.observable("");
    	  this.azNumOpenstack = ko.observable("");
    	  this.vmNum = ko.observable("");
    	  this.vmNumAlive = ko.observable("");
    	  this.vmNumStopped = ko.observable("");
    	  this.vmNumOther = ko.observable("");
    	  this.resourcePoolNum = ko.observable("");
    	  this.hostNum = ko.observable("");
    	  this.storageNum = ko.observable("");
    	  this.networkNum = ko.observable("");
    	  this.imageNum = ko.observable("");
    	  this.cpuNum = ko.observable("");
    	  this.memorySize = ko.observable("");
    	  this.storageSize = ko.observable("");
    	  this.storagePoolNum = ko.observable("");
      }
      
      //网络 / IP池
      this.netWorkTextName=ko.observable("");
      this.netWorkTextName("网络");
      
      //资源池
      this.isShowResourcePool=ko.observable();
      this.isShowResourcePool(true);
      
      this.dcStatistics = ko.observable(new dcStatisticsInfo());
      
      this.storageSize = ko.observable("");
      this.memorySize = ko.observable("");
      
      this.dcStatResult = ko.observable("");
      
      //加载数据中心统计信息
      this.loadDCStatistics = function(obj){
    	  self.dcStatResult("");
    	  if(self.selectedDc() && self.selectedDc().cloudPlatform == "OpenStack"){
    		  self.netWorkTextName("网络");
    		  self.isShowResourcePool(false);
    	  }else if(self.selectedDc() && self.selectedDc().cloudPlatform == "CNware"){
    		  self.netWorkTextName("IP池");
    		  self.isShowResourcePool(true);
    	  }else{
    		  self.netWorkTextName("网络");
    		  self.isShowResourcePool(true);
    	  }
    	  
    	  var url = "api/v5.0.0/homepage/datacenter";
    	  if(self.selectedDc()){
    		  url += ("/"+self.selectedDc().uuid);
    	  }else{
    		  url += ("/-1");
    	  }
    	  csc.rest.get(url, function(data){
    		  self.dcStatistics(data);
    		  self.storageSize((data.storageSize?data.storageSize:0)+"GB");
    		  self.memorySize((data.memorySize?data.memorySize:0)+"TB");
    		  if(data){
    			  self.dcStatResult("");
    		  }else{
    			  self.dcStatResult("统计错误！");
    		  }
    	  },function(){},null,true);
      }
      this.loadDCStatistics();
      //--------------------数据中心资源模块end--------------//
      
      //--------------------最新订单模块start--------------//
      this.orderList = ko.observableArray([]);
      //加载订单列表
      csc.rest.get("api/v5.0.0/homepage/order?orderBy=createTime:desc&firstResult=0&maxResult=5", function(data){
     	 self.orderList(data);
      });
      
      //翻译步骤
      this.orderState = function(state){
    	  switch(state){
    	  case 'UNSUBMIT':
    		  return "未提交";
    	  case 'DOING':
    		  return "审批中";
    	  case 'FINISHED':
    		  return "审批完成";
    	  }
      };
      //步骤不同颜色不同
      this.orderStateCss = function(state){
    	  switch(state){
    	  case 'UNSUBMIT':
    		  return "bg-danger";
    	  case 'DOING':
    		  return "bg-info";
    	  case 'FINISHED':
    		  return "bg-success";
    	  }
      };
      //--------------------最新订单模块end--------------//
      
      //-------------------总体告警统计start--------------//
      this.doHighchartsWarning = doHighchartsWarning;
      //加载总体告警统计信息
      this.loadAlarmStat = function(){
    	  csc.rest.get("api/v5.0.0/homepage/alarmStat", function(data){
    		  self.doHighchartsWarning(data);
   	      });
      }
      this.loadAlarmStat();
      
      //-------------------总体告警统计end----------------//
      
      //--------------------最近告警模块start--------------//
      this.alarmInfoVO = ko.observableArray([]);
      //加载告警列表
      csc.rest.get("api/v5.0.0/homepage/alarmInfo?firstResult=0&maxResult=5&alarmInfoStatus=2", function(data){
     	 self.alarmInfoVO(data);
      });
      //告警状态不同颜色不同
   	  this.alarmStateCss = function(index){
    	  var state = index%5;
       	  switch(state){
	       	  case 1:
	       		  return "";
	       	  case 2:
	       		  return "b-warning";
	       	  case 3:
	     		  return "b-primary";
	       	  case 4:
	     		  return "b-success";
	       	  case 0:
	     		  return "b-info";
       	  }
      };
   	  //--------------------最新告警模块end--------------//
   	  
   	  //--------------------我的任务模块start--------------//
   	  this.taskStat = ko.observableArray();
   	  //加载我的任务统计信息
      csc.rest.get("api/v5.0.0/workflows/tasks/counts", function(data){
     	 self.taskStat(data);
      });
   	  
   	  //--------------------我的任务模块end--------------//
   	  
    //--------------------VDC配额模块start------------//
   	  //加载VDC列表
	  this.vdcList = ko.observableArray();
      csc.rest.get("api/v5.0.0/homepage/vdcs", function(data){
     	  self.vdcList(data);
      	  self.loadVdcStat();
      });
      this.selectedVdc = ko.observable();
      //加载VDC配额信息
      this.vdcQuotaVO = ko.observable({
    	  cpu: ko.observable(),
    	  mem: ko.observable(),
    	  sto: ko.observable(),
    	  vm: ko.observable(),
    	  disk: ko.observable(),
    	  obj: ko.observable(),
    	  router: ko.observable(),
    	  firewall: ko.observable(),
    	  secgroup: ko.observable(),
    	  vpcA: ko.observable(),
    	  vpcB: ko.observable(),
    	  vpcRate: ko.observable(),
    	  blaA: ko.observable(),
    	  blaB: ko.observable(),
    	  blaRate: ko.observable(),
    	  ipA: ko.observable(),
    	  ipB: ko.observable(),
    	  ipRate: ko.observable(),
    	  sshA: ko.observable(),
    	  sshB: ko.observable(),
    	  sshRate: ko.observable(),
    	  vpnA: ko.observable(),
    	  vpnB: ko.observable(),
    	  vpnRate: ko.observable()
      });
      this.doHighchartsVDC = doHighchartsVDC;
      this.loadVdcStat = function(){
    	  var url = "api/v5.0.0/homepage/vdcQuota?vdcUuid="+self.selectedVdc();
    	  csc.rest.get(url, function(data){
    		  self.doHighchartsVDC(data);
    		  self.vdcQuotaVO().cpu(parseFloat(data.cpuTotal)+""+data.cpuUnit);
    		  self.vdcQuotaVO().mem(parseFloat(data.memTotal)+""+data.memUnit);
    		  self.vdcQuotaVO().sto(parseFloat(data.stoTotal)+""+data.stoUnit);
    		  self.vdcQuotaVO().vm(parseFloat(data.vmTotal)+""+data.vmUnit);
    		  self.vdcQuotaVO().disk(parseFloat(data.diskTotal)+""+data.diskUnit);
    		  self.vdcQuotaVO().obj(parseFloat(data.objTotal)+""+data.objUnit);
    		  self.vdcQuotaVO().router(parseFloat(data.routerTotal)+""+data.routerUnit);
    		  self.vdcQuotaVO().firewall(parseFloat(data.firewallTotal)+""+data.firewallUnit);
    		  self.vdcQuotaVO().secgroup(parseFloat(data.securityGroupTotal)+""+data.securityGroupUnit);
    		  self.vdcQuotaVO().vpcA(parseFloat(data.vpcTotal)+""+data.vpcUnit);
    		  self.vdcQuotaVO().vpcB(parseFloat(data.vpcUsed)+"/"+(parseFloat(data.vpcTotal)-parseFloat(data.vpcUsed))+"("+data.vpcUnit+")");
    		  self.vdcQuotaVO().vpcRate(parseFloat(data.vpcTotal)==0?'0%':Math.round(parseFloat(data.vpcUsed)/parseFloat(data.vpcTotal)*10000)/100+"%");
    		  self.vdcQuotaVO().blaA(parseFloat(data.blaTotal)+""+data.blaUnit);
    		  self.vdcQuotaVO().blaB(parseFloat(data.blaUsed)+"/"+(parseFloat(data.blaTotal)-parseFloat(data.blaUsed))+"("+data.blaUnit+")");
    		  self.vdcQuotaVO().blaRate(parseFloat(data.blaTotal)==0?'0%':Math.round(parseFloat(data.blaUsed)/parseFloat(data.blaTotal)*10000)/100+"%");
    		  self.vdcQuotaVO().ipA(parseFloat(data.ipTotal)+""+data.ipUnit);
    		  self.vdcQuotaVO().ipB(parseFloat(data.ipUsed)+"/"+(parseFloat(data.ipTotal)-parseFloat(data.ipUsed))+"("+data.ipUnit+")");
    		  self.vdcQuotaVO().ipRate(parseFloat(data.ipTotal)==0?'0%':Math.round(parseFloat(data.ipUsed)/parseFloat(data.ipTotal)*10000)/100+"%");
    		  self.vdcQuotaVO().sshA(parseFloat(data.sshTotal)+""+data.sshUnit);
    		  self.vdcQuotaVO().sshB(parseFloat(data.sshUsed)+"/"+(parseFloat(data.sshTotal)-parseFloat(data.sshUsed))+"("+data.sshUnit+")");
    		  self.vdcQuotaVO().sshRate(parseFloat(data.sshTotal)==0?'0%':Math.round(parseFloat(data.sshUsed)/parseFloat(data.sshTotal)*10000)/100+"%");
    		  self.vdcQuotaVO().vpnA(parseFloat(data.vpnTotal)+""+data.vpnUnit);
    		  self.vdcQuotaVO().vpnB(parseFloat(data.vpnUsed)+"/"+(parseFloat(data.vpnTotal)-parseFloat(data.vpnUsed))+"("+data.vpnUnit+")");
    		  self.vdcQuotaVO().vpnRate(parseFloat(data.vpnTotal)==0?'0%':Math.round(parseFloat(data.vpnUsed)/parseFloat(data.vpnTotal)*10000)/100+"%");
    	  });
      }
   	  //--------------------VDC配额模块end--------------//
  }
  var viewModel = new ViewModel();
  ko.applyBindings(viewModel,$('#page-content')[0]);
});
</script>