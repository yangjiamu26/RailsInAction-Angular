<script src='assets/js/jquery-form.js'></script>
<div class="bg-light lter b-b wrapper-sm">
  <ol class="breadcrumb">
    <li>当前位置：</li>
    <li>资源</li>
    <li><a href="#pages/resources/partitions/index">可用分区</a></li>
    <li class="active" id="positionInfoDIV"><span data-bind="text:azName"></span></li>
  </ol>
</div>
<div class='wrapper-md'>
  <div class='nav-tabs-alt bg-white-only b b-blue'>
    <ul class='nav nav-tabs' role='tablist' id="partitionsTabs">
      <li class='active' role='presentation'>
        <a aria-controls='partition_summary' data-toggle='tab' href='#partition_summary' role='tab'>摘要</a></li>
      <li role='presentation' data-bind="visible:activeTab() == 'CNware'">
        <a aria-controls='partition_pools' data-toggle='tab' href='#partition_pools' role='tab'>资源池</a></li>
      <li role='presentation'>
        <a aria-controls='partition_hosts' data-toggle='tab' href='#partition_hosts' role='tab'>物理机</a></li>
      <li role='presentation' data-bind="visible:activeTab() == 'CNware'">
        <a aria-controls='partition_storages' data-toggle='tab' href='#partition_storages' role='tab'>存储池</a></li>
      <li role='presentation'>
        <a aria-controls='partition_images' data-toggle='tab' id="iso_tab" href='#partition_images' role='tab'>镜像</a></li>
      <li role='presentation'>
        <a aria-controls='partition_network_externals' data-toggle='tab' id="network_tab" href='#partition_network_externals' role='tab'>网络</a></li>
      <!-- <li role='presentation'>
        <a aria-controls='partition_network_externals_topo' data-toggle='tab' href='#partition_network_externals_topo' role='tab'>拓扑</a></li> -->
      <li role='presentation' data-bind="visible:activeTab() == 'CNware'">
        <a aria-controls='partition_ip_pools' data-toggle='tab' href='#partition_ip_pools' role='tab'>IP池</a></li>
      <li role='presentation'>
        <a aria-controls='partition_task' data-toggle='tab' href='#partition_task' role='tab'>调度任务</a></li>
    </ul>
    <div class='tab-content'>
      <div class='tab-pane active' id='partition_summary' role='tabpanel'>
        <div class="wrapper">
            <a href="#pages/resources/partitions/index" class="btn btn-sm btn-default"><i class="fa fa-arrow-left"></i> 返回</a>
            <button class="btn btn-sm btn-info" data-bind="click: editAZInfo">修改</button>
            <button class="btn btn-sm btn-info" data-bind="click: deleteAZ">删除</button>
        </div>      
        <div class="row">
          <div class="col-xs-6">

            <div class="wrapper">
                <h5 class="text-black"><i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息</h5>
                <div class="bg-light b-t b-b wrapper-sm">
                  <div class="row m-b">
                    <div class="col-xs-2 font-bold text-nowrap">名称：</div>
                    <div class="col-xs-4" data-bind="text:azInfoVO().name"></div>
                    <div class="col-xs-2 font-bold text-nowrap">数据中心：</div>
                    <div class="col-xs-4" data-bind="text:azInfoVO().datacenterName"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-2 font-bold text-nowrap">云管理平台：</div>
                    <div class="col-xs-4" data-bind="text:azInfoVO().cloudplatformName"></div>
                    <div class="col-xs-2 font-bold text-nowrap">创建时间：</div>
                    <div class="col-xs-4" data-bind="text:azInfoVO().createTime"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-2 font-bold text-nowrap">描述：</div>
                    <div class="col-xs-10" data-bind="text:azInfoVO().description"></div>
                  </div>
                 </div>          
            </div>          

            <div class="wrapper">
              <div class="row">
                   <!--
                <div class="col-xs-6">
                  <div>
                    <span class="pull-right h4 text-success">30%</span>
                    <span class="h4">资源池 (3/10)</span>
                  </div>
                  <div class="progress progress-xxs m-t-sm">
                    <div class="progress-bar progress-bar-success" style="width: 30%;">
                    </div>
                  </div>
                </div>
                <div class="col-xs-6">
                  <div>
                    <span class="pull-right h4 text-warning">70%</span>
                    <span class="h4">存储 (70/100)</span>
                  </div>
                  <div class="progress progress-xxs m-t-sm">
                    <div class="progress-bar progress-bar-warning" style="width: 70%;">
                    </div>
                  </div>
                </div>
           
                <div class="col-xs-6">
                  <div>
                    < ! - - <span class="pull-right h4 text-danger">90%</span> - - >
                    <span class="h4">网络 <span data-bind="text:azSummaryVO().networkNum"></span></span>
                  </div>
                  <div class="progress progress-xxs m-t-sm">
                    <div class="progress-bar progress-bar-danger" style="width: 100%;">
                    </div>
                  </div>                
                </div>
                <div class="col-xs-6">
                  <div>
                    < ! - - <span class="pull-right h4 text-success">30%</span> - - >
                    <span class="h4">镜像<span data-bind="text:azSummaryVO().imageNum"></span> </span>
                  </div>
                  <div class="progress progress-xxs m-t-sm">
                    <div class="progress-bar progress-bar-success" style="width: 100%;">
                    </div>
                  </div>                
                </div>
                 -->
              <!-- 
              <div class="col-xs-4">
                <div class="media">
                  <div class="media-left resourceIco">
                  </div>
                  <div class="media-body">
                    <h5 class="media-heading">资源池</h5>
                    <div><span>0</span></div>
                  </div>
                </div>        
              </div>
               -->
               <div class="col-xs-4">
               
                <div class="media">
                  <div class="media-left hostIco">
                   
                  </div>
                  <div class="media-body">
                    <h5 class="media-heading">物理机</h5>
                    <div><span data-bind="text:azSummaryVO().hostNum"></span></div>
                  </div>
                </div>        
              </div>
              <div class="col-xs-4">
	                <div class="media">
	                  <div class="media-left mirrorIco">
	                  </div>
	                  <div class="media-body">
	                    <h5 class="media-heading">镜像</h5>
	                    <div><span data-bind="text:azSummaryVO().imageNum"></span></div>
	                  </div>
              		</div>        
              	</div>
                <div class="col-xs-4">
                	<div class="media">
                  		<div class="media-left netIco">
                  	</div>
                  	<div class="media-body">
	                    <h5 class="media-heading">网络</h5>
	                    <div><span data-bind="text:azSummaryVO().networkNum"></span></div>
                  	</div>
                	</div>        
              </div>
              <!--
              <div class="col-xs-4">
               
                <div class="media">
                  <div class="media-left storageIco">
                   
                  </div>
                  <div class="media-body">
                    <h5 class="media-heading">存储池</h5>
                    <div><span>0</span></div>
                  </div>
                </div>        
              </div>
             -->

              </div>
              <div class="row" style="padding-top:15px;">
                
              </div>
            </div> 
            
          </div>
          <div class="col-xs-6">
            <div class="row text-center">
              <div class="col-xs-4">
                <h3>CPU</h3>
                <h5>总量：<span data-bind="text:azSummaryVO().cpuTotal"></span>Hz</h5>
                <div class='inline m-t m-b-xs easyPieChart' data-bind="ui: {jq: 'easyPieChart', options: {percent: 50,lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'} }">
                  <div>
                    <span class='text-success h4'><span data-bind="text:azSummaryVO().cpuUseRate"></span>%</span></div>
                </div>
                <div class="text-primary-lt">
                  <div class="inline m-a text-left l-h-2x">已用：<span data-bind="text:azSummaryVO().cpuAvail"></span>GHz<br/>未用：<span data-bind="text:azSummaryVO().cpuAllocated"></span>Hz</div>    
                </div>            
              </div>
              <div class="col-xs-4">
                <h3>內存</h3>
                <h5>总量：<span data-bind="text:azSummaryVO().memoryTotal"></span>GB</h5>
                <div class='inline m-t m-b-xs easyPieChart' ui-jq='easyPieChart' ui-options="{percent: 59.7,lineWidth: 4,trackColor: '#e8eff0',barColor: '#fad733',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}">
                  <div>
                    <span class='text-warning h4'><span data-bind="text:azSummaryVO().memoryUseRate"></span>%</span></div>
                </div>
                <div class="text-primary-lt">
                  <div class="inline m-a text-left l-h-2x">已用：<span data-bind="text:azSummaryVO().memoryAvail"></span>GB<br/>未用：<span data-bind="text:azSummaryVO().memoryAllocated"></span>GB</div>     
                </div>           
              </div>
              <div class="col-xs-4">
                <h3>存储</h3>
                <h5>总量：<span data-bind="text:azSummaryVO().storageTotal"></span>GB</h5>
                <div class='inline m-t m-b-xs easyPieChart' ui-jq='easyPieChart' ui-options="{percent: 59.7,lineWidth: 4,trackColor: '#e8eff0',barColor: '#f05050',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}">
                  <div>
                    <span class='text-danger h4'><span data-bind="text:azSummaryVO().storageUseRate"></span>%</span></div>
                </div>
                <div class="text-primary-lt">
                  <div class="inline m-a text-left l-h-2x">已用：<span data-bind="text:azSummaryVO().storageAvail"></span>GB<br/>未用：<span data-bind="text:azSummaryVO().storageAllocated"></span>GB</div> 
                </div>               
              </div>
            </div>
                       
          </div>
        </div>
        
        <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAzEdit }">
      <div class='modal-dialog'>
        <div class='modal-content'>
          <div class='modal-header'>
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button>
            <h3 class='modal-title'>修改可用分区</h3>
          </div>
          <div class='modal-body form-horizontal row' data-bind="with:azInfoVO()">
            <div class="form-group">
              <label class="col-xs-3 control-label">名称</label>
              <div class="col-xs-8">
                <input type="email" class="form-control" placeholder="请输入名称" data-bind="value:name">
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>          
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">数据中心</label>
              <div class="col-xs-8">
                <select class="form-control" data-bind="value:datacenterUuid, options: $root.dcs, optionsText: 'name', optionsValue: 'uuid',attr:{disabled:id}">
                  <option value="1">1</option>
                  <option value="2">2</option>
                </select>
              </div>
              <div class="col-xs-1">
                <span class="text-danger inline m-l-n m-t-sm">*</span>
              </div>          
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">云管理平台</label>
              <div class="col-xs-8">
                <select class="form-control" data-bind="value:cloudplatformUuid, options: $root.cloudPlatforms, optionsText: 'name', optionsValue: 'uuid',attr:{disabled:id}">
                  <option value="1">1</option>
                  <option value="2">2</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">虚拟化类型</label>
              <div class="col-xs-8">
                <select class="form-control" data-bind="value:virtualHypervisor, options: $root.virtualHypervisors, optionsText: 'name', optionsValue: 'name',attr:{disabled:id}">
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">是否独占</label>
              <div class="col-xs-8">
                <select class="form-control" data-bind="value:isPrivate">
                  <option value="1">是</option>
                  <option value="0">否</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">描述</label>
              <div class="col-xs-8">
                <textarea class="form-control" cols="30" rows="3" data-bind="value:description"></textarea>
              </div>
            </div>
          </div>
          <div class='modal-footer' style="text-align:center;">
            <a class="btn btn-default btn-info" data-bind="click:saveAzInfo">确定</a>
            <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
          </div>
        </div>
      </div>
    </div>
      
      </div>
      <div class='tab-pane' id='partition_pools' role='tabpanel'>
        <div class='panel panel-default'>
          <div class="row wrapper">
            <div class="col-xs-9">

            </div>
            <div class="col-xs-3">
              <div class="input-group">
                <input type="text" class="input-sm form-control" placeholder="请输入名称">
                <span class="input-group-btn">
                  <button class="btn btn-sm btn-default" type="button">搜索</button>
                </span>
              </div>
            </div>
          </div>        
          <div id='resource_pools'>
            <div class='table-responsive'>
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>名称</th>
                    <th>数据中心</th>
                    <th>云管理平台</th>
                    <th>CPU颗数</th>
                    <th>内存</th>
                    <th>存储</th>
                    <th>物理主机数</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>
                      <a href="#" onclick="$('#resource_pool_detail').show().siblings().hide();">Pool1</a></td>
                    <td>云宏数据中心</td>
                    <td>cnware1</td>
                    <td>12</td>
                    <td>128GB</td>
                    <td>1024GB</td>
                    <td>3</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <footer class='panel-footer'>
              <ul class="pagination">
                <li class="page active">
                  <a href="#pages/javascript:void(0)">1</a></li>
                <li class="page">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_hosts=2">2</a></li>
                <li class="page">
                  <a href="#pages/?locale=zh-CN&amp;page_hosts=3">3</a></li>
                <li class="next">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_hosts=2">下页 &rsaquo;</a></li>
                <li class="last">
                  <a href="#pages/?locale=zh-CN&amp;page_hosts=3">末页 &raquo;</a></li>
              </ul>
            </footer>            
          </div>
          <!-- 资源池详情 -->
          <div id="resource_pool_detail" style="display: none">
            <div class="wrapper">
              <button class="btn btn-sm btn-default" onclick="$('#resource_pools').show().siblings().hide();"><i class="fa fa-arrow-left"></i> 返回</button>              
            </div>
            <div class="row">
              <div class="col-xs-6">
                <div class="wrapper">
                    <h5 class="text-black"><i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息</h5>
                    <div class="bg-light b-t b-b wrapper-sm">
                      <div class="row m-b">
                        <div class="col-xs-2 font-bold text-nowrap">名称</div>
                        <div class="col-xs-4">Pool1</div>
                        <div class="col-xs-2 font-bold text-nowrap">数据中心：</div>
                        <div class="col-xs-4">数据中心一</div>
                      </div>
                      <div class="row m-b">
                        <div class="col-xs-2 font-bold text-nowrap">云管理平台：</div>
                        <div class="col-xs-4">winserver6.0</div>
                        <div class="col-xs-2 font-bold text-nowrap">可用分区：</div>
                        <div class="col-xs-4">XX可用分区</div>
                      </div>
                      <div class="row m-b">
                        <div class="col-xs-2 font-bold text-nowrap">CPU颗数：</div>
                        <div class="col-xs-4">4</div>
                        <div class="col-xs-3 font-bold text-nowrap">CPU逻辑单元数：</div>
                        <div class="col-xs-3">2</div>
                      </div>
                      <div class="row m-b">
                        <div class="col-xs-2 font-bold text-nowrap">内存(GB)：</div>
                        <div class="col-xs-4">128</div>
                        <div class="col-xs-2 font-bold text-nowrap">存储(GB)：</div>
                        <div class="col-xs-4">800</div>
                      </div>
                      <div class="row m-b">
                        <div class="col-xs-2 font-bold text-nowrap">描述：</div>
                        <div class="col-xs-10">主要内容</div>
                      </div>
                     </div>          
                </div>                          
              </div>
              <div class="col-xs-6">
                <div class="row text-center">
                  <div class="col-xs-4">
                    <h3>CPU</h3>
                    <h5>总量：12.37GHz</h5>
                    <div class='inline m-t m-b-xs easyPieChart' ui-jq='easyPieChart' ui-options="{percent: 16.68,lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}">
                      <div>
                        <span class='text-success h4'>16.68%</span></div>
                    </div>
                    <div class="text-primary-lt m-t">
                      <div class="inline m-a text-left l-h-2x">已用：2.06GHz<br/>未用：10.31GHz</div>
                    </div>                
                  </div>
                  <div class="col-xs-4">
                    <h3>內存</h3>
                    <h5>总量：188.75GB</h5>
                    <div class='inline m-t m-b-xs easyPieChart' ui-jq='easyPieChart' ui-options="{percent: 59.7,lineWidth: 4,trackColor: '#e8eff0',barColor: '#fad733',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}">
                      <div>
                        <span class='text-warning h4'>79.7%</span></div>
                    </div>
                    <div class="text-primary-lt m-t">
                      <div class="inline m-a text-left l-h-2x">已用：142.64GB<br/>未用：46.11GB<br/>已分配：146.11GB</div>
                    </div>                
                  </div>
                  <div class="col-xs-4">
                    <h3>存储</h3>
                    <h5>总量：8.54TB</h5>
                    <div class='inline m-t m-b-xs easyPieChart' ui-jq='easyPieChart' ui-options="{percent: 59.7,lineWidth: 4,trackColor: '#e8eff0',barColor: '#f05050',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}">
                      <div>
                        <span class='text-danger h4'>90.7%</span></div>
                    </div>
                    <div class="text-primary-lt m-t">
                      <div class="inline m-a text-left l-h-2x">已用：7.02TB<br/>未用：1.52TB<br/>已分配：1.02TB</div>
                    </div>                
                  </div>
                </div>

                           
              </div>
            </div>
          </div>          



        </div>
      </div>
      <!-- 物理主机Tab -->
      <div class='tab-pane' id='partition_hosts' role='tabpanel'>
        <div class='panel panel-default'>
          <!-- 物理主机列表页面 -->
          <div id='resource_hosts' data-bind="visible: !isShowDetail()">
            <!-- 搜索栏 -->
            <div class="row wrapper">
              <div class="col-xs-9">
                <div class="input-group w-sm" data-bind="visible: isCNware">
                  <span class="input-group-addon">状态</span>
                  <select class="form-control input-sm" data-bind="value: searchParam().state">
                    <option value="0">运行中</option>
                    <option value="1">状态2</option>
                    <option value="2">状态3</option>
                    <option value="3">状态4</option>
                  </select>
                </div>                
              </div>
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入名称"  data-bind="value: searchParam().hostNameLike">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button" data-bind="click: search">搜索</button>
                  </span>
                </div>
              </div>
            </div> 
            <!-- 物理主机列表 -->          
            <div class='table-responsive'  data-bind="with: hostsTable">
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>主机名称</th>
                    <th>IP地址</th>
                    <th>可用分区</th>
                    <th data-bind="visible: $root.isCNware">状态</th>
                    <th data-bind="visible: $root.isCNware">资源池</th>
                    <th>cpu</th>
                    <th>内存</th>
                    <th>存储</th>
                    <th data-bind="if: $root.isCNware">操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr data-bind="visible: showNoData">
                  <td colspan=9 class="aligncenter">
                     暂无数据
                  </td>
              </tr>
              <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
                  <tr>
                    <td>
                      <a href="#" data-bind="click: $root.showDetailFun"><span data-bind="text: $row.hostName"></span></a>
                    </td>
                    <td data-bind="text: $row.ip"></td>
                    <td data-bind="text: $row.azName"></td><!-- 可用分区 -->
                    <td data-bind="visible: false"><span class="label label-success" data-bind="text: $row.state">运行中</span></td>
                    <td data-bind="visible: false"></td>
                    <td data-bind="text: $row.totalLogicalCpu_"></td>
                    <td data-bind="text: $row.totalMemory_"></td>
                    <td data-bind="text: $row.totalStorage_"></td>
                    <td data-bind="if: $root.isCNware">
                      <a href="#" data-bind="visible: false">进入维护模式</a><!-- | -->
                      <div class="btn-group" data-bind="visible: false">
                        <a class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">更多<span class="fa fa-caret-down"></span>
                        </a>
                        <ul style="right:0;min-width:50px;left:auto;" class="dropdown-menu">
                          <li>
                            <a href="#" data-bind="visible: false">开机</a>
                            <a href="#" data-bind="visible: false">关机</a>
                            <a href="#" data-bind="visible: false">重启</a>
                          </li>
                        </ul>
                      </div>
                    </td>
                   </tr>
                   <!-- /ko -->
                </tbody>
              </table>
            </div>
            <!-- 物理主机分页控件 -->
            <footer class="panel-footer" data-bind="with: hostsTable, visible: hostsTable.pages() > 1">
              <ul class="pagination">
		        <li data-bind="css: leftPagerClass, click: gotoPage(1)">
		          <a href="#">首页</a>
		        </li>
		        <li data-bind="css: leftPagerClass, click: prevPage">
		          <a href="#">&laquo;</a>
		        </li>
		        <li >
		          <a href="#"  data-bind="text: currentPage"></a>
		        </li>
		        <li data-bind="css: rightPagerClass, click: nextPage">
		          <a href="#">&raquo;</a>
		        </li>
		        <li data-bind="css: rightPagerClass, click: gotoPage(pages())">
		          <a href="#">末页</a>
		        </li>
		        <li class="page-control-li">
		          <div class="input-group form-group-sm">
		            <input type="text" class="form-control" data-bind="value: targetPage"  />
		            <div class="input-group-btn">
		              <a href="#" class="btn btn-sm btn-default" data-bind="click: gotoTargetPage()">跳转</a>
		            </div>
		          </div>
		          <div class="page-info-div" data-bind="text: recordsText"></div>
		        </li>
		      </ul>
       	  </footer>
          </div>
          <!-- 物理主机详情页面 -->
          <div id="resource_host_detail"  data-bind="visible: isShowDetail()">
            <div class="wrapper">
              <button class="btn btn-sm btn-default" data-bind="click: $root.showDetailFun"><i class="fa fa-arrow-left"></i> 返回</button>              
            </div>        
            <div class="row wrapper">
              <div class="col-xs-3">
                <h5 class="text-black"><i class="fa fa-minus fa-rotate-90 text-info"></i>基本信息</h5>
                <div class="bg-light b-t b-b wrapper-sm">
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">所属资源池：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().resourcePoolName"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">名称：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().hostName"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">虚拟机数：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().vmNumber">100台</div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">状态：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().state_"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">主机IP：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().ip"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-5 font-bold text-nowrap">运行时长：</div>
                    <div class="col-xs-7" data-bind="text: hostVo().runningTime"></div>
                  </div>
                 </div>   

              </div>
              <div class="col-xs-3">
                <h5 class="text-black"><i class="fa fa-minus fa-rotate-90 text-info"></i>CPU配置</h5>
                <div class="bg-light b-t b-b wrapper-sm">
                  <div class="row m-b">
                    <div class="col-xs-4 font-bold text-nowrap">CPU主频：</div>
                    <div class="col-xs-8" data-bind="text: hostVo().totalCpu"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-4 font-bold text-nowrap">CPU型号：</div>
                    <div class="col-xs-8" data-bind="text: hostVo().model"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-4 font-bold text-nowrap">供应商：</div>
                    <div class="col-xs-8" data-bind="text: hostVo().vendor"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-6 font-bold text-nowrap">CPU颗数：</div>
                    <div class="col-xs-6" data-bind="text: hostVo().cpuNum"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-6 font-bold text-nowrap">CPU逻辑单元数：</div>
                    <div class="col-xs-6" data-bind="text: hostVo().totalLogicalCpu"></div>
                  </div>
                  <div class="row m-b">
                    <div class="col-xs-6 font-bold text-nowrap">运行VCPU个数：</div>
                    <div class="col-xs-6" data-bind="text: hostVo().usedVcpu"></div>
                  </div>
                 </div>                          
              </div>
              <div class="col-xs-6">
                <div class="row text-center">
                  <div class="col-xs-4">
                    <h3>CPU</h3>
                    <h5>总量：<span data-bind="text: hostVo().totalCpu_"></span></h5>
                    <div class='inline m-t m-b-xs easyPieChart' data-bind="ui: {jq: 'easyPieChart', options: {percent: hostVo().usedVcpuRate, lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'} }">
                      <div>
                        <span class='text-success h4'  data-bind="text: hostVo().usedVcpuRate_"></span></div>
                    </div>
                    <div class="text-primary-lt">
                      <div class="inline m-a text-left l-h-2x">
                          	已用：<span data-bind="text: hostVo().usedCpu_"></span><br/>
                          	未用：<span data-bind="text: hostVo().availCpu_"></span>
                      </div>    
                    </div>            
                  </div>
                  <div class="col-xs-4">
                    <h3>內存</h3>
                    <h5>总量：<span data-bind="text: hostVo().totalMemory_"></span></h5>
                    <div class='inline m-t m-b-xs easyPieChart' data-bind="ui: {jq: 'easyPieChart', options: {percent: hostVo().usedMemoryRate, lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'} }">
                      <div>
                        <span class='text-warning h4' data-bind="text: hostVo().usedMemoryRate_"></span></div>
                    </div>
                    <div class="text-primary-lt">
                      <div class="inline m-a text-left l-h-2x">
                          	已用：<span data-bind="text: hostVo().usedMemory_"></span><br/>
                          	未用：<span data-bind="text: hostVo().availMemory_"></span>
                      </div>     
                    </div>           
                  </div>
                  <div class="col-xs-4">
                    <h3>本地存储</h3>
                    <h5>总量：<span data-bind="text: hostVo().totalStorage_"></span></h5>
                    <div class='inline m-t m-b-xs easyPieChart' data-bind="ui: {jq: 'easyPieChart', options: {percent: hostVo().usedStorageRate, lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'} }">
                      <div>
                        <span class='text-danger h4' data-bind="text: hostVo().usedStorageRate_"></span></div>
                    </div>
                    <div class="text-primary-lt">
                      <div class="inline m-a text-left l-h-2x">
					                          已用：<span data-bind="text: hostVo().usedStorage_"></span><br/>
					                          未用：<span data-bind="text: hostVo().availStorage_"></span>
                      </div> 
                    </div>               
                  </div>
                </div>

                <div class="wrapper m-t-lg" data-bind="if: $root.isCNware">
                  <div class="row">
                    <div class="col-xs-12">
                      <div>
                        <span class="pull-right h4 text-danger" data-bind="text: hostVo().vmUsedMemoryRate_"></span>
                        <span class="h4">虚拟机内存使用比率</span>
                      </div>
                      <div class="progress progress-xxs m-t-sm">
                        <div class="progress-bar" data-bind="style: {width: hostVo().vmUsedMemoryRate_}, css: hostVo().vmUsedMemoryRateSytle">
                        </div>
                      </div>
                      <div class="text-primary-lt">
                      <span class="text-base text-dark">总量：<span data-bind="text: hostVo().totalMemory_"></span></span> 
                         	 已用：<span data-bind="text: hostVo().vmUsedMemory_"></span>
                          	未用：<span data-bind="text: hostVo().availMemory_"></span></div>
                    </div>
                  </div>
                </div> 
                           
              </div>
            </div>
          </div>

        </div>
      </div>
      <!-- 物理主机 end -->
      
      <div class='tab-pane' id='partition_storages' role='tabpanel'>
        <div class='panel panel-default'>
          <div id='resource_storages'>
            <div class="row wrapper">
              <div class="col-xs-9">

              </div>
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入名称">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button">搜索</button>
                  </span>
                </div>
              </div>
            </div>              
            <div class='table-responsive'>
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>名称</th>
                    <th>所属资源池</th>
                    <th>类型</th>
                    <th>总大小</th>
                    <th>可用大小</th>
                    <th>卷数量</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>Storage01</td>
                    <td>xx</td>
                    <td>NFS</td>
                    <td>xxx</td>
                    <td>xxx</td>
                    <td>2</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <footer class='panel-footer'>
              <ul class="pagination">
                <li class="page active">
                  <a href="#pages/javascript:void(0)">1</a></li>
                <li class="page">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_storages=2">2</a></li>
                <li class="page">
                  <a href="#pages/?locale=zh-CN&amp;page_storages=3">3</a></li>
                <li class="next">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_storages=2">下页 &rsaquo;</a></li>
                <li class="last">
                  <a href="#pages/?locale=zh-CN&amp;page_storages=3">末页 &raquo;</a></li>
              </ul>
            </footer>
          </div>
        </div>
      </div>
      <div class='tab-pane' id='partition_images' role='tabpanel'>
        <div class='panel panel-default'>
          <div id='resource_images'>
            <div class="row wrapper">
              <div class="col-xs-2">
                <button class="btn btn-sm btn-info" data-bind="click: addISO">添加</button>
                <button class="btn btn-sm btn-info" data-bind="click: collectISO">收集</button>
              </div>
              <div class="col-xs-2">
                <div class="input-group">
                  <span class="input-group-addon">镜像格式</span>
                  <select class="form-control input-sm" data-bind="value:searchParam().diskFormat">
                    <option value="">全部</option>
                    <option value="ISO">ISO</option>
                    <option value="QCOW2">QCOW2</option>
                  </select>
                </div> 
              </div>              
              <div class="col-xs-2">
                <div class="input-group">
                  <span class="input-group-addon">状态</span>
                  <select class="form-control input-sm" data-bind="value:searchParam().status">
                    <option value="">全部</option>
                    <option value="ACTIVE">ACTIVE</option>
                    <option value="QUEUED">QUEUED</option>
                    <option value="SAVING">SAVING</option>
                    <option value="KILLED">KILLED</option>
                    <option value="DELETED">DELETED</option>
                    <option value="PENDING_DELETE">PENDING_DELETE</option>
                  </select>
                </div> 
              </div>              
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入镜像名称" data-bind="value:searchParam().imageName">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button" data-bind="click: search">搜索</button>
                  </span>
                </div>
              </div>
            </div>             
            <div class='table-responsive'  data-bind="with : table">
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>镜像名称</th>
                    <th>类型</th>
                    <th>状态</th>
                    <th>镜像格式</th>
                    <th>大小(MB)</th>
                    <th>操作系统版本</th>
                    <th>操作系统类型</th>
                    <th>最小磁盘</th>
                    <th>最低内存</th>
                    <th>操作</th>
                  </tr>
                </thead>
                <tbody>
                  <tr data-bind="visible: showNoData">
                <td colspan=10 class="aligncenter">
                    	暂无数据
                </td>
                </tr>
                <!-- ko foreach: {data: pagedRows, as: '$row'}  -->    
                  <tr>
                    <td data-bind="text:imageName"></td>
                    <td>
                      <span  data-bind="if:imageType == null">镜像</span>
                      <span  data-bind="ifnot:imageType == null">快照</span>
                    </td>
                    <td data-bind="text:status"></td>
                    <td data-bind="text:diskFormat"><span class="label label-success"></span></td>
                    <td data-bind="text:(imageSize/(1024*1024)).toFixed(2)"></td>
                    <td data-bind="text:opSysType"></td>
                    <td data-bind="text:opSysVersion"></td>
                    <td data-bind="text:minDisk"></td>
                    <td data-bind="text:minRam"></td>
                    <td><a data-bind="click:$root.editImage">修改</a> | <a data-bind="click:$root.deleteImage">删除</a></td>
                  </tr>
                  <!-- /ko -->
                </tbody>
              </table>
            </div>
            <footer class="panel-footer" data-bind="with: table, visible: table.pages() > 1">
		     <ul class="pagination">
		       <li data-bind="css: leftPagerClass, click: gotoPage(1)">
		         <a href="#">首页</a>
		       </li>
		       <li data-bind="css: leftPagerClass, click: prevPage">
		         <a href="#">&laquo;</a>
		       </li>
		       <li >
		         <a href="#"  data-bind="text: currentPage"></a>
		       </li>
		       <li data-bind="css: rightPagerClass, click: nextPage">
		         <a href="#">&raquo;</a>
		       </li>
		       <li data-bind="css: rightPagerClass, click: gotoPage(pages())">
		         <a href="#">末页</a>
		       </li>
		       <li class="page-control-li">
		         <div class="input-group form-group-sm">
		           <input type="text" class="form-control" data-bind="value: targetPage"  />
		           <div class="input-group-btn">
		             <a href="#" class="btn btn-sm btn-default" data-bind="click: gotoTargetPage()">跳转</a>
		           </div>
		         </div>
		         <div class="page-info-div" data-bind="text: recordsText"></div>
		       </li>
		     </ul>
		   </footer>
          </div>
        </div>
        
        <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAddISO }">
      <div class='modal-dialog modal-lg' style="width:600px;">
        <div class='modal-content'>
          <div class='modal-header'>
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加镜像</h3>
          </div>
          <div class='modal-body form-horizontal row' data-bind="with:currentVO">
            <div class="form-group">
              <label class="col-xs-3 control-label">镜像名称：</label>
              <div class="col-xs-5">
                <input type="email" class="form-control" placeholder="请输入名称"  data-bind="value:imageName">
              </div>
              <div class="col-xs-4">
                <span style="position:absolute;width:90%;">说明：<br>指定镜像上传到镜像服务器<br><br>目前只支持HTTP URL可用镜像。镜像服务必须能够访问到镜像地址。支持镜像的二进制压缩格式(.zip,.tar,.gz.)。<br><br>请注意：镜像地址必须是有效的直接定位到镜像二进制文件的URL。URL被重定向或者服务器返回错误页面将导致镜像不可用。</span>
              </div>
            </div>
            <div class="form-group" id="imageSourceDiv">
              <label class="col-xs-3 control-label">镜像源：</label>
              <div class="col-xs-5">
                <select class="form-control" data-bind="value:uploadType">
                  <option value="file">文件</option>
                  <option value="url">url地址</option>
                </select>
              </div>
            </div>
            <div class="form-group" data-bind="visible: uploadType()!='file'">
              <label class="col-xs-3 control-label">URL地址：</label>
              <div class="col-xs-5">
                <input type="email" class="form-control" placeholder="请输入URL地址"  data-bind="value:uploadUrl">
              </div>
            </div>
            <div class="form-group" data-bind="visible: uploadType()=='file'">
              <label class="col-xs-3 control-label">镜像文件：</label>
              <!-- <div class="col-xs-5">
                <input type="file" class="form-control">
              </div> -->
              <div class="col-xs-5">
                <input readonly="readonly" type="text" class="form-control" data-bind="value: defineFile">
                <form name="uploadDFileForm" enctype="multipart/form-data" style="display:inline">
            <a href="javascript:;" class="btn btn-default" style="margin-left: 10px;display: inline-block;width: 54px;height: 34px;overflow: hidden;position:relative;">
              <input id="defineFile" type="file" name="file" style="opacity: 0;position: absolute;left:0;right:0;" 
               data-bind="event:{change:function(data, event){$root.setFile($('#defineFile').val())}}" />浏览
            </a>
            <span style="color:red;" id="dfileError"></span>
          </form>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">镜像格式：</label>
              <div class="col-xs-5">
                <select class="form-control" data-bind="value:diskFormat">
                  <option value="ISO">ISO</option>
                  <option value="QCOW2">QCOW2</option>
                </select>
              </div>
            </div>
            <!-- <div class="form-group">
              <label class="col-xs-3 control-label">平台：</label>
              <div class="col-xs-5">
                <select class="form-control">
                  <option value="1">Linux</option>
                  <option value="2">2</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">类型：</label>
              <div class="col-xs-5">
                <select class="form-control">
                  <option value="1">快照</option>
                  <option value="2">模板</option>
                </select>
              </div>
            </div> -->
            <div class="form-group">
              <label class="col-xs-3 control-label">最小磁盘(GB)：</label>
              <div class="col-xs-5">
                <input type="email" class="form-control" placeholder="" data-bind="value:minDisk">
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">最小内存(MB)：</label>
              <div class="col-xs-5">
                <input type="email" class="form-control" placeholder="" data-bind="value:minRam">
              </div>
            </div>
            <!-- <div class="form-group">
              <label class="col-xs-3 control-label">镜像大小(GB)：</label>
              <div class="col-xs-5">
                <input type="email" class="form-control" placeholder="">
              </div>
            </div> -->
            
          </div>
          <div class='modal-footer' style="text-align:center;">
            <a class="btn btn-default btn-info" data-bind="click:saveImage" id="saveImageButtonDiv">确定</a>
            <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
          </div>
        </div>
      </div>
    </div>
      
        <div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isEditISO }">
      <div class='modal-dialog modal-lg' style="width:600px;">
        <div class='modal-content'>
          <div class='modal-header'>
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>修改镜像</h3>
          </div>
          <div class='modal-body form-horizontal row' data-bind="with:currentVO">
            <div class="form-group">
              <label class="col-xs-3 control-label">镜像名称：</label>
              <div class="col-xs-5">
                <input type="text" class="form-control" data-bind="value:imageName">
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">操作系统类型：</label>
              <div class="col-xs-5">
                <select class="form-control" data-bind="value:opSysType, options: $root.opSysTypes, optionsText: 'value', optionsValue: 'value',event: {change: $root.onchange_opSysType}">
                </select>
              </div>
            </div>
            <div class="form-group">
              <label class="col-xs-3 control-label">操作系统版本：</label>
              <div class="col-xs-5">
                <select class="form-control" data-bind="value:opSysVersion, options: $root.opSysVersions, optionsText: 'value', optionsValue: 'value'">
                </select>
              </div>
            </div>
            
          </div>
          <div class='modal-footer' style="text-align:center;">
            <a class="btn btn-default btn-info" data-bind="click:saveImage">确定</a>
            <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
          </div>
        </div>
      </div>
    </div>
      </div>
      
      <div class='tab-pane' id='partition_network_externals' role='tabpanel'>
        <div class='panel panel-default'>
          <div id='resource_network_externals'>
            <div class="row wrapper">
              <div class="col-xs-9 m-b-xs">
                <!-- <button class="btn btn-sm btn-primary" data-bind="click: addNetwork">创建</button> -->
              </div>
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入名称" data-bind="value:searchParam().name">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button" data-bind="click:search">搜索</button>
                  </span>
                </div>
              </div>
            </div>             
            <div class='table-responsive' data-bind="with:networkTable">
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>               
                    <th>网络名称</th>
                    <!-- <th>定义类型</th> -->
                    <th>子网数</th>
                    <th>网络类型</th>
                    <th>段ID</th>
                    <th>状态</th>
                   </tr>
                </thead>
                <tbody>
                  <tr data-bind="visible: showNoData">
                  <td colspan=6 class="aligncenter">
                      	暂无数据
                  </td>
                </tr>
                <!-- ko foreach: {data: pagedRows, as: '$row'}  -->     
                  <tr>
                    <td>
                      <a href="#" data-bind="text:name,click:$root.showSubnet">ext_xxxxxx</a></td>
                    <!-- <td data-bind="text:type">外部网络</td> -->
                    <td data-bind="text:subnetNum">3</td>
                    <td data-bind="text:networkType">vlan类型</td>
                    <td data-bind="text:providerSegID">213</td>
                    <td><span class="label label-success" data-bind="text:statusCN">Actived</span></td>
                  </tr>
                <!-- /ko -->
                </tbody>
              </table>
            </div>
            <!-- <footer class='panel-footer'>
              <ul class="pagination">
                <li class="page active">
                  <a href="#pages/javascript:void(0)">1</a></li>
                <li class="page">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_network_externals=2">2</a></li>
                <li class="page">
                  <a href="#pages/?locale=zh-CN&amp;page_network_externals=3">3</a></li>
                <li class="next">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_network_externals=2">下页 &rsaquo;</a></li>
                <li class="last">
                  <a href="#pages/?locale=zh-CN&amp;page_network_externals=3">末页 &raquo;</a></li>
              </ul>
            </footer> -->
            
            <footer class="panel-footer" data-bind="with: networkTable, visible: networkTable.pages() > 1">
          <ul class="pagination">
            <li data-bind="css: leftPagerClass, click: prevPage">
              <a href="#">&laquo;</a>
            </li>
            <!-- ko foreach: {data: (new Array(pages()))} -->
            <li data-bind="css: $parent.pageClass($index() + 1)">
              <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
            </li>
            <!-- /ko -->
            <li data-bind="css: rightPagerClass, click: nextPage">
              <a href="#">&raquo;</a>
            </li>
          </ul>
        </footer>
          </div>

          <div id="resource_network_subnet" style="display:none;" >
            <div class="wrapper">
              <a class="btn btn-default btn-sm" onclick="$('#resource_network_externals').show().siblings().hide();"><i class="fa fa-arrow-left"></i> 返回</a>
            </div>
            <div class='wrapper'>            
              <div class="bg-light b-t b-b wrapper-sm" data-bind="with: networkMsgAtSubnetDiv">
                <div class="row m-b">
                  <div class="col-xs-3">网络名称：<span data-bind="text: networkName">ext-xxxxxxxxx</span></div>
                  <div class="col-xs-3">网络类型：<span data-bind="text: networkType">xx</span></div>
                  <div class="col-xs-3">段ID：<span data-bind="text: networkProviderSegID">xxxxxxxxx</span></div>
                  <div class="col-xs-3">状态：<span data-bind="text: networkStatus">正常</span></div>
                </div>
              </div>

              <h5 class="text-black"><i class="fa fa-minus fa-rotate-90 text-info"></i>子网</h5>
              <div class="panel panel-default table-responsive no-height" data-bind="with : subnetTable">
                <table class="table table-striped">
                  <thead>
                    <th>子网名称</th>
                    <th>子网地址</th>
                    <th>IP版本</th>
                    <th>IP段</th>
                    <th>网关IP</th>
                    <th>DNS地址</th>
                  </thead>
                  <tbody>
                    <tr data-bind="visible: showNoData">
                  <td colspan=6 class="aligncenter">
                      	暂无数据
                  </td>
                </tr>
                  <!-- ko foreach: {data: pagedRows, as: '$row'}  -->  
                    <tr>
                      <td data-bind="text:name">subnet_xx</td>
                      <td data-bind="text:cidr">176.1.0.5/24</td>
                      <td data-bind="text:ipVersion">ipv4</td>
                       <td data-bind="text:poolsMsg">176.1.0.1-176.1.0.10</td>
                      <td data-bind="text:gateway">176.1.0.1</td>
                      <td data-bind="text:dns">202.96.134.133</td>
                    </tr>
                     <!-- /ko -->
                  </tbody>
                </table>
              </div>
              <footer class="panel-footer" data-bind="with: subnetTable, visible: subnetTable.pages() > 1">
          <ul class="pagination">
            <li data-bind="css: leftPagerClass, click: prevPage">
              <a href="#">&laquo;</a>
            </li>
            <!-- ko foreach: {data: (new Array(pages()))} -->
            <li data-bind="css: $parent.pageClass($index() + 1)">
              <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
            </li>
            <!-- /ko -->
            <li data-bind="css: rightPagerClass, click: nextPage">
              <a href="#">&raquo;</a>
            </li>
          </ul>
        </footer> 
            </div>
          </div><!-- end subnet div -->
        </div>

      </div>
      <div class='tab-pane' id='partition_network_externals_topo' role='tabpanel'>
          <dl class="dl-horizontal">
            <dt>部署模式：</dt>
            <dd>集中式或分布式</dd>
            <dt>计算节点数：</dt>
            <dd>100个</dd>
            <dt>网络节点数：</dt>
            <dd>100个</dd>
            <dt>控制节点数：</dt>
            <dd>100个</dd>
          </dl>
            <dl class="dl-horizontal nodeinfo" style="display:none">
            <dt>IP：</dt>
            <dd>10.10.111.222</dd>
            <dt>端口：</dt>
            <dd>8080</dd>
            <dt>端口作用：</dt>
            <dd>上行端口</dd>
           
          </dl>
          <canvas id="canvas" width='1343' height='643'></canvas>
      </div>
      
      <div class='tab-pane' id='partition_ip_pools' role='tabpanel'>
        <div class='panel panel-default'>
          <div id='resource_ip_pools'>
            <div class="row wrapper">
              <div class="col-xs-9 m-b-xs">
              </div>
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入名称">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button">搜索</button>
                  </span>
                </div>
              </div>
            </div>             
            <div class='table-responsive'>
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>IP地址池名称</th>
                    <th>起始地址</th>
                    <th>结束地址</th>
                    <th>子网掩码</th>
                    <th>IP数量</th>
                    <th>可用分区</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>ip池1</td>
                    <td>192.168.1.1</td>
                    <td>192.168.1.2</td>
                    <td>255.255.255.0</td>
                    <td>2</td>
                    <td>openstackServer</td></tr>
                </tbody>
              </table>
            </div>
            <footer class='panel-footer'>
              <ul class="pagination">
                <li class="page active">
                  <a href="#pages/javascript:void(0)">1</a></li>
                <li class="page">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_ip_pools=2">2</a></li>
                <li class="page">
                  <a href="#pages/?locale=zh-CN&amp;page_ip_pools=3">3</a></li>
                <li class="next">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_ip_pools=2">下页 &rsaquo;</a></li>
                <li class="last">
                  <a href="#pages/?locale=zh-CN&amp;page_ip_pools=3">末页 &raquo;</a></li>
              </ul>
            </footer>
          </div>
        </div>
      </div>
      <div class='tab-pane' id='partition_business' role='tabpanel'>
        <div class='panel panel-default'>

          <div id="resource_business">
            <div class="row wrapper">
              <div class="col-xs-9 m-b-xs">
              </div>
              <div class="col-xs-3">
                <div class="input-group">
                  <input type="text" class="input-sm form-control" placeholder="请输入名称">
                  <span class="input-group-btn">
                    <button class="btn btn-sm btn-default" type="button">搜索</button>
                  </span>
                </div>
              </div>
            </div>  
            <div class='table-responsive'>
              <table class='table table-striped table-hover'>
                <thead>
                  <tr>
                    <th>虚拟机</th>
                    <th>IP地址</th>
                    <th>所属物理机</th>
                    <th>操作系统</th>
                    <th>可用分区</th>
                    <th>操作</th></tr>
                </thead>
                <tbody>
                  <tr>
                    <td>vm-2008windows</td>
                    <td>192.168.1.1</td>
                    <td>host1</td>
                    <td>xxx</td>
                    <td>xxx</td>
                    <td>
                      <a onclick="$('#resource_business_cutover').show().siblings().hide();">割接</a>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <footer class='panel-footer'>
              <ul class="pagination">
                <li class="page active">
                  <a href="#pages/javascript:void(0)">1</a></li>
                <li class="page">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_ip_pools=2">2</a></li>
                <li class="page">
                  <a href="#pages/?locale=zh-CN&amp;page_ip_pools=3">3</a></li>
                <li class="next">
                  <a rel="next" href="#pages/?locale=zh-CN&amp;page_ip_pools=2">下页 &rsaquo;</a></li>
                <li class="last">
                  <a href="#pages/?locale=zh-CN&amp;page_ip_pools=3">末页 &raquo;</a></li>
              </ul>
            </footer>
          </div>
          <div id="resource_business_cutover" style="display:none;">
            <div class="form-inline wrapper">
              <a class="btn btn-default btn-sm m-r-sm" onclick="$('#resource_business').show().siblings().hide();"><i class="fa fa-arrow-left"></i> 返回</a>
              <a class="btn btn-info btn-sm" data-bind="click: cutoverBatch">批量设置</a>
              <a class="btn btn-default btn-sm pull-right m-r-sm" onclick="$('#resource_business').show().siblings().hide();">取消割接</a>
              <a class="btn btn-success btn-sm pull-right m-r-sm" onclick="$('#resource_business').show().siblings().hide();">确定割接</a>
            </div>
            <div class="wrapper">
              <div class="panel panel-default table-responsive no-height">
                <table class="table table-striped">
                  <thead>
                    <th>
                      <div class="checkbox">
                        <label class="i-checks">
                          <input type="checkbox" value="">
                          <i></i>
                        </label>
                      </div>                    
                    </th>
                    <th>虚拟机名称</th>
                    <th>IP地址</th>
                    <th>资源区</th>
                    <th>所属VDC</th>
                    <th>业务系统/VPC</th>
                    <th>服务类型</th>
                    <th>申请时长</th>
                    <th>服务产品</th>
                    <th>接管人</th>
                    <th>操作</th>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <div class="checkbox">
                          <label class="i-checks">
                            <input type="checkbox" value="">
                            <i></i>
                          </label>
                        </div>                    
                      </td>
                      <td>vm-2008</td>
                      <td>176.1.0.5</td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><div class="radio"><label class="form-inline"><input type="radio" style="top:-2px;" name="optionsRadios0" id="optionsRadios01" value="option1" checked=""> 永久</label></div><div class="radio disabled"><label class="form-inline"><input type="radio" class="form-control" style="top:-4px;" name="optionsRadios0" id="optionsRadios03" value="option3">有效期至 <input type="text" style="width:110px" class="form-control" id="resource_business_cutover_date"></label></div></td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><select class="form-control input-sm w-xs"><option value="">请选择</option></select></td>
                      <td><a onclick="confirm('确定移除吗？')">移除</a></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class='tab-pane' id='partition_task' role='tabpanel'>
        <div class='panel panel-default'>
          <div id="resource_task">
            <div class="row wrapper">
        <div class="col-xs-2">
          <div class="input-group">
            <span class="input-group-addon">类型</span>
            <select class="form-control input-sm" data-bind="value: searchParam().targetType">
              <option value="IMAGE">全部</option>
              <option value="IMAGE">镜像</option>
            </select>
          </div>      
        </div>           
        <div class="col-xs-2">
          <div class="input-group">
            <span class="input-group-addon">任务名称</span>
            <input type="text" class="input-sm form-control" placeholder="请输入任务名称" data-bind="value: searchParam().taskName">
          </div>
        </div>  
        <div class="col-xs-2">
          <div class="input-group">
            <span class="input-group-addon">资源名称</span>
            <input type="text" class="input-sm form-control" placeholder="请输入资源名称" data-bind="value: searchParam().targetName">
          </div>
        </div>                                    
        <div class="col-xs-2">
          <button class="btn btn-default btn-sm" type="submit" data-bind="click: search">搜索</button>
        </div>        
      </div>
      
      <div id='instance_tasks'>
        <div class='table-responsive' data-bind="with: table">
          <table class='table table-striped'>
            <thead>
              <tr>
                <th>任务编号</th>
                <th>任务名称</th>
                <th>任务进度（%）</th>
                <th>任务状态</th>
                <th>资源名称</th>
                <th>资源类型</th>
                <th>操作人</th>
                <th>开始时间</th>
                <th>完成时间</th>
              </thead>
                <tbody>
                  <tr data-bind="visible: showNoData">
                    <td colspan=14 class="aligncenter">
                      	暂无数据
                    </td>
                  </tr>
                  <!-- ko foreach: {data: pagedRows, as: '$row'}  -->
                  <tr> 
                      <td data-bind="text: taskId"></td>
                      <td data-bind="text: taskName"></td>
                      <td data-bind="text: progress"></td>
                      <td>
                        <span class="label label-success" data-bind="if: $row.state == 'success'">成功</span>
                        <span class="label label-warning" data-bind="if: $row.state == 'active'">进行中</span>
                        <span class="label label-danger" data-bind="if: $row.state == 'completedAndError'">失败</span>
                      </td>
                      <td data-bind="text: targetName"></td>
                      <td>
                        <span data-bind="if: $row.targetType == 'VM'">云主机</span>
                        <span data-bind="if: $row.targetType == 'DISK'">云硬盘</span>
                        <span data-bind="if: $row.targetType == 'PUBLICIP'">公网IP</span>
                        <span data-bind="if: $row.targetType == 'LOAD_BALANCING'">负载均衡器</span>
                        <span data-bind="if: $row.targetType == 'SECRET_KEY'">SSH密钥</span>
                        <span data-bind="if: $row.targetType == 'OBJECT_STORAGE'">对象存储</span>
                      </td>
                      <td data-bind="text: user"></td>
                      <td data-bind="text: executeDate"></td>
                      <td data-bind="text: endDate"></td>
                  </tr>
                  <!-- /ko -->
                </tbody>
              </table>
            </div>
            <footer class="panel-footer" data-bind="with: table, visible: table.pages() > 1">
              <ul class="pagination">
                <li data-bind="css: leftPagerClass, click: prevPage">
                  <a href="#">&laquo;</a>
                </li>
                <!-- ko foreach: {data: (new Array(pages()))} -->
                <li data-bind="css: $parent.pageClass($index() + 1)">
                  <a href="#" data-bind="text: $index() + 1, click: $parent.gotoPage($index() + 1)"></a>
                </li>
                <!-- /ko -->
                <li data-bind="css: rightPagerClass, click: nextPage">
                  <a href="#">&raquo;</a>
                </li>
              </ul>
            </footer>
      </div>
          </div>
        </div>
      </div>
    
    
    </div>
  </div>
</div>

<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAddIP }">
  <div class='modal-dialog'>
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加公网IP</h3>
      </div>
      <div class='modal-body form-horizontal row'>
        <div class="form-group">
          <label class="col-xs-3 control-label">名称：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="请输入名称">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">IP地址：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">子网掩码：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="">
          </div>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info">确定</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>

<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAddNetwork }">
  <div class='modal-dialog'>
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>创建网络</h3>
      </div>
      <div class='modal-body form-horizontal row'>
        <div class="form-group">
          <label class="col-xs-3 control-label">名称：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="请输入名称">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">网络类型：</label>
          <div class="col-xs-8">
            <select class="form-control">
              <option value="1">数据中心网络</option>
              <option value="2">公司网络</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">描述：</label>
          <div class="col-xs-8">
            <textarea class="form-control" cols="30" rows="3"></textarea>
          </div>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info">确定</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>

<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isAddSubnet }">
  <div class='modal-dialog'>
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加子网</h3>
      </div>
      <div class='modal-body form-horizontal row'>
        <div class="form-group">
          <label class="col-xs-3 control-label">子网名称：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="请输入名称">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">IP版本：</label>
          <div class="col-xs-8">
            <select class="form-control">
              <option value="1">IPv4</option>
              <option value="2">IPv6</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">子网地址：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">网关地址：</label>
          <div class="col-xs-8">
            <input type="email" class="form-control" placeholder="">
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">dns地址：</label>
          <div class="col-xs-8">
            <textarea class="form-control" cols="30" rows="3" placeholder="格式：每行一个ip地址"></textarea>
          </div>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info">确定</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>






<div role="dialog" aria-hidden="true" class="modal fade" data-bind="modal: { show: isCutoverBatch }">
  <div class='modal-dialog modal-lg' style="width:600px;">
    <div class='modal-content'>
      <div class='modal-header'>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span></button><h3 class='modal-title'>添加公网IP</h3>
      </div>
      <div class='modal-body form-horizontal row'>
        <div class="form-group">
          <label class="col-xs-3 control-label">VDC：</label>
          <div class="col-xs-8">
            <select class="form-control" id="">
              <option value="1">1</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">业务系统：</lacovbel>
          <div class="col-xs-8">
            <select class="form-control" id="">
              <option value="1">1</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">服务类型：</label>
          <div class="col-xs-8">
            <select class="form-control" id="">
              <option value="1">1</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">虚拟机接管人：</label>
          <div class="col-xs-8">
            <select class="form-control" id="">
              <option value="1">1</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="col-xs-3 control-label">申请时长：</label>
          <div class="col-xs-8">
            <div class="radio"><label class="form-inline"><input type="radio" style="top:4px;" name="optionsRadios0" id="optionsRadios01" value="option1" checked=""> 永久</label></div><div class="radio disabled"><label class="form-inline"><input type="radio" class="form-control" style="top:2px;" name="optionsRadios0" id="optionsRadios03" value="option3">有效期至 <input type="text" style="width:110px" class="form-control" id="resource_business_cutover_batch_date"></label></div>
          </div>
        </div>
        
      </div>
      <div class='modal-footer' style="text-align:center;">
        <a class="btn btn-default btn-info">确定</a>
        <a class="btn btn-default btn btn-default" data-dismiss="modal">取消</a>
      </div>
    </div>
  </div>
</div>

<!-- page specific plugin scripts -->
<script type="text/javascript">
  var scripts = ["api/resource/hosts/host.js", "assets/lib/moment/moment.js","assets/lib/bootstrap-daterangepicker/daterangepicker.js",'assets/js/jtopo.js'];
  $('.page-content-area').ace_ajax('loadScripts', scripts, function(args) {
    //创建topo
      var isData=true;
      var canvas = document.getElementById('canvas');      
      var stage = new JTopo.Stage(canvas);
      var scene = new JTopo.Scene(stage);
      scene.backgroundColor='255,255,255';
      stage.add(scene);

    //添加node节点
      function addNode(str,text,x,y,type){
        var node = new JTopo.Node(text);             
        node.setLocation(x, y);
        node.setImage( "assets/img/topo/images/"+str+".png", false);
        node.width=48;
        node.height=48;
        node.fontColor="0,0,0";
        node.dragable=true;
        node.editAble=false;
        node.type=str,
        scene.add(node);
      }
    //添加link
    function addLink(linkA,linkZ){
        var link = new JTopo.Link(linkA, linkZ);
                  link.lineWidth = 1; // 线宽
                  link.bundleGap = 30; // 线条之间的间隔
                  link.textOffsetY = 3; // 文本偏移量（向下3个像素）
                  link.strokeColor = 0,0,0 // 线条颜色随机JTopo.util.randomColor();
                  link.type = 'loop'; // 自定义属性
                  scene.add(link);
    }
    //数据处理
  
    for (var i = 1; i <40; i++) {
      if(i<4){
        var x=Math.ceil((1000/3)*i);
        var node=addNode("internet","node"+i,x,30)
        
      }else if(i>3 && i <=12){
        var x=Math.ceil((1200/9)*(i-3));
        var node=addNode("network","node"+i,x,150)
       
      }else{
        var x=Math.ceil((1200/27)*(i-12));
        var node=addNode("cloudHost","node"+i,x,Math.random()*370 +230)
        
      }
    }; 
    var getDisp=scene.getDisplayedElements(),top=[],middle=[],bottom=[];
    for (var j = 0 ; j < getDisp.length; j++) {
     
      if(getDisp[j].type=="internet"){
        top.push(getDisp[j])
      }else if(getDisp[j].type=="network"){
        middle.push(getDisp[j])
      }else if(getDisp[j].type=="cloudHost"){
        bottom.push(getDisp[j])
      }
    };
    for (var k = 0; k < top.length; k++) {
      for (var h = 0; h < middle.length; h++) {
        addLink(top[k],middle[h])
      };
      for (var c = 0; c < bottom.length; c++) {
        addLink(top[k],bottom[c])
      };
    };
    for (var a = 0; a < middle.length; a++) {
      for (var b = 0; b < bottom.length; b++) {
        addLink(middle[a],bottom[b])
      };
    };

    //鼠标经过 nodeinfo
    scene.mouseover(function(e){
      if(e.target != null && e.target instanceof JTopo.Node){
        $(".nodeinfo").show().css({"top":e.y,"left":e.x})
      }
    })
    
    //取得URL参数值
    /**可用分区**/
    var azUuid = args.azUuid;
    var azName = args.azName;
    /**虚拟化云平台 **/
    var cloudPlatform = args.cloudPlatform;
    /** 可用分区的底层虚拟化类型 **/
    var virtualHypervisor = args.virtualHypervisor;
    if(csc.util.isNull(azUuid)){
      return;
    }
    
    /**控制当前位置展示**/
    function positionInfoViewModel(){
    	this.azName = ko.observable(azName);
    }
    ko.applyBindings(new positionInfoViewModel(),$("#positionInfoDIV")[0]);
    
    
    /** 控制TAB展示 **/
    function partitionsTabsViewModel(){
      this.activeTab = ko.observable(cloudPlatform);
    }
    ko.applyBindings(new partitionsTabsViewModel(),$("#partitionsTabs")[0]);
      
    $('#resource_business_cutover_date').val(moment().subtract('days', 29).format('YYYY/MM/DD') + ' 至 ' + moment().format('YYYY/MM/DD')).daterangepicker(
          {
            singleDatePicker:true,
            format:'YYYY/MM/DD',
            startDate: moment(),
            endDate: moment(),
            separator:'至',
            locale:{
              applyLabel: '确认',
              cancelLabel: '取消',
              fromLabel: '开始日期',
              toLabel: '结束日期',
              weekLabel: '周',
              customRangeLabel: '自定义范围',                            
              daysOfWeek:["日","一","二","三","四","五","六"],
              monthNames:['01月','02月','03月','04月','05月','06月','07月','08月','09月','10月','11月','12月',]
            }
          }
        );
    $('#resource_business_cutover_batch_date').val(moment().subtract('days', 29).format('YYYY/MM/DD') + ' 至 ' + moment().format('YYYY/MM/DD')).daterangepicker(
          {
            singleDatePicker:true,
            format:'YYYY/MM/DD',
            startDate: moment(),
            endDate: moment(),
            separator:'至',
            locale:{
              applyLabel: '确认',
              cancelLabel: '取消',
              fromLabel: '开始日期',
              toLabel: '结束日期',
              weekLabel: '周',
              customRangeLabel: '自定义范围',                            
              daysOfWeek:["日","一","二","三","四","五","六"],
              monthNames:['01月','02月','03月','04月','05月','06月','07月','08月','09月','10月','11月','12月',]
            }
          }
        );
    
    //物理主机ViewModel
    function HostListViewModel(){
      var self = this;
      //是否显示详情页面      
      self.isShowDetail = ko.observable(false);
      
      //物理主机对象
      self.hostVo = ko.observable({
        usedVcpuUiOpts: 0,
        usedMemoryUiOpts: 0,
        usedStorageUiOpts: 0
      });
      
      //显示物理主机详情页面
      self.showDetailFun = function(hostObj){
        self.isShowDetail(!self.isShowDetail());
        if(self.isShowDetail){
          self.hostVo(hostObj);
        }
        
      }
      //定义搜索参数
        self.searchParam = ko.observable({
            azUuid: azUuid,
            state: "",
            hostNameLike: ""
        });
        
      //是否CNware云管理平台
        self.isCNware = function(){
          if("OpenStack"){
            return false;
          }
        }();
        
        //alert(self.isCNware);
        
        self.hostsTable = new DataTable([], {
            perPage: 10,
            path: 'api/v5.0.0/hosts?azUuid=' + azUuid,
            loader: function(result){
            	if(result.az){
            		result.azName = result.az.name;
            	}
                result.totalLogicalCpu_ = result.totalLogicalCpu + "颗";
              
                if(!self.isCNware){
	                result.resourcePoolName = "-";
	                result.runningTime = "-";
	                result.state_ = "-";
	                result.vmNumber = "-";
	                //CPU资源统计
	                result.usedCpu_ = result.usedCpu + "个";
	                result.availCpu_ = result.availCpu + "个";
	                result.totalCpu_ = result.totalCpu + "个";
              	}else{
                  	result.state_ = $.HOST._stateViews[result.state];
                  	result.state_= csc.util.isNull(result.state_)?"-":result.state_;
                  
                  	result.usedCpu_ = result.usedCpu + "MHz";
              		result.availCpu_ = result.availCpu + "MHz";
              		result.totalCpu_ = result.totalCpu + "MHz";
              	}
              	var pieOptsPreffix = "{percent: ";
              	var pieOptsSuffix = " ,lineWidth: 4,trackColor: '#e8eff0',barColor: '#27c24c',scaleColor: false,size: 80,rotate: 0,lineCap: 'butt'}";
              	//CPU资源统计
                result.usedVcpuRate = (result.usedCpu/result.totalCpu * 100.0).toFixed(2);
                 result.usedVcpuRate_ = result.usedVcpuRate + "%";
                result.usedVcpuUiOpts = pieOptsPreffix + result.usedVcpuRate + pieOptsSuffix;
            
                //内存资源统计
                result.totalMemory_ = (result.totalMemory/1024).toFixed(2) + "GB";
                result.usedMemory_  = (result.usedMemory/1024).toFixed(2) + "GB";
                result.availMemory_ = (result.availMemory/1024).toFixed(2) + "GB";
                result.usedMemoryRate = (result.usedMemory/result.totalMemory * 100.0).toFixed(2);
              result.usedMemoryRate_ = result.usedMemoryRate + "%";
              result.usedMemoryUiOpts = pieOptsPreffix + result.usedMemoryRate + pieOptsSuffix;
              //存储资源统计
              result.totalStorage_ = result.totalStorage + "GB";
              result.usedStorage_  = result.usedStorage + "GB";
              result.availStorage_ = result.availStorage + "GB";
              result.usedStorageRate = (result.usedStorage/result.totalStorage * 100.0).toFixed(2);
              result.usedStorageRate_ = result.usedStorageRate + "%";
              result.usedStorageUiOpts = pieOptsPreffix + result.usedStorageRate + pieOptsSuffix;
              //vm已使用内存
              //hostUsedMemory为主机消耗的内存（已使用内存 - vm使用内存）
              result.vmUsedMemory_ = (result.vmUsedMemory/1024).toFixed(2) + "GB";
              result.hostUsedMemory = (result.usedMemory - result.vmUsedMemory/1024).toFixed(2);
              result.hostUsedMemory_ = result.hostUsedMemory + "GB";
              result.vmUsedMemoryRate = (result.vmUsedMemory/result.totalMemory * 100.0).toFixed(2);
              result.vmUsedMemoryRate_ = result.vmUsedMemoryRate + "%";
              //vm已使用内存bar的样式
              if(result.vmUsedMemoryRate < 50){
                result.vmUsedMemoryRateSytle = "progress-bar-success";
              }else if(result.vmUsedMemoryRate < 80){
                result.vmUsedMemoryRateSytle = "progress-bar-warning";
              }else{
                result.vmUsedMemoryRateSytle = "progress-bar-danger";
              }
            
                return result;
            }
        });
        //搜索操作
        self.search = function(){
            var p = self.searchParam();
            if(!self.isCNware){
              delete p.state;
            }
            self.hostsTable.params(p);
        };
        
    }
    ko.applyBindings(new HostListViewModel(), $("#partition_hosts")[0]);
    
    
    
    
    
    
    
    /***********************Network Start*****************************/
    function NetworkViewModel(){
        var self = this;
        this.searchParam = ko.observable({
          name: ""
        });

        this.search = function(){
          this.networkTable.params(this.searchParam());
        };
        
        this.networkMsgAtSubnetDiv = ko.validatedObservable({
          networkName:"",
          networkType:"",
          networkProviderSegID:"",
          networkStatus:""
        });
        
        this.showSubnet = function(object,event){
          if(object.subnetNum == 0){
            alert('该网络还没有子网！');
            return ;        
          }
          //显示点击的那个网络信息
            self.networkMsgAtSubnetDiv({
              networkName : object.name,
              networkType : object.networkType,
              networkProviderSegID : object.providerSegID,
              networkStatus : object.statusCN
              
            });   

          self.subnetTable.params({'networkUuid':object.uuid});
        }
        
        this.subnetTable = new DataTable([], {  
              perPage:10,
              path: 'api/v5.0.0/subnets?azUuid='+azUuid,
              loader: function(result){
                $('#resource_network_subnet').show().siblings().hide();               
                return result;
              } 
            });
        
        this.networkTable = new DataTable([], {path: 'api/v5.0.0/networks?azUuid='+azUuid});
      };

      ko.applyBindings(new NetworkViewModel(), $('#partition_network_externals')[0]);//绑定网络的区域
      /***********************Network end*****************************/
      
      
      /****************************可用分区 摘要START*********************************/
      function AZViewModel(){
        this.isAzEdit = ko.observable(false);
        //数据中心基础信息VO
          this.azInfoVO = ko.observable({});
          //数据中心摘要统计信息VO
          this.azSummaryVO = ko.observable({});
          var self = this;
          this.loadAzSummary = function(){
              //加载数据中心摘要
              $.ajax("api/v5.0.0/azs/"+azUuid+"/summary").done(function(data){
              //console.log(data);
              //CPU使用率
              data.cpuUseRate = (data.cpuAllocated/data.cpuTotal * 100.0).toFixed(2);
              if(data.cpuUseRate == 'NaN'){
            	  data.cpuUseRate = 0;
              }
              //内存使用率
              data.memoryUseRate = (data.memoryAllocated/data.memoryTotal * 100.0).toFixed(2);
              if(data.memoryUseRate == 'NaN'){
            	  data.memoryUseRate = 0;
              }
              //存储使用率
              data.storageUseRate = (data.storageAllocated/data.storageTotal * 100.0).toFixed(2);
              if(data.storageUseRate == 'NaN'){
            	  data.storageUseRate = 0;
              }
              
              //单位转换，原单位：MB,转换后：GB 
              data.memoryTotal = (data.memoryTotal/1024).toFixed(2);
              data.memoryAvail = (data.memoryAvail/1024).toFixed(2);
              data.memoryAllocated = (data.memoryAllocated/1024).toFixed(2);
              
              self.azSummaryVO(data);
              //console.log(self.azSummaryVO().cpuTotal);
            });
          }
          this.loadAzInfoVO = function(){
            $.ajax("api/v5.0.0/azs/"+azUuid).done(function(data){
              self.azInfoVO(data);
              //console.log(self.azInfoVO());
            });
          }
          this.loadAzSummary();
          this.loadAzInfoVO();
          
          /************************************可用分区编辑 开始 ******************************************/
          this.editAZInfo = function(){
            self.loadDcs();
            self.isAzEdit(true);        
          };
          
          //数据中心,下拉列表
          this.dcs = ko.observableArray([]);
          //云平台,下拉列表
          this.cloudPlatforms = ko.observableArray([]);
          //虚拟化类型,下拉列表
          this.virtualHypervisors = ko.observableArray([]);
          
          //加载数据中心方法
          this.loadDcs = function(){
            $.ajax("api/v5.0.0/datacenters").done(function(data){
              self.dcs(data.results);
              self.onchange_dcs();
            });
          };
          
          //加载云平台方法
          this.loadCloudPlatforms = function(dcId, isFilterHasAz){
          if(isFilterHasAz){
            $.ajax("api/v5.0.0/cloudPlatforms?isFilterHasAz=true&dataCenterUUID=" + dcId).done(function(data){
                  self.cloudPlatforms(data.results);
                });       
          }else{
            $.ajax("api/v5.0.0/cloudPlatforms?dataCenterUUID=" + dcId).done(function(data){
                  self.cloudPlatforms(data.results);
                });
          }
          };
          //加载虚拟化类型方法
          this.loadVirtualHypervisors = function(type){
            self.virtualHypervisors([]);
	      	$.ajax("api/v5.0.0/azs/0/hypervisor?cloudPlatform=" + type).done(function(data){
	      	  self.virtualHypervisors(data);
	   	    }); 
          };
          
          //数据中心下拉框onChange
          this.onchange_dcs = function(){
            var dcUuid = self.azInfoVO().datacenterUuid;
            var azUuid = self.azInfoVO().uuid;
            //结合可用分区UUID判断是新增还是修改
            if(azUuid){//修改 
            self.loadCloudPlatforms(dcUuid, false);
            }else{//新增
            self.loadCloudPlatforms(dcUuid, true);
            }
          }
          //虚拟化云平台下拉框onChange
          this.onchange_cloudPlatforms = function(){
            //TODO 根据选中虚拟化云平台类型来联动加载
            self.loadVirtualHypervisors("OpenStack");
          }
          
          this.saveAzInfo = function(){
              var azUuid = self.azInfoVO().uuid;
            csc.rest.put('api/v5.0.0/azs/'+azUuid, this.azInfoVO(), function(){
                    self.isAzEdit(false);
                  systemMsg.alert("修改成功");
            });
        
            };
          /************************************可用分区编辑 结束 ******************************************/
          
          /************************************可用分区删除 开始 ******************************************/
          this.deleteAZ = function(){
            var azName = self.azInfoVO().name;
            var azUuid = self.azInfoVO().uuid;
            confirm("确定删除AZ["+azName+"]？",function(arg){
            csc.rest.del('api/v5.0.0/azs/'+azUuid, function(data){
              systemMsg.alert("删除AZ：["+azName+"]成功！");
              location.href = "#pages/resources/partitions/index";
              });
            });
          }
          /************************************可用分区删除 结束 ******************************************/
          
      }
      ko.applyBindings(new AZViewModel(), $('#partition_summary')[0]);
      /****************************可用分区 摘要END*********************************/
      
      /****************************镜像 START*********************************/
      function ImageView(){
          this.imageName = ko.observable().extend({required:true,cscNameRule:true,maxLength:32});
          this.uploadType = ko.observable().extend({require: true});
          this.defineFile = ko.observable().extend({required:{onlyIf:
              	(function(_this){
              		return function(){
              			return _this.uploadType()=="file"
              		}
              	})(this)
             	}});
          this.uploadUrl = ko.observable().extend({required:{onlyIf:
              	(function(_this){
              		return function(){
              			return _this.uploadType()!="file"
              		}
              	})(this)
              }});
          
          this.diskFormat = ko.observable();
          this.minDisk = ko.observable();
          this.minRam = ko.observable();
          
      }
      function imageViewModel(){
        this.isAddISO = ko.observable(false);
        this.isEditISO = ko.observable(false);
        var self = this;
        
        this.currentVO = ko.validatedObservable(new ImageView());

        this.table = new DataTable([], {path: 'api/v5.0.0/images?azUuid=' + azUuid});
          
          /****************************查询开始********************************/
          this.searchParam = ko.observable({
            imageName:"",
            diskFormat: "",
            status:""
          });

          this.search = function(){
            this.table.params(this.searchParam());
          };
          /****************************查询结束********************************/
          
          /****************************新增开始********************************/
          // TODO镜像新增 
      this.addISO = function(){
        this.currentVO.fromJSON({
              uuid:'',
              imageName:'',
              defineFile:'',
              uploadType:'file',
              diskFormat:'',
              azUuid:azUuid
            });
            //显示文件上传输入框
            self.isAddISO(true);        
           };
           
           this.setFile = function(value){
             this.currentVO().defineFile(value);
           }
           
          // 镜像文件上传
          this.uploadDfile = function(imageId, callback){
            if(!self.isSetDfile()){
              return;
            }
            var options  = {    
                url: 'api/file/uploadServlet?handler=cscImage&handlerKey=cscImage&actionKey=&dataKey=&azUuid='+azUuid+'&imageId='+imageId,
                type:'post',
                data:self.currentVO.toJSON(),
                success:function(result){    
                  var data = result;
                  systemMsg.alert('镜像上传:'+data.result);  
                },
                error:function(data){
                  systemMsg.alert(data.result); 
                }
            };    
            var form = $("form[name=uploadDFileForm]");  
          form.ajaxSubmit(options);
          }
          
          // 是否修改了上传文件
          this.isSetDfile = function(){
            if(self.currentVO().defineFile() == self.getFileName(self.currentVO().defineFile())){
              return false;
            }
            return true;
          }
        
        // 获取文件名称
          this.getFileName = function(path) {
            if(path==null||path==''){
              return path;
            }
            var pos1 = path.lastIndexOf('/');
            var pos2 = path.lastIndexOf('\\');
            var pos = Math.max(pos1, pos2)
            if (pos < 0)
              return path;
            else
              return path.substring(pos + 1);
          }
        
        
          
          /****************************新增结束********************************/
          
          
          /****************************编辑开始********************************/
          this.editImage = function(object, event){
            //console.log(object);
              self.currentVO.fromJSON(object);
              //console.log(self.currentVO.toJSON().imageName);
              //加载操作系统类型下拉
              self.loadOpSysTypes();
              self.isEditISO(true);        
           };
           
           //加载操作系统类型，下拉值
           this.opSysTypes = ko.observableArray([]);
           this.loadOpSysTypes = function(){
             $.ajax("api/v5.0.0/products/configs/values?productCodeName=VM&configCodeName=virtualPlatform&urlType=getTarget&sourceValue=" + virtualHypervisor).done(function(data){
               self.opSysTypes(data);
               self.onchange_opSysType();
             });
           };
           //操作系统类型下拉值onchange事件
           this.onchange_opSysType = function(){
             var versionSourceValue = self.currentVO.toJSON().opSysType;
             self.loadOpSysVersions(versionSourceValue);
           }
           
           //加载操作系统版本，下拉值
           this.opSysVersions = ko.observableArray([]);
           this.loadOpSysVersions = function(versionSourceValue){
             $.ajax("api/v5.0.0/products/configs/values?productCodeName=VM&configCodeName=osType&urlType=getTarget&sourceValue="+versionSourceValue).done(function(data){
                self.opSysVersions(data);
             });
           };
           
           //镜像修改保存
           this.saveImage = function(){
             ko.validation.group(self.currentVO).showAllMessages();
             var imageUuid = self.currentVO.toJSON().uuid;
             if(!imageUuid){
            	 if(self.currentVO.isValid()){
            		 var currentUploadType = self.currentVO().uploadType();
                     if(currentUploadType == "url"){
                       csc.rest.post('api/v5.0.0/images', self.currentVO.toJSON(), function(){
                             self.isAddISO(false);
                             self.table.refreshData();
                       });
                     }else{
                       $("#saveImageButtonDiv").attr("disabled", true);
                       // 镜像新增
                       csc.rest.post('api/v5.0.0/images',self.currentVO.toJSON(),function(data){
                         if(data.imageId){
     		                systemMsg.alert('镜像已创建,开始文件上传...');
     		                self.uploadDfile(data.imageId,function(){
     		                  alert("文件上传中...");
     		                });
                         }
                         self.isAddISO(false);
                         //$("#saveImageButtonDiv").removeAttr("disabled");
                   	  });
                     }
                 }
             }else{
                 csc.rest.put('api/v5.0.0/images/'+imageUuid, this.currentVO.toJSON(), function(){
                     self.isEditISO(false);
                     self.table.refreshData();
                 });
             }
           }
          /****************************编辑结束********************************/
          
          /****************************编辑结束********************************/
          this.deleteImage = function(rowObj){
            var uuid = rowObj.uuid;
            var imageName = rowObj.imageName;
            confirm("确定删除镜像["+imageName+"]？",function(arg){
              csc.rest.del('api/v5.0.0/images/'+uuid, function(data){
                alert("镜像删除任务ID：["+data.taskId+"]!");
                self.table.refreshData();
                });
             });
          }
          
          /****************************编辑结束********************************/
          
          
          
          /****************************收集开始********************************/
          this.collectISO = function(){
            csc.rest.get('api/v5.0.0/images/collect?azUuid='+azUuid, function(data){
              alert("镜像收集任务ID：["+data.taskId+"]!");
          	  self.table.refreshData();
          });
          }
          /****************************收集结束********************************/
      }
      ko.applyBindings(new imageViewModel(), $('#partition_images')[0]);
      /****************************镜像 START*********************************/
      
      
      /****************************调度任务 START*********************************/
      function ViewModel_Task(){
        //系统当前登录用户标识
        var account = "";
        var self = this;
      //查询条件初始化
        this.searchParam = ko.observable({
          targetType: '',
          taskName: '',
          targetName: '',
          orderBy: 'executeDate:desc'
        })
        
        this.search = function(){
          this.table.params(this.searchParam());
        }
      
        this.table = new DataTable([]);
        
        this.reloadTaskList = function(){
          self.table.params(self.searchParam());
        self.table.path('api/v5.0.0/tasks');
        }
        this.reloadTaskList();
      }
      ko.applyBindings(new ViewModel_Task(), $('#partition_task')[0]);
      /****************************调度任务 END*********************************/
      
      // 如果是从首页向导进来的，则需要进行模块切换
      if(window.location.href.indexOf('?type=network')>0 || window.location.href.indexOf('&type=network') >0){
        $('#network_tab').click();
      }
      if(window.location.href.indexOf('?type=iso')>0 || window.location.href.indexOf('&type=iso') >0){
        $('#iso_tab').click();
      }
      

    
  });
</script>